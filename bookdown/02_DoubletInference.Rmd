# Doublet Inference with ArchR


```{r include=FALSE, eval = FALSE}
setwd("/Volumes/JG_SSD_2/ArchR_Walkthrough/")
save.image("Save-ArchR-Walkthrough-Chapter1-Feb14-2313.Rdata")
```

One major source of trouble in single-cell data is the contribution of "doublets" to the analysis. A doublet refers to a single droplet that received a single barcoded bead and more than one nucleus. This causes the reads from more than one cell to appear as a single cell. We remove these computationally and describe this doublet removal process in more depth in the [doublet removal vignette](articles/Articles/doubletRemoval.html).

## Inferring scATAC-seq Doublets with ArchR

```{r eval=FALSE}
#Add Infered Doublet Scores to each Arrow File (~2-5 min per sample)
#By default ArchR uses the doublet params as described in the ArchR paper.
#We show some of the main adjustable features below for more information 
#Try ?addDoubletScores to see further documentation on parameters for doublet identification.
doubScores <- addDoubletScores(
	input = ArrowFiles,
	k = 10, #Refers to how many cells near a "pseudo-doublet" to count.
	knnMethod = "UMAP", #Refers to embedding to use for nearest neighbor search with doublet projection.
	LSIMethod = 1
)

```

Now we can look at the results in a folder "QualityControl" in your current working directory. There are 3 plots associated with each of your samples in this folder : </br>
1. **Doublet Enrichments** - These represent the enrichment of simulated doublets nearby each single cell compared to the expected if we assume a uniform distribution. </br>

For **BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_BMMC_R1-Doublet-Summary_1.png){width=500 height=500}

</br>

For **CD34 BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_CD34_BMMC_R1-Doublet-Summary_1.png){width=500 height=500}

</br>

For **PBMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_PBMC_R1-Doublet-Summary_1.png){width=500 height=500}

</br>

</br>
2. **Doublet Scores** - These represent the significance (-log10 binomial adjusted p-value) of simulated doublets nearby each single cell compared to the expected if we assume a uniform distribution. We have found this value is not as consistent as the doublet enrichments for doublet identification. </br>

For **BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_BMMC_R1-Doublet-Summary_2.png){width=500 height=500}

</br>

For **CD34 BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_CD34_BMMC_R1-Doublet-Summary_2.png){width=500 height=500}

</br>

For **PBMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_PBMC_R1-Doublet-Summary_2.png){width=500 height=500}

</br>
3. **Doublet Density** - This represents the density of the simulated doublet projections so you can visually where the doublets are located in your 2-d embedding.</br>

For **BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_BMMC_R1-Doublet-Summary_3.png){width=500 height=500}

</br>

For **CD34 BMMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_CD34_BMMC_R1-Doublet-Summary_3.png){width=500 height=500}

</br>

For **PBMC** : </br>

![](images/HemeWalkthrough/PNG/scATAC_PBMC_R1-Doublet-Summary_3.png){width=500 height=500}

To download the PDFs for each sample </br>

[Download PDF : scATAC_BMMC_R1-Doublet-Summary.pdf](images/HemeWalkthrough/PDF/scATAC_BMMC_R1-Doublet-Summary.pdf)</br>
[Download PDF : scATAC_CD34_BMMC_R1-Doublet-Summary.pdf](images/HemeWalkthrough/PDF/scATAC_CD34_BMMC_R1-Doublet-Summary.pdf)</br>
[Download PDF : scATAC_PBMC_R1-Doublet-Summary.pdf](images/HemeWalkthrough/PDF/scATAC_PBMC_R1-Doublet-Summary.pdf)</br>



