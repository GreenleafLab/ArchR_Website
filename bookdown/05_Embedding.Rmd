# Single Cell Embeddings

```{r, include=FALSE}
setwd("/Volumes/JG_SSD_2/ArchR_Walkthrough/")
#load("Save-ArchR-Walkthrough-Chapter1-Feb13.Rdata")
save.image("Save-ArchR-Walkthrough-Feb13-2158.Rdata")
```

## UMAP

```{r eval=FALSE}
projHemeND <- addUMAP(
    ArchRProj = projHemeND, 
    reducedDims = "IterativeLSI", 
    name = "UMAP", 
    nNeighbors = 30, 
    minDist = 0.5, 
    metric = "cosine"
)
```

```{r eval=FALSE}
p1 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "UMAP")
p2 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "UMAP")
ggAlignPlots(p1, p2, type = "h")
```

```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p1, p2, type = "h", draw=FALSE), 
    name = "Plot-UMAP-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    ddDOC = FALSE,
    width = 10, 
    height = 5
)
```

To save a nice looking pdf we use plotPDF which removes white pages and tries to make the plots
nice looking.

```{r eval=FALSE}
plotPDF(p1,p2, name = "Plot-UMAP-Sample-Clusters.pdf", ArchRProj = projHemeND, addDOC = FALSE, width = 5, height = 5)
```

## tSNE

```{r eval=FALSE}
projHemeND <- addTSNE(
    ArchRProj = projHemeND, 
    reducedDims = "IterativeLSI", 
    name = "TSNE", 
    perplexity = 30
)
```

```{r eval=FALSE}
p1 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "TSNE")
p2 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "TSNE")
ggAlignPlots(p1, p2, type = "h")
```

```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p1, p2, type = "h", draw=FALSE), 
    name = "Plot-TSNE-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    addDOC = FALSE,
    width = 10, 
    height = 5
)
```

To save a nice looking pdf we use plotPDF which removes white pages and tries to make the plots
nice looking.

```{r eval=FALSE}
plotPDF(p1,p2, name = "Plot-TSNE-Sample-Clusters.pdf", ArchRProj = projHemeND, addDOC = FALSE, width = 5, height = 5)
```

## UMAP of other Reduced Dimensions

```{r eval=FALSE}
projHemeND <- addUMAP(
    ArchRProj = projHemeND, 
    reducedDims = "IterativeLSI2", 
    name = "UMAP2", 
    nNeighbors = 30, 
    minDist = 0.5, 
    metric = "cosine"
)

p1 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "UMAP2")
p2 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "UMAP2")
ggAlignPlots(p1, p2, type = "h")
```


```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p1, p2, type = "h", draw=FALSE), 
    name = "Plot-UMAP2-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    addDOC = FALSE,
    width = 10, 
    height = 5
)
```

```{r eval=FALSE}
projHemeND <- addUMAP(
    ArchRProj = projHemeND, 
    reducedDims = "Harmony", 
    name = "UMAPHarmony", 
    nNeighbors = 30, 
    minDist = 0.5, 
    metric = "cosine"
)
p3 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "UMAPHarmony")
p4 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "UMAPHarmony")
ggAlignPlots(p3, p4, type = "h")
```

```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p3, p4, type = "h", draw=FALSE), 
    name = "Plot-UMAPHarmony-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    addDOC = FALSE,
    width = 10, 
    height = 5
)
```

To save a nice looking pdf we use plotPDF which removes white pages and tries to make the plots
nice looking.

```{r eval=FALSE}
plotPDF(p1,p2,p3,p4, name = "Plot-UMAP2Harmony-Sample-Clusters.pdf", ArchRProj = projHemeND, addDOC = FALSE, width = 5, height = 5)
```

## tSNE of other Reduced Dimensions

```{r eval=FALSE}
projHemeND <- addTSNE(
    ArchRProj = projHemeND, 
    reducedDims = "IterativeLSI2", 
    name = "TSNE2", 
    perplexity = 30
)

p1 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "TSNE2")
p2 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "TSNE2")
ggAlignPlots(p1, p2, type = "h")
```


```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p1, p2, type = "h", draw=FALSE), 
    name = "Plot-TSNE2-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    addDOC = FALSE,
    width = 10, 
    height = 5
)
```

```{r eval=FALSE}
projHemeND <- addTSNE(
    ArchRProj = projHemeND, 
    reducedDims = "Harmony", 
    name = "TSNEHarmony", 
    perplexity = 30
)
p3 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Sample", embedding = "TSNEHarmony")
p4 <- plotEmbedding(ArchRProj = projHemeND, colorBy = "cellColData", name = "Clusters", embedding = "TSNEHarmony")
ggAlignPlots(p3, p4, type = "h")
```

```{r, include=FALSE, eval = FALSE}
plotPDF(
    ggAlignPlots(p3, p4, type = "h", draw=FALSE), 
    name = "Plot-TSNEHarmony-Sample-Clusters-Combined.pdf", 
    ArchRProj = projHemeND,
    addDOC = FALSE,
    width = 10, 
    height = 5
)
```

To save a nice looking pdf we use plotPDF which removes white pages and tries to make the plots
nice looking.

```{r eval=FALSE}
plotPDF(p1,p2,p3,p4, name = "Plot-TSNE2Harmony-Sample-Clusters.pdf", ArchRProj = projHemeND, addDOC = FALSE, width = 5, height = 5)
```



