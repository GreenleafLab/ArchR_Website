<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Creating Arrow Files | ArchR</title>
  <meta name="description" content="A guide to ArchR" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Creating Arrow Files | ArchR" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide to ArchR" />
  <meta name="github-repo" content="GreenleafLab/ArchR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Creating Arrow Files | ArchR" />
  
  <meta name="twitter:description" content="A guide to ArchR" />
  

<meta name="author" content="Jeffrey Granja and Ryan Corces" />


<meta name="date" content="2020-02-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="filtering-doublets-from-an-archrproject.html"/>
<link rel="next" href="qc-tss-scores-by-unique-fragments.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://greenleaflab.github.io/ArchR/">Back to ArchR Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-archr.html"><a href="getting-started-with-archr.html"><i class="fa fa-check"></i><b>1</b> Getting Started with ArchR</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-an-arrowfile-archrproject.html"><a href="what-is-an-arrowfile-archrproject.html"><i class="fa fa-check"></i><b>1.1</b> What is an <code>ArrowFile</code> / <code>ArchRProject</code>?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>1.2</b> Getting Set Up</a></li>
<li class="chapter" data-level="1.3" data-path="creating-arrow-files.html"><a href="creating-arrow-files.html"><i class="fa fa-check"></i><b>1.3</b> Creating Arrow Files</a></li>
<li class="chapter" data-level="1.4" data-path="inferring-scatac-seq-doublets-with-archr.html"><a href="inferring-scatac-seq-doublets-with-archr.html"><i class="fa fa-check"></i><b>1.4</b> Inferring scATAC-seq Doublets with ArchR</a></li>
<li class="chapter" data-level="1.5" data-path="creating-an-archrproject.html"><a href="creating-an-archrproject.html"><i class="fa fa-check"></i><b>1.5</b> Creating An ArchRProject</a></li>
<li class="chapter" data-level="1.6" data-path="manipulating-an-archrproject.html"><a href="manipulating-an-archrproject.html"><i class="fa fa-check"></i><b>1.6</b> Manipulating An ArchRProject</a></li>
<li class="chapter" data-level="1.7" data-path="filtering-doublets-from-an-archrproject.html"><a href="filtering-doublets-from-an-archrproject.html"><i class="fa fa-check"></i><b>1.7</b> Filtering Doublets from an ArchRProject</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="creating-arrow-files-1.html"><a href="creating-arrow-files-1.html"><i class="fa fa-check"></i><b>2</b> Creating Arrow Files</a>
<ul>
<li class="chapter" data-level="2.1" data-path="qc-tss-scores-by-unique-fragments.html"><a href="qc-tss-scores-by-unique-fragments.html"><i class="fa fa-check"></i><b>2.1</b> QC TSS Scores by Unique Fragments</a></li>
<li class="chapter" data-level="2.2" data-path="qc-fragment-size-distribution.html"><a href="qc-fragment-size-distribution.html"><i class="fa fa-check"></i><b>2.2</b> QC Fragment Size Distribution</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ArchR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-arrow-files-1" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Creating Arrow Files</h1>
<p>For this tutorial, we will download a collection of fragment files. Fragment files are one of the base file types of the 10x Genomics analytical platform (and other platforms) and can be easily created from any BAM file. See <a href="articles/Articles/inputFiles.html">the ArchR input file types vignette</a> for information on making your own fragment files for input to ArchR. Once we have our fragment files, we provide their paths as a character vector to <code>createArrowFiles()</code>. During creation, some basic metadata and matrices are added to each <code>ArrowFile</code> including a “TileMatrix” containing insertion counts across genome-wide 500-bp bins (see <code>addTileMatrix()</code>) and a “GeneScoreMatrix” that is determined based on weighting insertion counts in tiles nearby a gene promoter (see <code>addGeneScoreMatrix()</code>). These gene activity scores are described in more depth in the <a href="articles/Articles/geneScores.html">Gene Activity Score vignette</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="creating-arrow-files-1.html#cb8-1"></a><span class="co">#Get Tutorial Data ~1GB To Download (if downloaded already ArchR will bypass downloading).</span></span>
<span id="cb8-2"><a href="creating-arrow-files-1.html#cb8-2"></a>inputFiles &lt;-<span class="st"> </span><span class="kw">getTutorialData</span>(<span class="st">&quot;Hematopoiesis&quot;</span>)</span>
<span id="cb8-3"><a href="creating-arrow-files-1.html#cb8-3"></a></span>
<span id="cb8-4"><a href="creating-arrow-files-1.html#cb8-4"></a><span class="co">#Create Arrow Files (~10-15 minutes) w/ helpful messages displaying progress.</span></span>
<span id="cb8-5"><a href="creating-arrow-files-1.html#cb8-5"></a><span class="co">#For each sample, this step will:</span></span>
<span id="cb8-6"><a href="creating-arrow-files-1.html#cb8-6"></a><span class="co"># 1. Read accessible fragments.</span></span>
<span id="cb8-7"><a href="creating-arrow-files-1.html#cb8-7"></a><span class="co"># 2. Calculate QC Information for each cell (TSS Enrichment, Nucleosome info).</span></span>
<span id="cb8-8"><a href="creating-arrow-files-1.html#cb8-8"></a><span class="co"># 3. Filter cells based on QC parameters.</span></span>
<span id="cb8-9"><a href="creating-arrow-files-1.html#cb8-9"></a><span class="co"># 4. Create a genome-wide TileMatrix using 500-bp bins.</span></span>
<span id="cb8-10"><a href="creating-arrow-files-1.html#cb8-10"></a><span class="co"># 5. Create a GeneScoreMatrix using the provided geneAnnotation.</span></span>
<span id="cb8-11"><a href="creating-arrow-files-1.html#cb8-11"></a>ArrowFiles &lt;-<span class="st"> </span><span class="kw">createArrowFiles</span>(</span>
<span id="cb8-12"><a href="creating-arrow-files-1.html#cb8-12"></a>  <span class="dt">inputFiles =</span> inputFiles,</span>
<span id="cb8-13"><a href="creating-arrow-files-1.html#cb8-13"></a>  <span class="dt">sampleNames =</span> <span class="kw">names</span>(inputFiles),</span>
<span id="cb8-14"><a href="creating-arrow-files-1.html#cb8-14"></a>  <span class="dt">filterTSS =</span> <span class="dv">4</span>, <span class="co">#Dont set this too high because you can always increase later</span></span>
<span id="cb8-15"><a href="creating-arrow-files-1.html#cb8-15"></a>  <span class="dt">filterFrags =</span> <span class="dv">1000</span>, </span>
<span id="cb8-16"><a href="creating-arrow-files-1.html#cb8-16"></a>  <span class="dt">addTileMat =</span> <span class="ot">TRUE</span>,</span>
<span id="cb8-17"><a href="creating-arrow-files-1.html#cb8-17"></a>  <span class="dt">addGeneScoreMat =</span> <span class="ot">TRUE</span></span>
<span id="cb8-18"><a href="creating-arrow-files-1.html#cb8-18"></a>  )</span></code></pre></div>
<hr /> 
</div>
            </section>

          </div>
        </div>
      </div>
<a href="filtering-doublets-from-an-archrproject.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="qc-tss-scores-by-unique-fragments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/GreenleafLab/ArchR_Website/edit/dev/02_CreateArrows.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/GreenleafLab/ArchR_Website/commits/dev/02_CreateArrows.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": "https://github.com/GreenleafLab/ArchR_Website/view/dev/02_CreateArrows.Rmd",
"text": "View source on GitHub"
},
"download": ["ArchR.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
