<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14.2 ArchR Enrichment | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</title>
  <meta name="description" content="A guide to ArchR" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="14.2 ArchR Enrichment | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A guide to ArchR" />
  <meta name="github-repo" content="GreenleafLab/ArchR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14.2 ArchR Enrichment | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  
  <meta name="twitter:description" content="A guide to ArchR" />
  

<meta name="author" content="Jeffrey Granja and Ryan Corces" />


<meta name="date" content="2022-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="motif-enrichment.html"/>
<link rel="next" href="custom-enrichment.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../index.html">Back to ArchR Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><img src="images/ArchR_Logo_Integrated.png" alt="" width="200"></a></li>
<li class="chapter" data-level="1" data-path="debugging-and-troubleshooting-in-archr.html"><a href="debugging-and-troubleshooting-in-archr.html"><i class="fa fa-check"></i><b>1</b> Debugging and Troubleshooting in ArchR</a></li>
<li class="chapter" data-level="2" data-path="manage-archrs-dependencies.html"><a href="manage-archrs-dependencies.html"><i class="fa fa-check"></i><b>2</b> Manage ArchRâ€™s Dependencies</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-renv-to-manage-dependencies.html"><a href="using-renv-to-manage-dependencies.html"><i class="fa fa-check"></i><b>2.1</b> Using renv to manage dependencies</a></li>
<li class="chapter" data-level="2.2" data-path="other-environment-managers.html"><a href="other-environment-managers.html"><i class="fa fa-check"></i><b>2.2</b> Other environment managers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-archr.html"><a href="getting-started-with-archr.html"><i class="fa fa-check"></i><b>3</b> Getting Started with ArchR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="a-brief-primer-on-atac-seq-terminology.html"><a href="a-brief-primer-on-atac-seq-terminology.html"><i class="fa fa-check"></i><b>3.1</b> A Brief Primer on ATAC-seq Terminology</a></li>
<li class="chapter" data-level="3.2" data-path="why-use-archr.html"><a href="why-use-archr.html"><i class="fa fa-check"></i><b>3.2</b> Why use ArchR?</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-an-arrow-file-archrproject.html"><a href="what-is-an-arrow-file-archrproject.html"><i class="fa fa-check"></i><b>3.3</b> What is an Arrow file / <code>ArchRProject</code>?</a></li>
<li class="chapter" data-level="3.4" data-path="input-file-types-in-archr.html"><a href="input-file-types-in-archr.html"><i class="fa fa-check"></i><b>3.4</b> Input File Types in ArchR</a></li>
<li class="chapter" data-level="3.5" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>3.5</b> Getting Set Up</a></li>
<li class="chapter" data-level="3.6" data-path="creating-arrow-files.html"><a href="creating-arrow-files.html"><i class="fa fa-check"></i><b>3.6</b> Creating Arrow Files</a></li>
<li class="chapter" data-level="3.7" data-path="per-cell-quality-control.html"><a href="per-cell-quality-control.html"><i class="fa fa-check"></i><b>3.7</b> Per-cell Quality Control</a></li>
<li class="chapter" data-level="3.8" data-path="using-bam-files-for-arrow-file-creation.html"><a href="using-bam-files-for-arrow-file-creation.html"><i class="fa fa-check"></i><b>3.8</b> Using BAM files for Arrow File creation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doublet-inference-with-archr.html"><a href="doublet-inference-with-archr.html"><i class="fa fa-check"></i><b>4</b> Doublet Inference with ArchR</a>
<ul>
<li class="chapter" data-level="4.1" data-path="how-does-doublet-identification-work-in-archr.html"><a href="how-does-doublet-identification-work-in-archr.html"><i class="fa fa-check"></i><b>4.1</b> How does doublet identification work in ArchR?</a></li>
<li class="chapter" data-level="4.2" data-path="inferring-scatac-seq-doublets-with-archr.html"><a href="inferring-scatac-seq-doublets-with-archr.html"><i class="fa fa-check"></i><b>4.2</b> Inferring scATAC-seq Doublets with ArchR</a></li>
<li class="chapter" data-level="4.3" data-path="using-demuxlet-with-archr.html"><a href="using-demuxlet-with-archr.html"><i class="fa fa-check"></i><b>4.3</b> Using <em>demuxlet</em> with ArchR</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-an-archrproject.html"><a href="creating-an-archrproject.html"><i class="fa fa-check"></i><b>5</b> Creating an ArchRProject</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-an-archrproject-1.html"><a href="creating-an-archrproject-1.html"><i class="fa fa-check"></i><b>5.1</b> Creating An ArchRProject</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-an-archrproject.html"><a href="manipulating-an-archrproject.html"><i class="fa fa-check"></i><b>5.2</b> Manipulating An ArchRProject</a></li>
<li class="chapter" data-level="5.3" data-path="plotting-sample-statistics-from-an-archrproject.html"><a href="plotting-sample-statistics-from-an-archrproject.html"><i class="fa fa-check"></i><b>5.3</b> Plotting Sample Statistics from an ArchRProject</a></li>
<li class="chapter" data-level="5.4" data-path="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles..html"><a href="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles..html"><i class="fa fa-check"></i><b>5.4</b> Plotting Sample Fragment Size Distribution and TSS Enrichment Profiles.</a></li>
<li class="chapter" data-level="5.5" data-path="saving-and-loading-an-archrproject.html"><a href="saving-and-loading-an-archrproject.html"><i class="fa fa-check"></i><b>5.5</b> Saving and Loading an <code>ArchRProject</code></a></li>
<li class="chapter" data-level="5.6" data-path="filtering-doublets-from-an-archrproject.html"><a href="filtering-doublets-from-an-archrproject.html"><i class="fa fa-check"></i><b>5.6</b> Filtering Doublets from an ArchRProject</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dimensionality-reduction-with-archr.html"><a href="dimensionality-reduction-with-archr.html"><i class="fa fa-check"></i><b>6</b> Dimensionality Reduction with ArchR</a>
<ul>
<li class="chapter" data-level="6.1" data-path="archrs-lsi-implementation.html"><a href="archrs-lsi-implementation.html"><i class="fa fa-check"></i><b>6.1</b> ArchRâ€™s LSI Implementation</a></li>
<li class="chapter" data-level="6.2" data-path="iterative-latent-semantic-indexing-lsi.html"><a href="iterative-latent-semantic-indexing-lsi.html"><i class="fa fa-check"></i><b>6.2</b> Iterative Latent Semantic Indexing (LSI)</a></li>
<li class="chapter" data-level="6.3" data-path="estimated-lsi.html"><a href="estimated-lsi.html"><i class="fa fa-check"></i><b>6.3</b> Estimated LSI</a></li>
<li class="chapter" data-level="6.4" data-path="batch-effect-correction-wtih-harmony.html"><a href="batch-effect-correction-wtih-harmony.html"><i class="fa fa-check"></i><b>6.4</b> Batch Effect Correction wtih Harmony</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering-with-archr.html"><a href="clustering-with-archr.html"><i class="fa fa-check"></i><b>7</b> Clustering with ArchR</a>
<ul>
<li class="chapter" data-level="7.1" data-path="clustering-using-seurats-findclusters-function.html"><a href="clustering-using-seurats-findclusters-function.html"><i class="fa fa-check"></i><b>7.1</b> Clustering using Seuratâ€™s <code>FindClusters()</code> function</a></li>
<li class="chapter" data-level="7.2" data-path="clustering-using-scran.html"><a href="clustering-using-scran.html"><i class="fa fa-check"></i><b>7.2</b> Clustering using <code>scran</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="single-cell-embeddings.html"><a href="single-cell-embeddings.html"><i class="fa fa-check"></i><b>8</b> Single-cell Embeddings</a>
<ul>
<li class="chapter" data-level="8.1" data-path="uniform-manifold-approximation-and-projection-umap.html"><a href="uniform-manifold-approximation-and-projection-umap.html"><i class="fa fa-check"></i><b>8.1</b> Uniform Manifold Approximation and Projection (UMAP)</a></li>
<li class="chapter" data-level="8.2" data-path="t-stocastic-neighbor-embedding-t-sne.html"><a href="t-stocastic-neighbor-embedding-t-sne.html"><i class="fa fa-check"></i><b>8.2</b> t-Stocastic Neighbor Embedding (t-SNE)</a></li>
<li class="chapter" data-level="8.3" data-path="dimensionality-reduction-after-harmony.html"><a href="dimensionality-reduction-after-harmony.html"><i class="fa fa-check"></i><b>8.3</b> Dimensionality Reduction After Harmony</a></li>
<li class="chapter" data-level="8.4" data-path="highlighting-specific-cells-on-an-embedding.html"><a href="highlighting-specific-cells-on-an-embedding.html"><i class="fa fa-check"></i><b>8.4</b> Highlighting specific cells on an embedding</a></li>
<li class="chapter" data-level="8.5" data-path="importing-an-embedding-from-external-software.html"><a href="importing-an-embedding-from-external-software.html"><i class="fa fa-check"></i><b>8.5</b> Importing an embedding from external software</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gene-scores-and-marker-genes-with-archr.html"><a href="gene-scores-and-marker-genes-with-archr.html"><i class="fa fa-check"></i><b>9</b> Gene Scores and Marker Genes with ArchR</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-gene-scores-in-archr.html"><a href="calculating-gene-scores-in-archr.html"><i class="fa fa-check"></i><b>9.1</b> Calculating Gene Scores in ArchR</a></li>
<li class="chapter" data-level="9.2" data-path="identification-of-marker-features.html"><a href="identification-of-marker-features.html"><i class="fa fa-check"></i><b>9.2</b> Identification of Marker Features</a></li>
<li class="chapter" data-level="9.3" data-path="identifying-marker-genes.html"><a href="identifying-marker-genes.html"><i class="fa fa-check"></i><b>9.3</b> Identifying Marker Genes</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-marker-genes-on-an-embedding.html"><a href="visualizing-marker-genes-on-an-embedding.html"><i class="fa fa-check"></i><b>9.4</b> Visualizing Marker Genes on an Embedding</a></li>
<li class="chapter" data-level="9.5" data-path="marker-genes-imputation-with-magic.html"><a href="marker-genes-imputation-with-magic.html"><i class="fa fa-check"></i><b>9.5</b> Marker Genes Imputation with MAGIC</a></li>
<li class="chapter" data-level="9.6" data-path="module-scores.html"><a href="module-scores.html"><i class="fa fa-check"></i><b>9.6</b> Module Scores</a></li>
<li class="chapter" data-level="9.7" data-path="track-plotting-with-archrbrowser.html"><a href="track-plotting-with-archrbrowser.html"><i class="fa fa-check"></i><b>9.7</b> Track Plotting with ArchRBrowser</a></li>
<li class="chapter" data-level="9.8" data-path="launching-the-interactive-archrbrowser.html"><a href="launching-the-interactive-archrbrowser.html"><i class="fa fa-check"></i><b>9.8</b> Launching the Interactive ArchRBrowser</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="defining-cluster-identity-with-scrna-seq.html"><a href="defining-cluster-identity-with-scrna-seq.html"><i class="fa fa-check"></i><b>10</b> Defining Cluster Identity with scRNA-seq</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cross-platform-linkage-of-scatac-seq-cells-with-scrna-seq-cells.html"><a href="cross-platform-linkage-of-scatac-seq-cells-with-scrna-seq-cells.html"><i class="fa fa-check"></i><b>10.1</b> Cross-platform linkage of scATAC-seq cells with scRNA-seq cells</a></li>
<li class="chapter" data-level="10.2" data-path="adding-pseudo-scrna-seq-profiles-for-each-scatac-seq-cell.html"><a href="adding-pseudo-scrna-seq-profiles-for-each-scatac-seq-cell.html"><i class="fa fa-check"></i><b>10.2</b> Adding Pseudo-scRNA-seq profiles for each scATAC-seq cell</a></li>
<li class="chapter" data-level="10.3" data-path="labeling-scatac-seq-clusters-with-scrna-seq-information.html"><a href="labeling-scatac-seq-clusters-with-scrna-seq-information.html"><i class="fa fa-check"></i><b>10.3</b> Labeling scATAC-seq clusters with scRNA-seq information</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pseudo-bulk-replicates-in-archr.html"><a href="pseudo-bulk-replicates-in-archr.html"><i class="fa fa-check"></i><b>11</b> Pseudo-bulk Replicates in ArchR</a>
<ul>
<li class="chapter" data-level="11.1" data-path="how-does-archr-make-pseudo-bulk-replicates.html"><a href="how-does-archr-make-pseudo-bulk-replicates.html"><i class="fa fa-check"></i><b>11.1</b> How Does ArchR Make Pseudo-bulk Replicates?</a></li>
<li class="chapter" data-level="11.2" data-path="making-pseudo-bulk-replicates.html"><a href="making-pseudo-bulk-replicates.html"><i class="fa fa-check"></i><b>11.2</b> Making Pseudo-bulk Replicates</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="calling-peaks-with-archr.html"><a href="calling-peaks-with-archr.html"><i class="fa fa-check"></i><b>12</b> Calling Peaks with ArchR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-iterative-overlap-peak-merging-procedure.html"><a href="the-iterative-overlap-peak-merging-procedure.html"><i class="fa fa-check"></i><b>12.1</b> The Iterative Overlap Peak Merging Procedure</a></li>
<li class="chapter" data-level="12.2" data-path="calling-peaks-w-macs2.html"><a href="calling-peaks-w-macs2.html"><i class="fa fa-check"></i><b>12.2</b> Calling Peaks w/ Macs2</a></li>
<li class="chapter" data-level="12.3" data-path="calling-peaks-w-tilematrix.html"><a href="calling-peaks-w-tilematrix.html"><i class="fa fa-check"></i><b>12.3</b> Calling Peaks w/ TileMatrix</a></li>
<li class="chapter" data-level="12.4" data-path="adding-a-peak-matrix.html"><a href="adding-a-peak-matrix.html"><i class="fa fa-check"></i><b>12.4</b> Adding a Peak Matrix</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="identifying-marker-peaks.html"><a href="identifying-marker-peaks.html"><i class="fa fa-check"></i><b>13</b> Identifying Marker Peaks</a>
<ul>
<li class="chapter" data-level="13.1" data-path="identifying-marker-peaks-with-archr.html"><a href="identifying-marker-peaks-with-archr.html"><i class="fa fa-check"></i><b>13.1</b> Identifying Marker Peaks with ArchR</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-marker-peaks-in-archr.html"><a href="plotting-marker-peaks-in-archr.html"><i class="fa fa-check"></i><b>13.2</b> Plotting Marker Peaks in ArchR</a></li>
<li class="chapter" data-level="13.3" data-path="pairwise-testing-between-groups.html"><a href="pairwise-testing-between-groups.html"><i class="fa fa-check"></i><b>13.3</b> Pairwise Testing Between Groups</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="motif-and-feature-enrichment-with-archr.html"><a href="motif-and-feature-enrichment-with-archr.html"><i class="fa fa-check"></i><b>14</b> Motif and Feature Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="14.1" data-path="motif-enrichment.html"><a href="motif-enrichment.html"><i class="fa fa-check"></i><b>14.1</b> Motif Enrichment</a></li>
<li class="chapter" data-level="14.2" data-path="archr-enrichment.html"><a href="archr-enrichment.html"><i class="fa fa-check"></i><b>14.2</b> ArchR Enrichment</a></li>
<li class="chapter" data-level="14.3" data-path="custom-enrichment.html"><a href="custom-enrichment.html"><i class="fa fa-check"></i><b>14.3</b> Custom Enrichment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chromvar-deviatons-enrichment-with-archr.html"><a href="chromvar-deviatons-enrichment-with-archr.html"><i class="fa fa-check"></i><b>15</b> ChromVAR Deviatons Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="15.1" data-path="motif-deviations.html"><a href="motif-deviations.html"><i class="fa fa-check"></i><b>15.1</b> Motif Deviations</a></li>
<li class="chapter" data-level="15.2" data-path="archr-and-custom-deviations.html"><a href="archr-and-custom-deviations.html"><i class="fa fa-check"></i><b>15.2</b> ArchR and Custom Deviations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="footprinting-with-archr.html"><a href="footprinting-with-archr.html"><i class="fa fa-check"></i><b>16</b> Footprinting with ArchR</a>
<ul>
<li class="chapter" data-level="16.1" data-path="motif-footprinting.html"><a href="motif-footprinting.html"><i class="fa fa-check"></i><b>16.1</b> Motif Footprinting</a></li>
<li class="chapter" data-level="16.2" data-path="normalization-of-footprints-for-tn5-bias.html"><a href="normalization-of-footprints-for-tn5-bias.html"><i class="fa fa-check"></i><b>16.2</b> Normalization of Footprints for Tn5 Bias</a></li>
<li class="chapter" data-level="16.3" data-path="feature-footprinting.html"><a href="feature-footprinting.html"><i class="fa fa-check"></i><b>16.3</b> Feature Footprinting</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="integrative-analysis-with-archr.html"><a href="integrative-analysis-with-archr.html"><i class="fa fa-check"></i><b>17</b> Integrative Analysis with ArchR</a>
<ul>
<li class="chapter" data-level="17.1" data-path="creating-low-overlapping-aggregates-of-cells.html"><a href="creating-low-overlapping-aggregates-of-cells.html"><i class="fa fa-check"></i><b>17.1</b> Creating Low-Overlapping Aggregates of Cells</a></li>
<li class="chapter" data-level="17.2" data-path="co-accessibility-with-archr.html"><a href="co-accessibility-with-archr.html"><i class="fa fa-check"></i><b>17.2</b> Co-accessibility with ArchR</a></li>
<li class="chapter" data-level="17.3" data-path="peak2genelinkage-with-archr.html"><a href="peak2genelinkage-with-archr.html"><i class="fa fa-check"></i><b>17.3</b> Peak2GeneLinkage with ArchR</a></li>
<li class="chapter" data-level="17.4" data-path="identification-of-positive-tf-regulators.html"><a href="identification-of-positive-tf-regulators.html"><i class="fa fa-check"></i><b>17.4</b> Identification of Positive TF-Regulators</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="trajectory-analysis-with-archr.html"><a href="trajectory-analysis-with-archr.html"><i class="fa fa-check"></i><b>18</b> Trajectory Analysis with ArchR</a>
<ul>
<li class="chapter" data-level="18.1" data-path="myeloid-trajectory---monocyte-differentiation.html"><a href="myeloid-trajectory---monocyte-differentiation.html"><i class="fa fa-check"></i><b>18.1</b> Myeloid Trajectory - Monocyte Differentiation</a></li>
<li class="chapter" data-level="18.2" data-path="lymphoid-trajectory---b-cell-cifferentiation.html"><a href="lymphoid-trajectory---b-cell-cifferentiation.html"><i class="fa fa-check"></i><b>18.2</b> Lymphoid Trajectory - B Cell Cifferentiation</a></li>
<li class="chapter" data-level="18.3" data-path="monocle3-trajectories.html"><a href="monocle3-trajectories.html"><i class="fa fa-check"></i><b>18.3</b> Monocle3 Trajectories</a></li>
<li class="chapter" data-level="18.4" data-path="slingshot-trajectories.html"><a href="slingshot-trajectories.html"><i class="fa fa-check"></i><b>18.4</b> Slingshot Trajectories</a></li>
<li class="chapter" data-level="18.5" data-path="comparing-the-different-trajectories.html"><a href="comparing-the-different-trajectories.html"><i class="fa fa-check"></i><b>18.5</b> Comparing the different trajectories</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="handling-archr-output.html"><a href="handling-archr-output.html"><i class="fa fa-check"></i><b>19</b> Handling ArchR Output</a>
<ul>
<li class="chapter" data-level="19.1" data-path="exporting-fragment-level-data.html"><a href="exporting-fragment-level-data.html"><i class="fa fa-check"></i><b>19.1</b> Exporting fragment-level data</a></li>
<li class="chapter" data-level="19.2" data-path="exporting-matrix-level-data.html"><a href="exporting-matrix-level-data.html"><i class="fa fa-check"></i><b>19.2</b> Exporting matrix-level data</a></li>
<li class="chapter" data-level="19.3" data-path="exporting-pseudo-bulked-data-to-a-summarizedexperiment.html"><a href="exporting-pseudo-bulked-data-to-a-summarizedexperiment.html"><i class="fa fa-check"></i><b>19.3</b> Exporting pseudo-bulked data to a <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="19.4" data-path="exporting-pseudo-bulked-data-to-a-bigwig-file.html"><a href="exporting-pseudo-bulked-data-to-a-bigwig-file.html"><i class="fa fa-check"></i><b>19.4</b> Exporting pseudo-bulked data to a bigWig file</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="integration-with-bulk-atac-seq.html"><a href="integration-with-bulk-atac-seq.html"><i class="fa fa-check"></i><b>20</b> Integration with bulk ATAC-seq</a>
<ul>
<li class="chapter" data-level="20.1" data-path="projecting-bulk-atac-seq-data.html"><a href="projecting-bulk-atac-seq-data.html"><i class="fa fa-check"></i><b>20.1</b> Projecting bulk ATAC-seq data</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="multiomic-data-analysis-in-archr.html"><a href="multiomic-data-analysis-in-archr.html"><i class="fa fa-check"></i><b>21</b> Multiomic data analysis in ArchR</a>
<ul>
<li class="chapter" data-level="21.1" data-path="importing-data-and-setting-up-a-multiome-project.html"><a href="importing-data-and-setting-up-a-multiome-project.html"><i class="fa fa-check"></i><b>21.1</b> Importing data and setting up a Multiome project</a></li>
<li class="chapter" data-level="21.2" data-path="analysis-of-multiome-data-in-archr.html"><a href="analysis-of-multiome-data-in-archr.html"><i class="fa fa-check"></i><b>21.2</b> Analysis of multiome data in ArchR</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="plot-aesthetics-in-archr.html"><a href="plot-aesthetics-in-archr.html"><i class="fa fa-check"></i><b>22</b> Plot aesthetics in ArchR</a>
<ul>
<li class="chapter" data-level="22.1" data-path="using-and-manipulating-palettes-in-archr.html"><a href="using-and-manipulating-palettes-in-archr.html"><i class="fa fa-check"></i><b>22.1</b> Using and manipulating palettes in ArchR</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="testing-your-archr-installation.html"><a href="testing-your-archr-installation.html"><i class="fa fa-check"></i><b>23</b> Testing Your ArchR Installation</a></li>
<li class="chapter" data-level="24" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>24</b> Session Information</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="archr-enrichment" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> ArchR Enrichment<a href="archr-enrichment.html#archr-enrichment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to testing peaks for enrichment of motifs, ArchR also enables the determination of more customizable enrichments. To facilitate this level of data exploration, we have curated a few different feature sets that can be easily tested for enrichment in your peak regions of interest. We describe each of those curated feature sets below. This type of analysis was originally inspired by <a href="http://code.databio.org/LOLA/">LOLA</a>.</p>
<div id="encode-tf-binding-sites" class="section level3 hasAnchor" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Encode TF Binding Sites<a href="archr-enrichment.html#encode-tf-binding-sites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ENCODE consortium has mapped TF binding sites (TFBSs) across a wide array of cell types and factors. We can use these TFBS collections to better understand our clusters. For example, in the context of truly unknown cell types, these enrichments could help to elucidate cell identity. To enable analyses with these ENCODE TFBS feature sets, we simply call the <code>addArchRAnnotations()</code> function with <code>collection = "EncodeTFBS"</code>. Similar to what happens when using <code>addPeakAnnotations()</code>, this creates a binarized representation of the overlap between all marker peaks and all ENCODE TFBS.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="archr-enrichment.html#cb249-1" aria-hidden="true" tabindex="-1"></a>projHeme5 <span class="ot">&lt;-</span> <span class="fu">addArchRAnnotations</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">collection =</span> <span class="st">&quot;EncodeTFBS&quot;</span>)</span>
<span id="cb249-2"><a href="archr-enrichment.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-addArchRAnnotations-371b02290586d-Date-2022-12-23_Time-07-59-07.log</span></span>
<span id="cb249-3"><a href="archr-enrichment.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb249-4"><a href="archr-enrichment.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Annotating Chromosomes</span></span>
<span id="cb249-5"><a href="archr-enrichment.html#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:09 :</span></span>
<span id="cb249-6"><a href="archr-enrichment.html#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr1</span></span>
<span id="cb249-7"><a href="archr-enrichment.html#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:09 :</span></span>
<span id="cb249-8"><a href="archr-enrichment.html#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr2</span></span>
<span id="cb249-9"><a href="archr-enrichment.html#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:09 :</span></span>
<span id="cb249-10"><a href="archr-enrichment.html#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr3</span></span>
<span id="cb249-11"><a href="archr-enrichment.html#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:09 :</span></span>
<span id="cb249-12"><a href="archr-enrichment.html#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr4</span></span>
<span id="cb249-13"><a href="archr-enrichment.html#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:10 :</span></span>
<span id="cb249-14"><a href="archr-enrichment.html#cb249-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr5</span></span>
<span id="cb249-15"><a href="archr-enrichment.html#cb249-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:10 :</span></span>
<span id="cb249-16"><a href="archr-enrichment.html#cb249-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr6</span></span>
<span id="cb249-17"><a href="archr-enrichment.html#cb249-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:10 :</span></span>
<span id="cb249-18"><a href="archr-enrichment.html#cb249-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr7</span></span>
<span id="cb249-19"><a href="archr-enrichment.html#cb249-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:10 :</span></span>
<span id="cb249-20"><a href="archr-enrichment.html#cb249-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr8</span></span>
<span id="cb249-21"><a href="archr-enrichment.html#cb249-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:11 :</span></span>
<span id="cb249-22"><a href="archr-enrichment.html#cb249-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr9</span></span>
<span id="cb249-23"><a href="archr-enrichment.html#cb249-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:11 :</span></span>
<span id="cb249-24"><a href="archr-enrichment.html#cb249-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr10</span></span>
<span id="cb249-25"><a href="archr-enrichment.html#cb249-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:11 :</span></span>
<span id="cb249-26"><a href="archr-enrichment.html#cb249-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr11</span></span>
<span id="cb249-27"><a href="archr-enrichment.html#cb249-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:11 :</span></span>
<span id="cb249-28"><a href="archr-enrichment.html#cb249-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr12</span></span>
<span id="cb249-29"><a href="archr-enrichment.html#cb249-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:11 :</span></span>
<span id="cb249-30"><a href="archr-enrichment.html#cb249-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr13</span></span>
<span id="cb249-31"><a href="archr-enrichment.html#cb249-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-32"><a href="archr-enrichment.html#cb249-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr14</span></span>
<span id="cb249-33"><a href="archr-enrichment.html#cb249-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-34"><a href="archr-enrichment.html#cb249-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr15</span></span>
<span id="cb249-35"><a href="archr-enrichment.html#cb249-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-36"><a href="archr-enrichment.html#cb249-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr16</span></span>
<span id="cb249-37"><a href="archr-enrichment.html#cb249-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-38"><a href="archr-enrichment.html#cb249-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr17</span></span>
<span id="cb249-39"><a href="archr-enrichment.html#cb249-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-40"><a href="archr-enrichment.html#cb249-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr18</span></span>
<span id="cb249-41"><a href="archr-enrichment.html#cb249-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:12 :</span></span>
<span id="cb249-42"><a href="archr-enrichment.html#cb249-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr19</span></span>
<span id="cb249-43"><a href="archr-enrichment.html#cb249-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:13 :</span></span>
<span id="cb249-44"><a href="archr-enrichment.html#cb249-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr20</span></span>
<span id="cb249-45"><a href="archr-enrichment.html#cb249-45" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:13 :</span></span>
<span id="cb249-46"><a href="archr-enrichment.html#cb249-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr21</span></span>
<span id="cb249-47"><a href="archr-enrichment.html#cb249-47" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:13 :</span></span>
<span id="cb249-48"><a href="archr-enrichment.html#cb249-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr22</span></span>
<span id="cb249-49"><a href="archr-enrichment.html#cb249-49" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:13 :</span></span>
<span id="cb249-50"><a href="archr-enrichment.html#cb249-50" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chrX</span></span>
<span id="cb249-51"><a href="archr-enrichment.html#cb249-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:13 :</span></span>
<span id="cb249-52"><a href="archr-enrichment.html#cb249-52" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:15 : All Regions Overlap at least 1 peak!, 0.118 mins elapsed.</span></span>
<span id="cb249-53"><a href="archr-enrichment.html#cb249-53" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-addArchRAnnotations-371b02290586d-Date-2022-12-23_Time-07-59-07.log</span></span></code></pre></div>
<p>We can then test for enrichment of these ENCODE TFBSs with our peak set using the <code>peakAnnoEnrichment()</code> function.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="archr-enrichment.html#cb250-1" aria-hidden="true" tabindex="-1"></a>enrichEncode <span class="ot">&lt;-</span> <span class="fu">peakAnnoEnrichment</span>(</span>
<span id="cb250-2"><a href="archr-enrichment.html#cb250-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">seMarker =</span> markerPeaks,</span>
<span id="cb250-3"><a href="archr-enrichment.html#cb250-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ArchRProj =</span> projHeme5,</span>
<span id="cb250-4"><a href="archr-enrichment.html#cb250-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">peakAnnotation =</span> <span class="st">&quot;EncodeTFBS&quot;</span>,</span>
<span id="cb250-5"><a href="archr-enrichment.html#cb250-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cutOff =</span> <span class="st">&quot;FDR &lt;= 0.1 &amp; Log2FC &gt;= 0.5&quot;</span></span>
<span id="cb250-6"><a href="archr-enrichment.html#cb250-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb250-7"><a href="archr-enrichment.html#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-peakAnnoEnrichment-371b074a88753-Date-2022-12-23_Time-07-59-15.log</span></span>
<span id="cb250-8"><a href="archr-enrichment.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb250-9"><a href="archr-enrichment.html#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:21 : Computing Enrichments 1 of 11, 0.093 mins elapsed.</span></span>
<span id="cb250-10"><a href="archr-enrichment.html#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:21 : Computing Enrichments 2 of 11, 0.096 mins elapsed.</span></span>
<span id="cb250-11"><a href="archr-enrichment.html#cb250-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:21 : Computing Enrichments 3 of 11, 0.1 mins elapsed.</span></span>
<span id="cb250-12"><a href="archr-enrichment.html#cb250-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:21 : Computing Enrichments 4 of 11, 0.103 mins elapsed.</span></span>
<span id="cb250-13"><a href="archr-enrichment.html#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:21 : Computing Enrichments 5 of 11, 0.106 mins elapsed.</span></span>
<span id="cb250-14"><a href="archr-enrichment.html#cb250-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:22 : Computing Enrichments 6 of 11, 0.109 mins elapsed.</span></span>
<span id="cb250-15"><a href="archr-enrichment.html#cb250-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:22 : Computing Enrichments 7 of 11, 0.112 mins elapsed.</span></span>
<span id="cb250-16"><a href="archr-enrichment.html#cb250-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:22 : Computing Enrichments 8 of 11, 0.116 mins elapsed.</span></span>
<span id="cb250-17"><a href="archr-enrichment.html#cb250-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:22 : Computing Enrichments 9 of 11, 0.119 mins elapsed.</span></span>
<span id="cb250-18"><a href="archr-enrichment.html#cb250-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:22 : Computing Enrichments 10 of 11, 0.123 mins elapsed.</span></span>
<span id="cb250-19"><a href="archr-enrichment.html#cb250-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:23 : Computing Enrichments 11 of 11, 0.125 mins elapsed.</span></span>
<span id="cb250-20"><a href="archr-enrichment.html#cb250-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-peakAnnoEnrichment-371b074a88753-Date-2022-12-23_Time-07-59-15.log</span></span></code></pre></div>
<p>As previously, this function returns a <code>SummarizedExperiment</code> object.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="archr-enrichment.html#cb251-1" aria-hidden="true" tabindex="-1"></a>enrichEncode</span>
<span id="cb251-2"><a href="archr-enrichment.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="do">## class: SummarizedExperiment </span></span>
<span id="cb251-3"><a href="archr-enrichment.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="do">## dim: 689 11 </span></span>
<span id="cb251-4"><a href="archr-enrichment.html#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="do">## metadata(0):</span></span>
<span id="cb251-5"><a href="archr-enrichment.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="do">## assays(10): mlog10Padj mlog10p ... CompareFrequency feature</span></span>
<span id="cb251-6"><a href="archr-enrichment.html#cb251-6" aria-hidden="true" tabindex="-1"></a><span class="do">## rownames(689): 1.CTCF-Dnd41... 2.EZH2_39-Dnd41... ...</span></span>
<span id="cb251-7"><a href="archr-enrichment.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   688.CTCF-WERI_Rb_1... 689.CTCF-WI_38...</span></span>
<span id="cb251-8"><a href="archr-enrichment.html#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="do">## rowData names(0):</span></span>
<span id="cb251-9"><a href="archr-enrichment.html#cb251-9" aria-hidden="true" tabindex="-1"></a><span class="do">## colnames(11): B CD4.M ... PreB Progenitor</span></span>
<span id="cb251-10"><a href="archr-enrichment.html#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="do">## colData names(0):</span></span></code></pre></div>
<p>We can create a heatmap from these enrichment results using the <code>plotEnrichHeatmap()</code> function.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="archr-enrichment.html#cb252-1" aria-hidden="true" tabindex="-1"></a>heatmapEncode <span class="ot">&lt;-</span> <span class="fu">plotEnrichHeatmap</span>(enrichEncode, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-2"><a href="archr-enrichment.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotEnrichHeatmap-371b051ab0dfc-Date-2022-12-23_Time-07-59-23.log</span></span>
<span id="cb252-3"><a href="archr-enrichment.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb252-4"><a href="archr-enrichment.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Annotations..</span></span>
<span id="cb252-5"><a href="archr-enrichment.html#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb252-6"><a href="archr-enrichment.html#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb252-7"><a href="archr-enrichment.html#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb252-8"><a href="archr-enrichment.html#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span></code></pre></div>
<p>And then plot this heatmap using <code>ComplexHeatmap::draw()</code>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="archr-enrichment.html#cb253-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(heatmapEncode, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;bot&quot;</span>, <span class="at">annotation_legend_side =</span> <span class="st">&quot;bot&quot;</span>)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-256-1.svg" width="672" /></p>
<p>To save an editable vectorized version of this plot, we use the <code>plotPDF()</code> function.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="archr-enrichment.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPDF</span>(heatmapEncode, <span class="at">name =</span> <span class="st">&quot;EncodeTFBS-Enriched-Marker-Heatmap&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">ArchRProj =</span> projHeme5, <span class="at">addDOC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb254-2"><a href="archr-enrichment.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span></code></pre></div>
</div>
<div id="bulk-atac-seq" class="section level3 hasAnchor" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Bulk ATAC-seq<a href="archr-enrichment.html#bulk-atac-seq" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to the curated set of ENCODE TF binding sites, we have also curated peak calls from bulk ATAC-seq experiments that can be used for overlap enrichment testing. We access these bulk ATAC-seq peak sets by setting <code>collection = "ATAC"</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="archr-enrichment.html#cb255-1" aria-hidden="true" tabindex="-1"></a>projHeme5 <span class="ot">&lt;-</span> <span class="fu">addArchRAnnotations</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">collection =</span> <span class="st">&quot;ATAC&quot;</span>)</span>
<span id="cb255-2"><a href="archr-enrichment.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-addArchRAnnotations-371b0331322e8-Date-2022-12-23_Time-07-59-28.log</span></span>
<span id="cb255-3"><a href="archr-enrichment.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb255-4"><a href="archr-enrichment.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Annotating Chromosomes</span></span>
<span id="cb255-5"><a href="archr-enrichment.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:29 :</span></span>
<span id="cb255-6"><a href="archr-enrichment.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr1</span></span>
<span id="cb255-7"><a href="archr-enrichment.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:29 :</span></span>
<span id="cb255-8"><a href="archr-enrichment.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr2</span></span>
<span id="cb255-9"><a href="archr-enrichment.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:29 :</span></span>
<span id="cb255-10"><a href="archr-enrichment.html#cb255-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr3</span></span>
<span id="cb255-11"><a href="archr-enrichment.html#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:29 :</span></span>
<span id="cb255-12"><a href="archr-enrichment.html#cb255-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr4</span></span>
<span id="cb255-13"><a href="archr-enrichment.html#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-14"><a href="archr-enrichment.html#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr5</span></span>
<span id="cb255-15"><a href="archr-enrichment.html#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-16"><a href="archr-enrichment.html#cb255-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr6</span></span>
<span id="cb255-17"><a href="archr-enrichment.html#cb255-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-18"><a href="archr-enrichment.html#cb255-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr7</span></span>
<span id="cb255-19"><a href="archr-enrichment.html#cb255-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-20"><a href="archr-enrichment.html#cb255-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr8</span></span>
<span id="cb255-21"><a href="archr-enrichment.html#cb255-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-22"><a href="archr-enrichment.html#cb255-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr9</span></span>
<span id="cb255-23"><a href="archr-enrichment.html#cb255-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-24"><a href="archr-enrichment.html#cb255-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr10</span></span>
<span id="cb255-25"><a href="archr-enrichment.html#cb255-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:30 :</span></span>
<span id="cb255-26"><a href="archr-enrichment.html#cb255-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr11</span></span>
<span id="cb255-27"><a href="archr-enrichment.html#cb255-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-28"><a href="archr-enrichment.html#cb255-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr12</span></span>
<span id="cb255-29"><a href="archr-enrichment.html#cb255-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-30"><a href="archr-enrichment.html#cb255-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr13</span></span>
<span id="cb255-31"><a href="archr-enrichment.html#cb255-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-32"><a href="archr-enrichment.html#cb255-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr14</span></span>
<span id="cb255-33"><a href="archr-enrichment.html#cb255-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-34"><a href="archr-enrichment.html#cb255-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr15</span></span>
<span id="cb255-35"><a href="archr-enrichment.html#cb255-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-36"><a href="archr-enrichment.html#cb255-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr16</span></span>
<span id="cb255-37"><a href="archr-enrichment.html#cb255-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-38"><a href="archr-enrichment.html#cb255-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr17</span></span>
<span id="cb255-39"><a href="archr-enrichment.html#cb255-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-40"><a href="archr-enrichment.html#cb255-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr18</span></span>
<span id="cb255-41"><a href="archr-enrichment.html#cb255-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:31 :</span></span>
<span id="cb255-42"><a href="archr-enrichment.html#cb255-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr19</span></span>
<span id="cb255-43"><a href="archr-enrichment.html#cb255-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:32 :</span></span>
<span id="cb255-44"><a href="archr-enrichment.html#cb255-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr20</span></span>
<span id="cb255-45"><a href="archr-enrichment.html#cb255-45" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:32 :</span></span>
<span id="cb255-46"><a href="archr-enrichment.html#cb255-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr21</span></span>
<span id="cb255-47"><a href="archr-enrichment.html#cb255-47" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:32 :</span></span>
<span id="cb255-48"><a href="archr-enrichment.html#cb255-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr22</span></span>
<span id="cb255-49"><a href="archr-enrichment.html#cb255-49" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:32 :</span></span>
<span id="cb255-50"><a href="archr-enrichment.html#cb255-50" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chrX</span></span>
<span id="cb255-51"><a href="archr-enrichment.html#cb255-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:32 :</span></span>
<span id="cb255-52"><a href="archr-enrichment.html#cb255-52" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:33 : All Regions Overlap at least 1 peak!, 0.083 mins elapsed.</span></span>
<span id="cb255-53"><a href="archr-enrichment.html#cb255-53" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-addArchRAnnotations-371b0331322e8-Date-2022-12-23_Time-07-59-28.log</span></span></code></pre></div>
<p>We then test our marker peaks for enrichment of these bulk ATAC-seq peaks by setting <code>peakAnnotation = "ATAC"</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="archr-enrichment.html#cb256-1" aria-hidden="true" tabindex="-1"></a>enrichATAC <span class="ot">&lt;-</span> <span class="fu">peakAnnoEnrichment</span>(</span>
<span id="cb256-2"><a href="archr-enrichment.html#cb256-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">seMarker =</span> markerPeaks,</span>
<span id="cb256-3"><a href="archr-enrichment.html#cb256-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ArchRProj =</span> projHeme5,</span>
<span id="cb256-4"><a href="archr-enrichment.html#cb256-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">peakAnnotation =</span> <span class="st">&quot;ATAC&quot;</span>,</span>
<span id="cb256-5"><a href="archr-enrichment.html#cb256-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cutOff =</span> <span class="st">&quot;FDR &lt;= 0.1 &amp; Log2FC &gt;= 0.5&quot;</span></span>
<span id="cb256-6"><a href="archr-enrichment.html#cb256-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb256-7"><a href="archr-enrichment.html#cb256-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-peakAnnoEnrichment-371b038f7e6c-Date-2022-12-23_Time-07-59-33.log</span></span>
<span id="cb256-8"><a href="archr-enrichment.html#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb256-9"><a href="archr-enrichment.html#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:38 : Computing Enrichments 1 of 11, 0.084 mins elapsed.</span></span>
<span id="cb256-10"><a href="archr-enrichment.html#cb256-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:38 : Computing Enrichments 2 of 11, 0.086 mins elapsed.</span></span>
<span id="cb256-11"><a href="archr-enrichment.html#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:38 : Computing Enrichments 3 of 11, 0.088 mins elapsed.</span></span>
<span id="cb256-12"><a href="archr-enrichment.html#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 4 of 11, 0.09 mins elapsed.</span></span>
<span id="cb256-13"><a href="archr-enrichment.html#cb256-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 5 of 11, 0.098 mins elapsed.</span></span>
<span id="cb256-14"><a href="archr-enrichment.html#cb256-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 6 of 11, 0.1 mins elapsed.</span></span>
<span id="cb256-15"><a href="archr-enrichment.html#cb256-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 7 of 11, 0.101 mins elapsed.</span></span>
<span id="cb256-16"><a href="archr-enrichment.html#cb256-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 8 of 11, 0.103 mins elapsed.</span></span>
<span id="cb256-17"><a href="archr-enrichment.html#cb256-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:39 : Computing Enrichments 9 of 11, 0.104 mins elapsed.</span></span>
<span id="cb256-18"><a href="archr-enrichment.html#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:40 : Computing Enrichments 10 of 11, 0.106 mins elapsed.</span></span>
<span id="cb256-19"><a href="archr-enrichment.html#cb256-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:40 : Computing Enrichments 11 of 11, 0.108 mins elapsed.</span></span>
<span id="cb256-20"><a href="archr-enrichment.html#cb256-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-peakAnnoEnrichment-371b038f7e6c-Date-2022-12-23_Time-07-59-33.log</span></span></code></pre></div>
<p>As before, the output of this is a <code>SummarizedExperiment</code> object with information on the enrichment results.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="archr-enrichment.html#cb257-1" aria-hidden="true" tabindex="-1"></a>enrichATAC</span>
<span id="cb257-2"><a href="archr-enrichment.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="do">## class: SummarizedExperiment </span></span>
<span id="cb257-3"><a href="archr-enrichment.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="do">## dim: 96 11 </span></span>
<span id="cb257-4"><a href="archr-enrichment.html#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="do">## metadata(0):</span></span>
<span id="cb257-5"><a href="archr-enrichment.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="do">## assays(10): mlog10Padj mlog10p ... CompareFrequency feature</span></span>
<span id="cb257-6"><a href="archr-enrichment.html#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="do">## rownames(96): Brain_Astrocytes Brain_Excitatory_neurons ... Heme_MPP</span></span>
<span id="cb257-7"><a href="archr-enrichment.html#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Heme_NK</span></span>
<span id="cb257-8"><a href="archr-enrichment.html#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="do">## rowData names(0):</span></span>
<span id="cb257-9"><a href="archr-enrichment.html#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="do">## colnames(11): B CD4.M ... PreB Progenitor</span></span>
<span id="cb257-10"><a href="archr-enrichment.html#cb257-10" aria-hidden="true" tabindex="-1"></a><span class="do">## colData names(0):</span></span></code></pre></div>
<p>We can create an enrichment heatmap from this <code>SummarizedExperiment</code> using <code>plotEnrichHeatmap()</code>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="archr-enrichment.html#cb258-1" aria-hidden="true" tabindex="-1"></a>heatmapATAC <span class="ot">&lt;-</span> <span class="fu">plotEnrichHeatmap</span>(enrichATAC, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb258-2"><a href="archr-enrichment.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotEnrichHeatmap-371b02ab3f014-Date-2022-12-23_Time-07-59-40.log</span></span>
<span id="cb258-3"><a href="archr-enrichment.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb258-4"><a href="archr-enrichment.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Annotations..</span></span>
<span id="cb258-5"><a href="archr-enrichment.html#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb258-6"><a href="archr-enrichment.html#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb258-7"><a href="archr-enrichment.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb258-8"><a href="archr-enrichment.html#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span></code></pre></div>
<p>And plot this heatmap using <code>ComplexHeatmap::draw()</code></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="archr-enrichment.html#cb259-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(heatmapATAC, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;bot&quot;</span>, <span class="at">annotation_legend_side =</span> <span class="st">&quot;bot&quot;</span>)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-262-1.svg" width="672" /></p>
<p>To save an editable vectorized version of this plot, we use the <code>plotPDF()</code> function.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="archr-enrichment.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPDF</span>(heatmapATAC, <span class="at">name =</span> <span class="st">&quot;ATAC-Enriched-Marker-Heatmap&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">ArchRProj =</span> projHeme5, <span class="at">addDOC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-2"><a href="archr-enrichment.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span></code></pre></div>
</div>
<div id="codex-tfbs" class="section level3 hasAnchor" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Codex TFBS<a href="archr-enrichment.html#codex-tfbs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The same type of analyses can be performed for <a href="http://codex.stemcells.cam.ac.uk/">CODEX</a> TFBSs by setting <code>collection = "Codex"</code>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="archr-enrichment.html#cb261-1" aria-hidden="true" tabindex="-1"></a>projHeme5 <span class="ot">&lt;-</span> <span class="fu">addArchRAnnotations</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">collection =</span> <span class="st">&quot;Codex&quot;</span>)</span>
<span id="cb261-2"><a href="archr-enrichment.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-addArchRAnnotations-371b03bf780a8-Date-2022-12-23_Time-07-59-45.log</span></span>
<span id="cb261-3"><a href="archr-enrichment.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb261-4"><a href="archr-enrichment.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Annotating Chromosomes</span></span>
<span id="cb261-5"><a href="archr-enrichment.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-6"><a href="archr-enrichment.html#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr1</span></span>
<span id="cb261-7"><a href="archr-enrichment.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-8"><a href="archr-enrichment.html#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr2</span></span>
<span id="cb261-9"><a href="archr-enrichment.html#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-10"><a href="archr-enrichment.html#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr3</span></span>
<span id="cb261-11"><a href="archr-enrichment.html#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-12"><a href="archr-enrichment.html#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr4</span></span>
<span id="cb261-13"><a href="archr-enrichment.html#cb261-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-14"><a href="archr-enrichment.html#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr5</span></span>
<span id="cb261-15"><a href="archr-enrichment.html#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:46 :</span></span>
<span id="cb261-16"><a href="archr-enrichment.html#cb261-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr6</span></span>
<span id="cb261-17"><a href="archr-enrichment.html#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-18"><a href="archr-enrichment.html#cb261-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr7</span></span>
<span id="cb261-19"><a href="archr-enrichment.html#cb261-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-20"><a href="archr-enrichment.html#cb261-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr8</span></span>
<span id="cb261-21"><a href="archr-enrichment.html#cb261-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-22"><a href="archr-enrichment.html#cb261-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr9</span></span>
<span id="cb261-23"><a href="archr-enrichment.html#cb261-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-24"><a href="archr-enrichment.html#cb261-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr10</span></span>
<span id="cb261-25"><a href="archr-enrichment.html#cb261-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-26"><a href="archr-enrichment.html#cb261-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr11</span></span>
<span id="cb261-27"><a href="archr-enrichment.html#cb261-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-28"><a href="archr-enrichment.html#cb261-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr12</span></span>
<span id="cb261-29"><a href="archr-enrichment.html#cb261-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-30"><a href="archr-enrichment.html#cb261-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr13</span></span>
<span id="cb261-31"><a href="archr-enrichment.html#cb261-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-32"><a href="archr-enrichment.html#cb261-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr14</span></span>
<span id="cb261-33"><a href="archr-enrichment.html#cb261-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:47 :</span></span>
<span id="cb261-34"><a href="archr-enrichment.html#cb261-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr15</span></span>
<span id="cb261-35"><a href="archr-enrichment.html#cb261-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-36"><a href="archr-enrichment.html#cb261-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr16</span></span>
<span id="cb261-37"><a href="archr-enrichment.html#cb261-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-38"><a href="archr-enrichment.html#cb261-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr17</span></span>
<span id="cb261-39"><a href="archr-enrichment.html#cb261-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-40"><a href="archr-enrichment.html#cb261-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr18</span></span>
<span id="cb261-41"><a href="archr-enrichment.html#cb261-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-42"><a href="archr-enrichment.html#cb261-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr19</span></span>
<span id="cb261-43"><a href="archr-enrichment.html#cb261-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-44"><a href="archr-enrichment.html#cb261-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr20</span></span>
<span id="cb261-45"><a href="archr-enrichment.html#cb261-45" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-46"><a href="archr-enrichment.html#cb261-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr21</span></span>
<span id="cb261-47"><a href="archr-enrichment.html#cb261-47" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-48"><a href="archr-enrichment.html#cb261-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chr22</span></span>
<span id="cb261-49"><a href="archr-enrichment.html#cb261-49" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-50"><a href="archr-enrichment.html#cb261-50" aria-hidden="true" tabindex="-1"></a><span class="do">##  Annotating Chr: chrX</span></span>
<span id="cb261-51"><a href="archr-enrichment.html#cb261-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:48 :</span></span>
<span id="cb261-52"><a href="archr-enrichment.html#cb261-52" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:49 : All Regions Overlap at least 1 peak!, 0.066 mins elapsed.</span></span>
<span id="cb261-53"><a href="archr-enrichment.html#cb261-53" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-addArchRAnnotations-371b03bf780a8-Date-2022-12-23_Time-07-59-45.log</span></span></code></pre></div>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="archr-enrichment.html#cb262-1" aria-hidden="true" tabindex="-1"></a>enrichCodex <span class="ot">&lt;-</span> <span class="fu">peakAnnoEnrichment</span>(</span>
<span id="cb262-2"><a href="archr-enrichment.html#cb262-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">seMarker =</span> markerPeaks,</span>
<span id="cb262-3"><a href="archr-enrichment.html#cb262-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ArchRProj =</span> projHeme5,</span>
<span id="cb262-4"><a href="archr-enrichment.html#cb262-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">peakAnnotation =</span> <span class="st">&quot;Codex&quot;</span>,</span>
<span id="cb262-5"><a href="archr-enrichment.html#cb262-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cutOff =</span> <span class="st">&quot;FDR &lt;= 0.1 &amp; Log2FC &gt;= 0.5&quot;</span></span>
<span id="cb262-6"><a href="archr-enrichment.html#cb262-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb262-7"><a href="archr-enrichment.html#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-peakAnnoEnrichment-371b04237471d-Date-2022-12-23_Time-07-59-49.log</span></span>
<span id="cb262-8"><a href="archr-enrichment.html#cb262-8" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb262-9"><a href="archr-enrichment.html#cb262-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:54 : Computing Enrichments 1 of 11, 0.083 mins elapsed.</span></span>
<span id="cb262-10"><a href="archr-enrichment.html#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:54 : Computing Enrichments 2 of 11, 0.084 mins elapsed.</span></span>
<span id="cb262-11"><a href="archr-enrichment.html#cb262-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:54 : Computing Enrichments 3 of 11, 0.085 mins elapsed.</span></span>
<span id="cb262-12"><a href="archr-enrichment.html#cb262-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:54 : Computing Enrichments 4 of 11, 0.087 mins elapsed.</span></span>
<span id="cb262-13"><a href="archr-enrichment.html#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 5 of 11, 0.094 mins elapsed.</span></span>
<span id="cb262-14"><a href="archr-enrichment.html#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 6 of 11, 0.095 mins elapsed.</span></span>
<span id="cb262-15"><a href="archr-enrichment.html#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 7 of 11, 0.097 mins elapsed.</span></span>
<span id="cb262-16"><a href="archr-enrichment.html#cb262-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 8 of 11, 0.098 mins elapsed.</span></span>
<span id="cb262-17"><a href="archr-enrichment.html#cb262-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 9 of 11, 0.099 mins elapsed.</span></span>
<span id="cb262-18"><a href="archr-enrichment.html#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 10 of 11, 0.1 mins elapsed.</span></span>
<span id="cb262-19"><a href="archr-enrichment.html#cb262-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 07:59:55 : Computing Enrichments 11 of 11, 0.101 mins elapsed.</span></span>
<span id="cb262-20"><a href="archr-enrichment.html#cb262-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-peakAnnoEnrichment-371b04237471d-Date-2022-12-23_Time-07-59-49.log</span></span></code></pre></div>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="archr-enrichment.html#cb263-1" aria-hidden="true" tabindex="-1"></a>enrichCodex</span>
<span id="cb263-2"><a href="archr-enrichment.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="do">## class: SummarizedExperiment </span></span>
<span id="cb263-3"><a href="archr-enrichment.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="do">## dim: 189 11 </span></span>
<span id="cb263-4"><a href="archr-enrichment.html#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="do">## metadata(0):</span></span>
<span id="cb263-5"><a href="archr-enrichment.html#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="do">## assays(10): mlog10Padj mlog10p ... CompareFrequency feature</span></span>
<span id="cb263-6"><a href="archr-enrichment.html#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="do">## rownames(189): 1.STAT5-No_drug_(DMSO)... 2.RUNX3-GM12878_cell_fr... ...</span></span>
<span id="cb263-7"><a href="archr-enrichment.html#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   188.TP53-codex_Embryonic... 189.TP53-codex_Embryonic...</span></span>
<span id="cb263-8"><a href="archr-enrichment.html#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="do">## rowData names(0):</span></span>
<span id="cb263-9"><a href="archr-enrichment.html#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="do">## colnames(11): B CD4.M ... PreB Progenitor</span></span>
<span id="cb263-10"><a href="archr-enrichment.html#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="do">## colData names(0):</span></span></code></pre></div>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="archr-enrichment.html#cb264-1" aria-hidden="true" tabindex="-1"></a>heatmapCodex <span class="ot">&lt;-</span> <span class="fu">plotEnrichHeatmap</span>(enrichCodex, <span class="at">n =</span> <span class="dv">7</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb264-2"><a href="archr-enrichment.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotEnrichHeatmap-371b043a51484-Date-2022-12-23_Time-07-59-56.log</span></span>
<span id="cb264-3"><a href="archr-enrichment.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb264-4"><a href="archr-enrichment.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Annotations..</span></span>
<span id="cb264-5"><a href="archr-enrichment.html#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb264-6"><a href="archr-enrichment.html#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb264-7"><a href="archr-enrichment.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb264-8"><a href="archr-enrichment.html#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="archr-enrichment.html#cb265-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(heatmapCodex, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;bot&quot;</span>, <span class="at">annotation_legend_side =</span> <span class="st">&quot;bot&quot;</span>)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-268-1.svg" width="672" /></p>
<p>We can then plot this</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="archr-enrichment.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPDF</span>(heatmapCodex, <span class="at">name =</span> <span class="st">&quot;Codex-Enriched-Marker-Heatmap&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">ArchRProj =</span> projHeme5, <span class="at">addDOC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-2"><a href="archr-enrichment.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="motif-enrichment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="custom-enrichment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": null
},
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
},
"info": false
});
});
</script>

</body>

</html>
