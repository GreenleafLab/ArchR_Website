<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18.2 Lymphoid Trajectory - B Cell Cifferentiation | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</title>
  <meta name="description" content="A guide to ArchR" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="18.2 Lymphoid Trajectory - B Cell Cifferentiation | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A guide to ArchR" />
  <meta name="github-repo" content="GreenleafLab/ArchR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18.2 Lymphoid Trajectory - B Cell Cifferentiation | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  
  <meta name="twitter:description" content="A guide to ArchR" />
  

<meta name="author" content="Jeffrey Granja and Ryan Corces" />


<meta name="date" content="2022-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="myeloid-trajectory---monocyte-differentiation.html"/>
<link rel="next" href="monocle3-trajectories.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../index.html">Back to ArchR Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><img src="images/ArchR_Logo_Integrated.png" alt="" width="200"></a></li>
<li class="chapter" data-level="1" data-path="debugging-and-troubleshooting-in-archr.html"><a href="debugging-and-troubleshooting-in-archr.html"><i class="fa fa-check"></i><b>1</b> Debugging and Troubleshooting in ArchR</a></li>
<li class="chapter" data-level="2" data-path="manage-archrs-dependencies.html"><a href="manage-archrs-dependencies.html"><i class="fa fa-check"></i><b>2</b> Manage ArchR’s Dependencies</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-renv-to-manage-dependencies.html"><a href="using-renv-to-manage-dependencies.html"><i class="fa fa-check"></i><b>2.1</b> Using renv to manage dependencies</a></li>
<li class="chapter" data-level="2.2" data-path="other-environment-managers.html"><a href="other-environment-managers.html"><i class="fa fa-check"></i><b>2.2</b> Other environment managers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-archr.html"><a href="getting-started-with-archr.html"><i class="fa fa-check"></i><b>3</b> Getting Started with ArchR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="a-brief-primer-on-atac-seq-terminology.html"><a href="a-brief-primer-on-atac-seq-terminology.html"><i class="fa fa-check"></i><b>3.1</b> A Brief Primer on ATAC-seq Terminology</a></li>
<li class="chapter" data-level="3.2" data-path="why-use-archr.html"><a href="why-use-archr.html"><i class="fa fa-check"></i><b>3.2</b> Why use ArchR?</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-an-arrow-file-archrproject.html"><a href="what-is-an-arrow-file-archrproject.html"><i class="fa fa-check"></i><b>3.3</b> What is an Arrow file / <code>ArchRProject</code>?</a></li>
<li class="chapter" data-level="3.4" data-path="input-file-types-in-archr.html"><a href="input-file-types-in-archr.html"><i class="fa fa-check"></i><b>3.4</b> Input File Types in ArchR</a></li>
<li class="chapter" data-level="3.5" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>3.5</b> Getting Set Up</a></li>
<li class="chapter" data-level="3.6" data-path="creating-arrow-files.html"><a href="creating-arrow-files.html"><i class="fa fa-check"></i><b>3.6</b> Creating Arrow Files</a></li>
<li class="chapter" data-level="3.7" data-path="per-cell-quality-control.html"><a href="per-cell-quality-control.html"><i class="fa fa-check"></i><b>3.7</b> Per-cell Quality Control</a></li>
<li class="chapter" data-level="3.8" data-path="using-bam-files-for-arrow-file-creation.html"><a href="using-bam-files-for-arrow-file-creation.html"><i class="fa fa-check"></i><b>3.8</b> Using BAM files for Arrow File creation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doublet-inference-with-archr.html"><a href="doublet-inference-with-archr.html"><i class="fa fa-check"></i><b>4</b> Doublet Inference with ArchR</a>
<ul>
<li class="chapter" data-level="4.1" data-path="how-does-doublet-identification-work-in-archr.html"><a href="how-does-doublet-identification-work-in-archr.html"><i class="fa fa-check"></i><b>4.1</b> How does doublet identification work in ArchR?</a></li>
<li class="chapter" data-level="4.2" data-path="inferring-scatac-seq-doublets-with-archr.html"><a href="inferring-scatac-seq-doublets-with-archr.html"><i class="fa fa-check"></i><b>4.2</b> Inferring scATAC-seq Doublets with ArchR</a></li>
<li class="chapter" data-level="4.3" data-path="using-demuxlet-with-archr.html"><a href="using-demuxlet-with-archr.html"><i class="fa fa-check"></i><b>4.3</b> Using <em>demuxlet</em> with ArchR</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-an-archrproject.html"><a href="creating-an-archrproject.html"><i class="fa fa-check"></i><b>5</b> Creating an ArchRProject</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-an-archrproject-1.html"><a href="creating-an-archrproject-1.html"><i class="fa fa-check"></i><b>5.1</b> Creating An ArchRProject</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-an-archrproject.html"><a href="manipulating-an-archrproject.html"><i class="fa fa-check"></i><b>5.2</b> Manipulating An ArchRProject</a></li>
<li class="chapter" data-level="5.3" data-path="plotting-sample-statistics-from-an-archrproject.html"><a href="plotting-sample-statistics-from-an-archrproject.html"><i class="fa fa-check"></i><b>5.3</b> Plotting Sample Statistics from an ArchRProject</a></li>
<li class="chapter" data-level="5.4" data-path="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles..html"><a href="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles..html"><i class="fa fa-check"></i><b>5.4</b> Plotting Sample Fragment Size Distribution and TSS Enrichment Profiles.</a></li>
<li class="chapter" data-level="5.5" data-path="saving-and-loading-an-archrproject.html"><a href="saving-and-loading-an-archrproject.html"><i class="fa fa-check"></i><b>5.5</b> Saving and Loading an <code>ArchRProject</code></a></li>
<li class="chapter" data-level="5.6" data-path="filtering-doublets-from-an-archrproject.html"><a href="filtering-doublets-from-an-archrproject.html"><i class="fa fa-check"></i><b>5.6</b> Filtering Doublets from an ArchRProject</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dimensionality-reduction-with-archr.html"><a href="dimensionality-reduction-with-archr.html"><i class="fa fa-check"></i><b>6</b> Dimensionality Reduction with ArchR</a>
<ul>
<li class="chapter" data-level="6.1" data-path="archrs-lsi-implementation.html"><a href="archrs-lsi-implementation.html"><i class="fa fa-check"></i><b>6.1</b> ArchR’s LSI Implementation</a></li>
<li class="chapter" data-level="6.2" data-path="iterative-latent-semantic-indexing-lsi.html"><a href="iterative-latent-semantic-indexing-lsi.html"><i class="fa fa-check"></i><b>6.2</b> Iterative Latent Semantic Indexing (LSI)</a></li>
<li class="chapter" data-level="6.3" data-path="estimated-lsi.html"><a href="estimated-lsi.html"><i class="fa fa-check"></i><b>6.3</b> Estimated LSI</a></li>
<li class="chapter" data-level="6.4" data-path="batch-effect-correction-wtih-harmony.html"><a href="batch-effect-correction-wtih-harmony.html"><i class="fa fa-check"></i><b>6.4</b> Batch Effect Correction wtih Harmony</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering-with-archr.html"><a href="clustering-with-archr.html"><i class="fa fa-check"></i><b>7</b> Clustering with ArchR</a>
<ul>
<li class="chapter" data-level="7.1" data-path="clustering-using-seurats-findclusters-function.html"><a href="clustering-using-seurats-findclusters-function.html"><i class="fa fa-check"></i><b>7.1</b> Clustering using Seurat’s <code>FindClusters()</code> function</a></li>
<li class="chapter" data-level="7.2" data-path="clustering-using-scran.html"><a href="clustering-using-scran.html"><i class="fa fa-check"></i><b>7.2</b> Clustering using <code>scran</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="single-cell-embeddings.html"><a href="single-cell-embeddings.html"><i class="fa fa-check"></i><b>8</b> Single-cell Embeddings</a>
<ul>
<li class="chapter" data-level="8.1" data-path="uniform-manifold-approximation-and-projection-umap.html"><a href="uniform-manifold-approximation-and-projection-umap.html"><i class="fa fa-check"></i><b>8.1</b> Uniform Manifold Approximation and Projection (UMAP)</a></li>
<li class="chapter" data-level="8.2" data-path="t-stocastic-neighbor-embedding-t-sne.html"><a href="t-stocastic-neighbor-embedding-t-sne.html"><i class="fa fa-check"></i><b>8.2</b> t-Stocastic Neighbor Embedding (t-SNE)</a></li>
<li class="chapter" data-level="8.3" data-path="dimensionality-reduction-after-harmony.html"><a href="dimensionality-reduction-after-harmony.html"><i class="fa fa-check"></i><b>8.3</b> Dimensionality Reduction After Harmony</a></li>
<li class="chapter" data-level="8.4" data-path="highlighting-specific-cells-on-an-embedding.html"><a href="highlighting-specific-cells-on-an-embedding.html"><i class="fa fa-check"></i><b>8.4</b> Highlighting specific cells on an embedding</a></li>
<li class="chapter" data-level="8.5" data-path="importing-an-embedding-from-external-software.html"><a href="importing-an-embedding-from-external-software.html"><i class="fa fa-check"></i><b>8.5</b> Importing an embedding from external software</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gene-scores-and-marker-genes-with-archr.html"><a href="gene-scores-and-marker-genes-with-archr.html"><i class="fa fa-check"></i><b>9</b> Gene Scores and Marker Genes with ArchR</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calculating-gene-scores-in-archr.html"><a href="calculating-gene-scores-in-archr.html"><i class="fa fa-check"></i><b>9.1</b> Calculating Gene Scores in ArchR</a></li>
<li class="chapter" data-level="9.2" data-path="identification-of-marker-features.html"><a href="identification-of-marker-features.html"><i class="fa fa-check"></i><b>9.2</b> Identification of Marker Features</a></li>
<li class="chapter" data-level="9.3" data-path="identifying-marker-genes.html"><a href="identifying-marker-genes.html"><i class="fa fa-check"></i><b>9.3</b> Identifying Marker Genes</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-marker-genes-on-an-embedding.html"><a href="visualizing-marker-genes-on-an-embedding.html"><i class="fa fa-check"></i><b>9.4</b> Visualizing Marker Genes on an Embedding</a></li>
<li class="chapter" data-level="9.5" data-path="marker-genes-imputation-with-magic.html"><a href="marker-genes-imputation-with-magic.html"><i class="fa fa-check"></i><b>9.5</b> Marker Genes Imputation with MAGIC</a></li>
<li class="chapter" data-level="9.6" data-path="module-scores.html"><a href="module-scores.html"><i class="fa fa-check"></i><b>9.6</b> Module Scores</a></li>
<li class="chapter" data-level="9.7" data-path="track-plotting-with-archrbrowser.html"><a href="track-plotting-with-archrbrowser.html"><i class="fa fa-check"></i><b>9.7</b> Track Plotting with ArchRBrowser</a></li>
<li class="chapter" data-level="9.8" data-path="launching-the-interactive-archrbrowser.html"><a href="launching-the-interactive-archrbrowser.html"><i class="fa fa-check"></i><b>9.8</b> Launching the Interactive ArchRBrowser</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="defining-cluster-identity-with-scrna-seq.html"><a href="defining-cluster-identity-with-scrna-seq.html"><i class="fa fa-check"></i><b>10</b> Defining Cluster Identity with scRNA-seq</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cross-platform-linkage-of-scatac-seq-cells-with-scrna-seq-cells.html"><a href="cross-platform-linkage-of-scatac-seq-cells-with-scrna-seq-cells.html"><i class="fa fa-check"></i><b>10.1</b> Cross-platform linkage of scATAC-seq cells with scRNA-seq cells</a></li>
<li class="chapter" data-level="10.2" data-path="adding-pseudo-scrna-seq-profiles-for-each-scatac-seq-cell.html"><a href="adding-pseudo-scrna-seq-profiles-for-each-scatac-seq-cell.html"><i class="fa fa-check"></i><b>10.2</b> Adding Pseudo-scRNA-seq profiles for each scATAC-seq cell</a></li>
<li class="chapter" data-level="10.3" data-path="labeling-scatac-seq-clusters-with-scrna-seq-information.html"><a href="labeling-scatac-seq-clusters-with-scrna-seq-information.html"><i class="fa fa-check"></i><b>10.3</b> Labeling scATAC-seq clusters with scRNA-seq information</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pseudo-bulk-replicates-in-archr.html"><a href="pseudo-bulk-replicates-in-archr.html"><i class="fa fa-check"></i><b>11</b> Pseudo-bulk Replicates in ArchR</a>
<ul>
<li class="chapter" data-level="11.1" data-path="how-does-archr-make-pseudo-bulk-replicates.html"><a href="how-does-archr-make-pseudo-bulk-replicates.html"><i class="fa fa-check"></i><b>11.1</b> How Does ArchR Make Pseudo-bulk Replicates?</a></li>
<li class="chapter" data-level="11.2" data-path="making-pseudo-bulk-replicates.html"><a href="making-pseudo-bulk-replicates.html"><i class="fa fa-check"></i><b>11.2</b> Making Pseudo-bulk Replicates</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="calling-peaks-with-archr.html"><a href="calling-peaks-with-archr.html"><i class="fa fa-check"></i><b>12</b> Calling Peaks with ArchR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-iterative-overlap-peak-merging-procedure.html"><a href="the-iterative-overlap-peak-merging-procedure.html"><i class="fa fa-check"></i><b>12.1</b> The Iterative Overlap Peak Merging Procedure</a></li>
<li class="chapter" data-level="12.2" data-path="calling-peaks-w-macs2.html"><a href="calling-peaks-w-macs2.html"><i class="fa fa-check"></i><b>12.2</b> Calling Peaks w/ Macs2</a></li>
<li class="chapter" data-level="12.3" data-path="calling-peaks-w-tilematrix.html"><a href="calling-peaks-w-tilematrix.html"><i class="fa fa-check"></i><b>12.3</b> Calling Peaks w/ TileMatrix</a></li>
<li class="chapter" data-level="12.4" data-path="adding-a-peak-matrix.html"><a href="adding-a-peak-matrix.html"><i class="fa fa-check"></i><b>12.4</b> Adding a Peak Matrix</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="identifying-marker-peaks.html"><a href="identifying-marker-peaks.html"><i class="fa fa-check"></i><b>13</b> Identifying Marker Peaks</a>
<ul>
<li class="chapter" data-level="13.1" data-path="identifying-marker-peaks-with-archr.html"><a href="identifying-marker-peaks-with-archr.html"><i class="fa fa-check"></i><b>13.1</b> Identifying Marker Peaks with ArchR</a></li>
<li class="chapter" data-level="13.2" data-path="plotting-marker-peaks-in-archr.html"><a href="plotting-marker-peaks-in-archr.html"><i class="fa fa-check"></i><b>13.2</b> Plotting Marker Peaks in ArchR</a></li>
<li class="chapter" data-level="13.3" data-path="pairwise-testing-between-groups.html"><a href="pairwise-testing-between-groups.html"><i class="fa fa-check"></i><b>13.3</b> Pairwise Testing Between Groups</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="motif-and-feature-enrichment-with-archr.html"><a href="motif-and-feature-enrichment-with-archr.html"><i class="fa fa-check"></i><b>14</b> Motif and Feature Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="14.1" data-path="motif-enrichment.html"><a href="motif-enrichment.html"><i class="fa fa-check"></i><b>14.1</b> Motif Enrichment</a></li>
<li class="chapter" data-level="14.2" data-path="archr-enrichment.html"><a href="archr-enrichment.html"><i class="fa fa-check"></i><b>14.2</b> ArchR Enrichment</a></li>
<li class="chapter" data-level="14.3" data-path="custom-enrichment.html"><a href="custom-enrichment.html"><i class="fa fa-check"></i><b>14.3</b> Custom Enrichment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chromvar-deviatons-enrichment-with-archr.html"><a href="chromvar-deviatons-enrichment-with-archr.html"><i class="fa fa-check"></i><b>15</b> ChromVAR Deviatons Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="15.1" data-path="motif-deviations.html"><a href="motif-deviations.html"><i class="fa fa-check"></i><b>15.1</b> Motif Deviations</a></li>
<li class="chapter" data-level="15.2" data-path="archr-and-custom-deviations.html"><a href="archr-and-custom-deviations.html"><i class="fa fa-check"></i><b>15.2</b> ArchR and Custom Deviations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="footprinting-with-archr.html"><a href="footprinting-with-archr.html"><i class="fa fa-check"></i><b>16</b> Footprinting with ArchR</a>
<ul>
<li class="chapter" data-level="16.1" data-path="motif-footprinting.html"><a href="motif-footprinting.html"><i class="fa fa-check"></i><b>16.1</b> Motif Footprinting</a></li>
<li class="chapter" data-level="16.2" data-path="normalization-of-footprints-for-tn5-bias.html"><a href="normalization-of-footprints-for-tn5-bias.html"><i class="fa fa-check"></i><b>16.2</b> Normalization of Footprints for Tn5 Bias</a></li>
<li class="chapter" data-level="16.3" data-path="feature-footprinting.html"><a href="feature-footprinting.html"><i class="fa fa-check"></i><b>16.3</b> Feature Footprinting</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="integrative-analysis-with-archr.html"><a href="integrative-analysis-with-archr.html"><i class="fa fa-check"></i><b>17</b> Integrative Analysis with ArchR</a>
<ul>
<li class="chapter" data-level="17.1" data-path="creating-low-overlapping-aggregates-of-cells.html"><a href="creating-low-overlapping-aggregates-of-cells.html"><i class="fa fa-check"></i><b>17.1</b> Creating Low-Overlapping Aggregates of Cells</a></li>
<li class="chapter" data-level="17.2" data-path="co-accessibility-with-archr.html"><a href="co-accessibility-with-archr.html"><i class="fa fa-check"></i><b>17.2</b> Co-accessibility with ArchR</a></li>
<li class="chapter" data-level="17.3" data-path="peak2genelinkage-with-archr.html"><a href="peak2genelinkage-with-archr.html"><i class="fa fa-check"></i><b>17.3</b> Peak2GeneLinkage with ArchR</a></li>
<li class="chapter" data-level="17.4" data-path="identification-of-positive-tf-regulators.html"><a href="identification-of-positive-tf-regulators.html"><i class="fa fa-check"></i><b>17.4</b> Identification of Positive TF-Regulators</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="trajectory-analysis-with-archr.html"><a href="trajectory-analysis-with-archr.html"><i class="fa fa-check"></i><b>18</b> Trajectory Analysis with ArchR</a>
<ul>
<li class="chapter" data-level="18.1" data-path="myeloid-trajectory---monocyte-differentiation.html"><a href="myeloid-trajectory---monocyte-differentiation.html"><i class="fa fa-check"></i><b>18.1</b> Myeloid Trajectory - Monocyte Differentiation</a></li>
<li class="chapter" data-level="18.2" data-path="lymphoid-trajectory---b-cell-cifferentiation.html"><a href="lymphoid-trajectory---b-cell-cifferentiation.html"><i class="fa fa-check"></i><b>18.2</b> Lymphoid Trajectory - B Cell Cifferentiation</a></li>
<li class="chapter" data-level="18.3" data-path="monocle3-trajectories.html"><a href="monocle3-trajectories.html"><i class="fa fa-check"></i><b>18.3</b> Monocle3 Trajectories</a></li>
<li class="chapter" data-level="18.4" data-path="slingshot-trajectories.html"><a href="slingshot-trajectories.html"><i class="fa fa-check"></i><b>18.4</b> Slingshot Trajectories</a></li>
<li class="chapter" data-level="18.5" data-path="comparing-the-different-trajectories.html"><a href="comparing-the-different-trajectories.html"><i class="fa fa-check"></i><b>18.5</b> Comparing the different trajectories</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="handling-archr-output.html"><a href="handling-archr-output.html"><i class="fa fa-check"></i><b>19</b> Handling ArchR Output</a>
<ul>
<li class="chapter" data-level="19.1" data-path="exporting-fragment-level-data.html"><a href="exporting-fragment-level-data.html"><i class="fa fa-check"></i><b>19.1</b> Exporting fragment-level data</a></li>
<li class="chapter" data-level="19.2" data-path="exporting-matrix-level-data.html"><a href="exporting-matrix-level-data.html"><i class="fa fa-check"></i><b>19.2</b> Exporting matrix-level data</a></li>
<li class="chapter" data-level="19.3" data-path="exporting-pseudo-bulked-data-to-a-summarizedexperiment.html"><a href="exporting-pseudo-bulked-data-to-a-summarizedexperiment.html"><i class="fa fa-check"></i><b>19.3</b> Exporting pseudo-bulked data to a <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="19.4" data-path="exporting-pseudo-bulked-data-to-a-bigwig-file.html"><a href="exporting-pseudo-bulked-data-to-a-bigwig-file.html"><i class="fa fa-check"></i><b>19.4</b> Exporting pseudo-bulked data to a bigWig file</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="integration-with-bulk-atac-seq.html"><a href="integration-with-bulk-atac-seq.html"><i class="fa fa-check"></i><b>20</b> Integration with bulk ATAC-seq</a>
<ul>
<li class="chapter" data-level="20.1" data-path="projecting-bulk-atac-seq-data.html"><a href="projecting-bulk-atac-seq-data.html"><i class="fa fa-check"></i><b>20.1</b> Projecting bulk ATAC-seq data</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="multiomic-data-analysis-in-archr.html"><a href="multiomic-data-analysis-in-archr.html"><i class="fa fa-check"></i><b>21</b> Multiomic data analysis in ArchR</a>
<ul>
<li class="chapter" data-level="21.1" data-path="importing-data-and-setting-up-a-multiome-project.html"><a href="importing-data-and-setting-up-a-multiome-project.html"><i class="fa fa-check"></i><b>21.1</b> Importing data and setting up a Multiome project</a></li>
<li class="chapter" data-level="21.2" data-path="analysis-of-multiome-data-in-archr.html"><a href="analysis-of-multiome-data-in-archr.html"><i class="fa fa-check"></i><b>21.2</b> Analysis of multiome data in ArchR</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="plot-aesthetics-in-archr.html"><a href="plot-aesthetics-in-archr.html"><i class="fa fa-check"></i><b>22</b> Plot aesthetics in ArchR</a>
<ul>
<li class="chapter" data-level="22.1" data-path="using-and-manipulating-palettes-in-archr.html"><a href="using-and-manipulating-palettes-in-archr.html"><i class="fa fa-check"></i><b>22.1</b> Using and manipulating palettes in ArchR</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="testing-your-archr-installation.html"><a href="testing-your-archr-installation.html"><i class="fa fa-check"></i><b>23</b> Testing Your ArchR Installation</a></li>
<li class="chapter" data-level="24" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>24</b> Session Information</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lymphoid-trajectory---b-cell-cifferentiation" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Lymphoid Trajectory - B Cell Cifferentiation<a href="lymphoid-trajectory---b-cell-cifferentiation.html#lymphoid-trajectory---b-cell-cifferentiation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As a second example of a trajectory, we will create a B cell trajectory from progenitor cells, through the common lymphoid progenitor and pre-B cell all the way to fully differentiated B cells. Because this analysis is essentially repeated from the monocyte trajectory in the previous section, we do not provide explanations for the code snippets. If you are trying to learn how to perform trajectory analysis, check out the monocyte trajectory section in this chapter instead.</p>
<p>For reference, this is what our clusters look like:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotEmbedding</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">colorBy =</span> <span class="st">&quot;cellColData&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Clusters&quot;</span>, <span class="at">embedding =</span> <span class="st">&quot;UMAP&quot;</span>)</span>
<span id="cb393-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotEmbedding-371b05719caeb-Date-2022-12-23_Time-09-05-07.log</span></span>
<span id="cb393-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb393-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting UMAP Embedding</span></span>
<span id="cb393-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ColorBy = cellColData</span></span>
<span id="cb393-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting Embedding</span></span>
<span id="cb393-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 </span></span>
<span id="cb393-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotEmbedding-371b05719caeb-Date-2022-12-23_Time-09-05-07.log</span></span>
<span id="cb393-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plotEmbedding</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">colorBy =</span> <span class="st">&quot;cellColData&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Clusters2&quot;</span>, <span class="at">embedding =</span> <span class="st">&quot;UMAP&quot;</span>)</span>
<span id="cb393-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotEmbedding-371b077f587d0-Date-2022-12-23_Time-09-05-10.log</span></span>
<span id="cb393-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-11" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb393-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting UMAP Embedding</span></span>
<span id="cb393-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ColorBy = cellColData</span></span>
<span id="cb393-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting Embedding</span></span>
<span id="cb393-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 </span></span>
<span id="cb393-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotEmbedding-371b077f587d0-Date-2022-12-23_Time-09-05-10.log</span></span>
<span id="cb393-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb393-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAlignPlots</span>(p1, p2, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-392-1.svg" width="672" /></p>
<div id="pseudo-time-umaps-and-individual-feature-plots-1" class="section level3 hasAnchor" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> Pseudo-time UMAPs and individual feature plots<a href="lymphoid-trajectory---b-cell-cifferentiation.html#pseudo-time-umaps-and-individual-feature-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The trajectory we will use will span from “Progenitor” to a lymphoid progenitor cell (“CLP”) to a “PreB” cell, and finally to a mature “B” cell.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb394-1" aria-hidden="true" tabindex="-1"></a>trajectory <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Progenitor&quot;</span>, <span class="st">&quot;CLP&quot;</span>, <span class="st">&quot;PreB&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb394-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb394-2" aria-hidden="true" tabindex="-1"></a>trajectory</span>
<span id="cb394-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Progenitor&quot; &quot;CLP&quot;        &quot;PreB&quot;       &quot;B&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-1" aria-hidden="true" tabindex="-1"></a>projHeme5 <span class="ot">&lt;-</span> <span class="fu">addTrajectory</span>(</span>
<span id="cb395-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ArchRProj =</span> projHeme5, </span>
<span id="cb395-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>, </span>
<span id="cb395-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupBy =</span> <span class="st">&quot;Clusters2&quot;</span>,</span>
<span id="cb395-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trajectory =</span> trajectory, </span>
<span id="cb395-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">embedding =</span> <span class="st">&quot;UMAP&quot;</span>, </span>
<span id="cb395-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="cn">TRUE</span></span>
<span id="cb395-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-addTrajectory-371b051ecf2bb-Date-2022-12-23_Time-09-05-15.log</span></span>
<span id="cb395-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-10" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb395-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Filtering outliers</span></span>
<span id="cb395-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Alignment Before Spline Fit</span></span>
<span id="cb395-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Spline Fit</span></span>
<span id="cb395-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-14" aria-hidden="true" tabindex="-1"></a><span class="do">## KNN to Spline</span></span>
<span id="cb395-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb395-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-addTrajectory-371b051ecf2bb-Date-2022-12-23_Time-09-05-15.log</span></span></code></pre></div>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(projHeme5<span class="sc">$</span>LymphoidU[<span class="sc">!</span><span class="fu">is.na</span>(projHeme5<span class="sc">$</span>LymphoidU)])</span>
<span id="cb396-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 79.5847751 80.1470588 79.7145329 81.0986159  0.9948097 82.5692042</span></span></code></pre></div>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plotTrajectory</span>(projHeme5, <span class="at">trajectory =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">colorBy =</span> <span class="st">&quot;cellColData&quot;</span>, <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>)</span>
<span id="cb397-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectory-371b03fb639ef-Date-2022-12-23_Time-09-05-16.log</span></span>
<span id="cb397-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb397-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb397-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting Trajectory</span></span>
<span id="cb397-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Inferred Arrow Trajectory to Plot</span></span>
<span id="cb397-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectory-371b03fb639ef-Date-2022-12-23_Time-09-05-16.log</span></span>
<span id="cb397-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-8" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]]</span>
<span id="cb397-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 7938 rows containing non-finite values (stat_summary_hex).</span></span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-396-1.svg" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotTrajectory</span>(projHeme5, <span class="at">trajectory =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">colorBy =</span> <span class="st">&quot;GeneScoreMatrix&quot;</span>, <span class="at">name =</span> <span class="st">&quot;PAX5&quot;</span>, <span class="at">continuousSet =</span> <span class="st">&quot;horizonExtra&quot;</span>)</span>
<span id="cb398-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting ImputeWeights</span></span>
<span id="cb398-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectory-371b04053155b-Date-2022-12-23_Time-09-05-23.log</span></span>
<span id="cb398-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb398-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting Matrix Values...</span></span>
<span id="cb398-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:05:26 :</span></span>
<span id="cb398-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb398-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Imputing Matrix</span></span>
<span id="cb398-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Using weights on disk</span></span>
<span id="cb398-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Using weights on disk</span></span>
<span id="cb398-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb398-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting Trajectory</span></span>
<span id="cb398-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Inferred Arrow Trajectory to Plot</span></span>
<span id="cb398-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectory-371b04053155b-Date-2022-12-23_Time-09-05-23.log</span></span>
<span id="cb398-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plotTrajectory</span>(projHeme5, <span class="at">trajectory =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">colorBy =</span> <span class="st">&quot;GeneIntegrationMatrix&quot;</span>, <span class="at">name =</span> <span class="st">&quot;PAX5&quot;</span>, <span class="at">continuousSet =</span> <span class="st">&quot;blueYellow&quot;</span>)</span>
<span id="cb398-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting ImputeWeights</span></span>
<span id="cb398-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectory-371b049350b0-Date-2022-12-23_Time-09-05-33.log</span></span>
<span id="cb398-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-18" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb398-19"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Getting Matrix Values...</span></span>
<span id="cb398-20"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:05:36 :</span></span>
<span id="cb398-21"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb398-22"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Imputing Matrix</span></span>
<span id="cb398-23"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Using weights on disk</span></span>
<span id="cb398-24"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Using weights on disk</span></span>
<span id="cb398-25"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb398-26"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting Trajectory</span></span>
<span id="cb398-27"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding Inferred Arrow Trajectory to Plot</span></span>
<span id="cb398-28"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-28" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectory-371b049350b0-Date-2022-12-23_Time-09-05-33.log</span></span>
<span id="cb398-29"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAlignPlots</span>(p1[[<span class="dv">1</span>]], p2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb398-30"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 7938 rows containing non-finite values (stat_summary_hex).</span></span>
<span id="cb398-31"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb398-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Removed 7938 rows containing non-finite values (stat_summary_hex).</span></span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-397-1.svg" width="672" /></p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAlignPlots</span>(p1[[<span class="dv">2</span>]], p2[[<span class="dv">2</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb399-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</span></span>
<span id="cb399-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</span></span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-398-1.svg" width="672" /></p>
</div>
<div id="pseudo-time-heatmaps-1" class="section level3 hasAnchor" number="18.2.2">
<h3><span class="header-section-number">18.2.2</span> Pseudo-time heatmaps<a href="lymphoid-trajectory---b-cell-cifferentiation.html#pseudo-time-heatmaps-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-1" aria-hidden="true" tabindex="-1"></a>trajMM  <span class="ot">&lt;-</span> <span class="fu">getTrajectory</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">useMatrix =</span> <span class="st">&quot;MotifMatrix&quot;</span>, <span class="at">log2Norm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb400-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Creating Trajectory Group Matrix..</span></span>
<span id="cb400-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Some values are below 0, this could be a DeviationsMatrix in which scaleTo should be set = NULL.</span></span>
<span id="cb400-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Continuing without depth normalization!</span></span>
<span id="cb400-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Smoothing...</span></span>
<span id="cb400-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajMM, <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;solarExtra&quot;</span>))</span>
<span id="cb400-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0320e7d0e-Date-2022-12-23_Time-09-06-01.log</span></span>
<span id="cb400-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-8" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb400-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-9" aria-hidden="true" tabindex="-1"></a><span class="do">## useSeqnames is NULL or greater than 1 with a Sparse.Assays.Matrix trajectory input.</span></span>
<span id="cb400-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:06:02 :</span></span>
<span id="cb400-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-11" aria-hidden="true" tabindex="-1"></a><span class="do">## force=FALSE thus continuing with subsetting useSeqnames = z</span></span>
<span id="cb400-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:06:02 :</span></span>
<span id="cb400-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb400-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-14" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb400-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb400-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb400-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0320e7d0e-Date-2022-12-23_Time-09-06-01.log</span></span>
<span id="cb400-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb400-18" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-399-1.svg" width="672" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-1" aria-hidden="true" tabindex="-1"></a>trajGSM <span class="ot">&lt;-</span> <span class="fu">getTrajectory</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">useMatrix =</span> <span class="st">&quot;GeneScoreMatrix&quot;</span>, <span class="at">log2Norm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb401-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Creating Trajectory Group Matrix..</span></span>
<span id="cb401-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Smoothing...</span></span>
<span id="cb401-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajGSM,  <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;horizonExtra&quot;</span>))</span>
<span id="cb401-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06797cb6e-Date-2022-12-23_Time-09-06-24.log</span></span>
<span id="cb401-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-6" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb401-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb401-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-8" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb401-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb401-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb401-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06797cb6e-Date-2022-12-23_Time-09-06-24.log</span></span>
<span id="cb401-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb401-12" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-400-1.svg" width="672" /></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-1" aria-hidden="true" tabindex="-1"></a>trajGIM <span class="ot">&lt;-</span> <span class="fu">getTrajectory</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">useMatrix =</span> <span class="st">&quot;GeneIntegrationMatrix&quot;</span>, <span class="at">log2Norm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb402-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Creating Trajectory Group Matrix..</span></span>
<span id="cb402-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Smoothing...</span></span>
<span id="cb402-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajGIM,  <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;blueYellow&quot;</span>))</span>
<span id="cb402-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0236251ec-Date-2022-12-23_Time-09-06-50.log</span></span>
<span id="cb402-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-6" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb402-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb402-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-8" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb402-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb402-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb402-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0236251ec-Date-2022-12-23_Time-09-06-50.log</span></span>
<span id="cb402-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb402-12" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-401-1.svg" width="672" /></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-1" aria-hidden="true" tabindex="-1"></a>trajPM  <span class="ot">&lt;-</span> <span class="fu">getTrajectory</span>(<span class="at">ArchRProj =</span> projHeme5, <span class="at">name =</span> <span class="st">&quot;LymphoidU&quot;</span>, <span class="at">useMatrix =</span> <span class="st">&quot;PeakMatrix&quot;</span>, <span class="at">log2Norm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb403-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Creating Trajectory Group Matrix..</span></span>
<span id="cb403-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Smoothing...</span></span>
<span id="cb403-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-4" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajPM, <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;solarExtra&quot;</span>))</span>
<span id="cb403-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b02d105e37-Date-2022-12-23_Time-09-07-21.log</span></span>
<span id="cb403-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-6" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb403-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb403-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-8" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb403-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb403-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb403-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b02d105e37-Date-2022-12-23_Time-09-07-21.log</span></span>
<span id="cb403-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb403-12" aria-hidden="true" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-402-1.svg" width="672" /></p>
<p>To save editable vectorized versions of these plots, we use <code>plotPDF()</code>.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPDF</span>(p1, p2, p3, p4, <span class="at">name =</span> <span class="st">&quot;Plot-LymphoidU-Traj-Heatmaps.pdf&quot;</span>, <span class="at">ArchRProj =</span> projHeme5, <span class="at">addDOC =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb404-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span>
<span id="cb404-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb404-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span>
<span id="cb404-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span>
<span id="cb404-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb404-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting ComplexHeatmap!</span></span></code></pre></div>
</div>
<div id="integrative-pseudo-time-analyses-1" class="section level3 hasAnchor" number="18.2.3">
<h3><span class="header-section-number">18.2.3</span> Integrative pseudo-time analyses<a href="lymphoid-trajectory---b-cell-cifferentiation.html#integrative-pseudo-time-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-1" aria-hidden="true" tabindex="-1"></a>corGSM_MM <span class="ot">&lt;-</span> <span class="fu">correlateTrajectories</span>(trajGSM, trajMM)</span>
<span id="cb405-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-correlateTrajectories-371b058cdd862-Date-2022-12-23_Time-09-07-41.log</span></span>
<span id="cb405-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb405-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Found 12 Correlated Pairings!</span></span>
<span id="cb405-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:07:57 :</span></span>
<span id="cb405-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-6" aria-hidden="true" tabindex="-1"></a>corGSM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>matchname1</span>
<span id="cb405-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;PRDM16&quot; &quot;NFE2&quot;   &quot;JDP2&quot;   &quot;IRF8&quot;   &quot;RFX2&quot;   &quot;CEBPA&quot;  &quot;SPIB&quot;   &quot;FOSL2&quot; </span></span>
<span id="cb405-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;BCL11A&quot; &quot;FOXP1&quot;  &quot;GATA2&quot;  &quot;PAX5&quot;</span></span>
<span id="cb405-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-9" aria-hidden="true" tabindex="-1"></a>corGSM_MM[[<span class="dv">1</span>]]</span>
<span id="cb405-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-10" aria-hidden="true" tabindex="-1"></a><span class="do">## DataFrame with 12 rows and 12 columns</span></span>
<span id="cb405-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-11" aria-hidden="true" tabindex="-1"></a><span class="do">##          idx1      idx2  matchname1  matchname2       name1        name2</span></span>
<span id="cb405-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     &lt;integer&gt; &lt;integer&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;  &lt;character&gt;</span></span>
<span id="cb405-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1          82      1081      PRDM16      PRDM16 chr1:PRDM16 z:PRDM16_211</span></span>
<span id="cb405-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        5181       989        NFE2        NFE2  chr12:NFE2   z:NFE2_119</span></span>
<span id="cb405-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        6721       995        JDP2        JDP2  chr14:JDP2   z:JDP2_125</span></span>
<span id="cb405-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 4        8690      1503        IRF8        IRF8  chr16:IRF8   z:IRF8_633</span></span>
<span id="cb405-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 5       10649      1594        RFX2        RFX2  chr19:RFX2   z:RFX2_724</span></span>
<span id="cb405-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ...       ...       ...         ...         ...         ...          ...</span></span>
<span id="cb405-19"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 8       12241       975       FOSL2       FOSL2  chr2:FOSL2  z:FOSL2_105</span></span>
<span id="cb405-20"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 9       12398      1064      BCL11A      BCL11A chr2:BCL11A z:BCL11A_194</span></span>
<span id="cb405-21"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 10      15543      1223       FOXP1       FOXP1  chr3:FOXP1  z:FOXP1_353</span></span>
<span id="cb405-22"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 11      15802      1258       GATA2       GATA2  chr3:GATA2  z:GATA2_388</span></span>
<span id="cb405-23"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 12      21499      1579        PAX5        PAX5   chr9:PAX5   z:PAX5_709</span></span>
<span id="cb405-24"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-24" aria-hidden="true" tabindex="-1"></a><span class="do">##     Correlation VarAssay1 VarAssay2     TStat        Pval         FDR</span></span>
<span id="cb405-25"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-25" aria-hidden="true" tabindex="-1"></a><span class="do">##       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span id="cb405-26"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 1      0.586257  0.999654  0.824713   7.16390 1.46991e-10 1.00077e-08</span></span>
<span id="cb405-27"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      0.729613  0.978769  0.993678  10.56181 7.33135e-18 2.39588e-15</span></span>
<span id="cb405-28"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      0.617038  0.801055  0.995402   7.76223 8.12895e-12 7.81335e-10</span></span>
<span id="cb405-29"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      0.500571  0.817918  0.985057   5.72419 1.13600e-07 3.63965e-06</span></span>
<span id="cb405-30"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      0.747818  0.973797  0.952299  11.15074 3.92976e-19 2.14041e-16</span></span>
<span id="cb405-31"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ...         ...       ...       ...       ...         ...         ...</span></span>
<span id="cb405-32"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 8      0.840591  0.997233  0.997701  15.36251 7.67224e-28 6.26822e-25</span></span>
<span id="cb405-33"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 9      0.549728  0.887534  0.982184   6.51472 3.15028e-09 1.66050e-07</span></span>
<span id="cb405-34"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 10     0.506953  0.925974  0.891954   5.82220 7.36013e-08 2.50551e-06</span></span>
<span id="cb405-35"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 11     0.505639  0.952350  0.994253   5.80192 8.05384e-08 2.63402e-06</span></span>
<span id="cb405-36"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb405-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 12     0.710837  0.977905  0.958621  10.00476 1.18179e-16 2.75864e-14</span></span></code></pre></div>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-1" aria-hidden="true" tabindex="-1"></a>trajGSM2 <span class="ot">&lt;-</span> trajGSM[corGSM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>name1, ]</span>
<span id="cb406-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-2" aria-hidden="true" tabindex="-1"></a>trajMM2 <span class="ot">&lt;-</span> trajMM[corGSM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>name2, ]</span>
<span id="cb406-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-4" aria-hidden="true" tabindex="-1"></a>trajCombined <span class="ot">&lt;-</span> trajGSM2</span>
<span id="cb406-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="fu">assay</span>(trajCombined, <span class="at">withDimnames=</span><span class="cn">FALSE</span>) <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">assay</span>(trajGSM2), <span class="dv">1</span>, scale)) <span class="sc">+</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">assay</span>(trajMM2), <span class="dv">1</span>, scale))</span>
<span id="cb406-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-7" aria-hidden="true" tabindex="-1"></a>combinedMat <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajCombined, <span class="at">returnMat =</span> <span class="cn">TRUE</span>, <span class="at">varCutOff =</span> <span class="dv">0</span>)</span>
<span id="cb406-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b032e173bd-Date-2022-12-23_Time-09-07-57.log</span></span>
<span id="cb406-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-9" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb406-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb406-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-11" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb406-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb406-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb406-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb406-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b032e173bd-Date-2022-12-23_Time-09-07-57.log</span></span></code></pre></div>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-1" aria-hidden="true" tabindex="-1"></a>rowOrder <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(combinedMat), <span class="fu">rownames</span>(trajGSM2))</span>
<span id="cb407-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-3" aria-hidden="true" tabindex="-1"></a>ht1 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajGSM2,  <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;horizonExtra&quot;</span>),  <span class="at">varCutOff =</span> <span class="dv">0</span>, <span class="at">rowOrder =</span> rowOrder)</span>
<span id="cb407-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0150283a7-Date-2022-12-23_Time-09-07-58.log</span></span>
<span id="cb407-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-5" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb407-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb407-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-7" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb407-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb407-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb407-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0150283a7-Date-2022-12-23_Time-09-07-58.log</span></span>
<span id="cb407-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-11" aria-hidden="true" tabindex="-1"></a>ht2 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajMM2,  <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;solarExtra&quot;</span>), <span class="at">varCutOff =</span> <span class="dv">0</span>, <span class="at">rowOrder =</span> rowOrder)</span>
<span id="cb407-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b029b0dc21-Date-2022-12-23_Time-09-07-59.log</span></span>
<span id="cb407-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-13" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb407-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-14" aria-hidden="true" tabindex="-1"></a><span class="do">## useSeqnames is NULL or greater than 1 with a Sparse.Assays.Matrix trajectory input.</span></span>
<span id="cb407-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:08:01 :</span></span>
<span id="cb407-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-16" aria-hidden="true" tabindex="-1"></a><span class="do">## force=FALSE thus continuing with subsetting useSeqnames = z</span></span>
<span id="cb407-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:08:01 :</span></span>
<span id="cb407-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb407-19"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-19" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb407-20"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb407-21"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb407-22"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b029b0dc21-Date-2022-12-23_Time-09-07-59.log</span></span>
<span id="cb407-23"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-24"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb407-24" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(ht1 <span class="sc">+</span> ht2)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-406-1.svg" width="672" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-1" aria-hidden="true" tabindex="-1"></a>corGIM_MM <span class="ot">&lt;-</span> <span class="fu">correlateTrajectories</span>(trajGIM, trajMM)</span>
<span id="cb408-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-correlateTrajectories-371b012a8df62-Date-2022-12-23_Time-09-08-02.log</span></span>
<span id="cb408-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb408-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Found 40 Correlated Pairings!</span></span>
<span id="cb408-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:08:15 :</span></span>
<span id="cb408-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-6" aria-hidden="true" tabindex="-1"></a>corGIM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>matchname1</span>
<span id="cb408-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;ID3&quot;     &quot;NFIA&quot;    &quot;POU2F1&quot;  &quot;NFKB2&quot;   &quot;IRF7&quot;    &quot;SPI1&quot;    &quot;ETS1&quot;   </span></span>
<span id="cb408-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] &quot;ARID2&quot;   &quot;NFE2&quot;    &quot;FOXO1&quot;   &quot;FOS&quot;     &quot;FOXN3&quot;   &quot;MEF2A&quot;   &quot;IRF8&quot;   </span></span>
<span id="cb408-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [15] &quot;MAFG&quot;    &quot;MBD2&quot;    &quot;TCF4&quot;    &quot;TCF3&quot;    &quot;NFIC&quot;    &quot;KLF2&quot;    &quot;CEBPA&quot;  </span></span>
<span id="cb408-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [22] &quot;POU2F2&quot;  &quot;FOSB&quot;    &quot;FOSL2&quot;   &quot;REL&quot;     &quot;NFE2L2&quot;  &quot;CEBPB&quot;   &quot;RUNX1&quot;  </span></span>
<span id="cb408-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [29] &quot;ATF4&quot;    &quot;SMARCC1&quot; &quot;FOXP1&quot;   &quot;GATA2&quot;   &quot;HLTF&quot;    &quot;LEF1&quot;    &quot;IRF2&quot;   </span></span>
<span id="cb408-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [36] &quot;MEF2C&quot;   &quot;EBF1&quot;    &quot;IRF4&quot;    &quot;HOXA6&quot;   &quot;PAX5&quot;</span></span>
<span id="cb408-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-13" aria-hidden="true" tabindex="-1"></a>corGIM_MM[[<span class="dv">1</span>]]</span>
<span id="cb408-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-14" aria-hidden="true" tabindex="-1"></a><span class="do">## DataFrame with 40 rows and 12 columns</span></span>
<span id="cb408-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-15" aria-hidden="true" tabindex="-1"></a><span class="do">##          idx1      idx2  matchname1  matchname2       name1        name2</span></span>
<span id="cb408-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     &lt;integer&gt; &lt;integer&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;  &lt;character&gt;</span></span>
<span id="cb408-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 1         275       908         ID3         ID3    chr1:ID3     z:ID3_38</span></span>
<span id="cb408-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2         680      1612        NFIA        NFIA   chr1:NFIA   z:NFIA_742</span></span>
<span id="cb408-19"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        1371      1484      POU2F1      POU2F1 chr1:POU2F1 z:POU2F1_614</span></span>
<span id="cb408-20"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 4        2428      1584       NFKB2       NFKB2 chr10:NFKB2  z:NFKB2_714</span></span>
<span id="cb408-21"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 5        2625      1505        IRF7        IRF7  chr11:IRF7   z:IRF7_635</span></span>
<span id="cb408-22"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ...       ...       ...         ...         ...         ...          ...</span></span>
<span id="cb408-23"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 36      14165      1510       MEF2C       MEF2C  chr5:MEF2C  z:MEF2C_640</span></span>
<span id="cb408-24"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 37      14558       937        EBF1        EBF1   chr5:EBF1    z:EBF1_67</span></span>
<span id="cb408-25"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 38      14707      1502        IRF4        IRF4   chr6:IRF4   z:IRF4_632</span></span>
<span id="cb408-26"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 39      15845      1287       HOXA6       HOXA6  chr7:HOXA6  z:HOXA6_417</span></span>
<span id="cb408-27"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 40      17354      1579        PAX5        PAX5   chr9:PAX5   z:PAX5_709</span></span>
<span id="cb408-28"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-28" aria-hidden="true" tabindex="-1"></a><span class="do">##     Correlation VarAssay1 VarAssay2     TStat        Pval         FDR</span></span>
<span id="cb408-29"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-29" aria-hidden="true" tabindex="-1"></a><span class="do">##       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span id="cb408-30"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 1      0.584751  0.831514  0.987931   7.13591 1.68058e-10 1.03032e-09</span></span>
<span id="cb408-31"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      0.898830  0.869846  0.959770  20.30121 6.97999e-37 5.03633e-35</span></span>
<span id="cb408-32"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      0.670212  0.867426  0.956897   8.93968 2.41625e-14 2.63539e-13</span></span>
<span id="cb408-33"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      0.898578  0.933337  0.940805  20.27159 7.83715e-37 5.25089e-35</span></span>
<span id="cb408-34"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      0.879676  0.914574  0.942529  18.31129 2.12281e-33 9.48189e-32</span></span>
<span id="cb408-35"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-35" aria-hidden="true" tabindex="-1"></a><span class="do">## ...         ...       ...       ...       ...         ...         ...</span></span>
<span id="cb408-36"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 36     0.580374  0.988441  0.932184   7.05521 2.47068e-10 1.48557e-09</span></span>
<span id="cb408-37"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 37     0.956860  0.985323  0.993103  32.60196 2.08605e-54 4.89178e-52</span></span>
<span id="cb408-38"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-38" aria-hidden="true" tabindex="-1"></a><span class="do">## 38     0.509985  0.985753  0.968966   5.86921 5.97005e-08 2.75857e-07</span></span>
<span id="cb408-39"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 39     0.712754  0.900651  0.818391  10.05954 8.98810e-17 1.20441e-15</span></span>
<span id="cb408-40"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb408-40" aria-hidden="true" tabindex="-1"></a><span class="do">## 40     0.673718  0.975324  0.958621   9.02512 1.57824e-14 1.78360e-13</span></span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-1" aria-hidden="true" tabindex="-1"></a>trajGIM2 <span class="ot">&lt;-</span> trajGIM[corGIM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>name1, ]</span>
<span id="cb409-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-2" aria-hidden="true" tabindex="-1"></a>trajMM2 <span class="ot">&lt;-</span> trajMM[corGIM_MM[[<span class="dv">1</span>]]<span class="sc">$</span>name2, ]</span>
<span id="cb409-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-4" aria-hidden="true" tabindex="-1"></a>trajCombined <span class="ot">&lt;-</span> trajGIM2</span>
<span id="cb409-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-5" aria-hidden="true" tabindex="-1"></a><span class="fu">assay</span>(trajCombined, <span class="at">withDimnames=</span><span class="cn">FALSE</span>) <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">assay</span>(trajGIM2), <span class="dv">1</span>, scale)) <span class="sc">+</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">assay</span>(trajMM2), <span class="dv">1</span>, scale))</span>
<span id="cb409-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-7" aria-hidden="true" tabindex="-1"></a>combinedMat <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajCombined, <span class="at">returnMat =</span> <span class="cn">TRUE</span>, <span class="at">varCutOff =</span> <span class="dv">0</span>)</span>
<span id="cb409-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06ad08cc8-Date-2022-12-23_Time-09-08-15.log</span></span>
<span id="cb409-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-9" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb409-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb409-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-11" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb409-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb409-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb409-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb409-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06ad08cc8-Date-2022-12-23_Time-09-08-15.log</span></span></code></pre></div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-1" aria-hidden="true" tabindex="-1"></a>rowOrder <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(combinedMat), <span class="fu">rownames</span>(trajGIM2))</span>
<span id="cb410-2"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-3"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-3" aria-hidden="true" tabindex="-1"></a>ht1 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajGIM2,  <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;blueYellow&quot;</span>),  <span class="at">varCutOff =</span> <span class="dv">0</span>, <span class="at">rowOrder =</span> rowOrder)</span>
<span id="cb410-4"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0333c1cd4-Date-2022-12-23_Time-09-08-16.log</span></span>
<span id="cb410-5"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb410-6"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb410-7"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb410-8"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb410-9"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb410-10"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b0333c1cd4-Date-2022-12-23_Time-09-08-16.log</span></span>
<span id="cb410-11"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-12"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-12" aria-hidden="true" tabindex="-1"></a>ht2 <span class="ot">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span>(trajMM2, <span class="at">pal =</span> <span class="fu">paletteContinuous</span>(<span class="at">set =</span> <span class="st">&quot;solarExtra&quot;</span>), <span class="at">varCutOff =</span> <span class="dv">0</span>, <span class="at">rowOrder =</span> rowOrder)</span>
<span id="cb410-13"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06339a482-Date-2022-12-23_Time-09-08-18.log</span></span>
<span id="cb410-14"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-14" aria-hidden="true" tabindex="-1"></a><span class="do">## If there is an issue, please report to github with logFile!</span></span>
<span id="cb410-15"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-15" aria-hidden="true" tabindex="-1"></a><span class="do">## useSeqnames is NULL or greater than 1 with a Sparse.Assays.Matrix trajectory input.</span></span>
<span id="cb410-16"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:08:19 :</span></span>
<span id="cb410-17"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-17" aria-hidden="true" tabindex="-1"></a><span class="do">## force=FALSE thus continuing with subsetting useSeqnames = z</span></span>
<span id="cb410-18"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022-12-23 09:08:19 :</span></span>
<span id="cb410-19"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Preparing Main Heatmap..</span></span>
<span id="cb410-20"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-20" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;magick&#39; package is suggested to install to give better rasterization.</span></span>
<span id="cb410-21"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb410-22"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Set `ht_opt$message = FALSE` to turn off this message.</span></span>
<span id="cb410-23"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ArchR logging successful to : ArchRLogs/ArchR-plotTrajectoryHeatmap-371b06339a482-Date-2022-12-23_Time-09-08-18.log</span></span>
<span id="cb410-24"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-25"><a href="lymphoid-trajectory---b-cell-cifferentiation.html#cb410-25" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">::</span><span class="fu">draw</span>(ht1 <span class="sc">+</span> ht2)</span></code></pre></div>
<p><img src="ArchR_files/figure-html/unnamed-chunk-409-1.svg" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="myeloid-trajectory---monocyte-differentiation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monocle3-trajectories.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": null
},
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
},
"info": false
});
});
</script>

</body>

</html>
