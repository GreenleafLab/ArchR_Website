<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Manipulating An ArchRProject | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</title>
  <meta name="description" content="A guide to ArchR" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Manipulating An ArchRProject | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide to ArchR" />
  <meta name="github-repo" content="GreenleafLab/ArchR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Manipulating An ArchRProject | ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data." />
  
  <meta name="twitter:description" content="A guide to ArchR" />
  

<meta name="author" content="Jeffrey Granja and Ryan Corces" />


<meta name="date" content="2020-02-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-an-archrproject-1.html"/>
<link rel="next" href="plotting-sample-statistics-from-an-archrproject.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../index.html">Back to ArchR Home</a></li>

<li class="divider"></li>
<li><a href="index.html#section"><img src="images/ArchR_Logo_Integrated.png" alt="" width="200"></a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-archr.html"><a href="getting-started-with-archr.html"><i class="fa fa-check"></i><b>1</b> Getting Started with ArchR</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-an-arrowfile-archrproject.html"><a href="what-is-an-arrowfile-archrproject.html"><i class="fa fa-check"></i><b>1.1</b> What is an <code>ArrowFile</code> / <code>ArchRProject</code>?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>1.2</b> Getting Set Up</a></li>
<li class="chapter" data-level="1.3" data-path="setting-a-genome-and-geneannotation.html"><a href="setting-a-genome-and-geneannotation.html"><i class="fa fa-check"></i><b>1.3</b> Setting a Genome and GeneAnnotation</a></li>
<li class="chapter" data-level="1.4" data-path="creating-arrow-files.html"><a href="creating-arrow-files.html"><i class="fa fa-check"></i><b>1.4</b> Creating Arrow Files</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="doublet-inference-with-archr.html"><a href="doublet-inference-with-archr.html"><i class="fa fa-check"></i><b>2</b> Doublet Inference with ArchR</a>
<ul>
<li class="chapter" data-level="2.1" data-path="inferring-scatac-seq-doublets-with-archr.html"><a href="inferring-scatac-seq-doublets-with-archr.html"><i class="fa fa-check"></i><b>2.1</b> Inferring scATAC-seq Doublets with ArchR</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-an-archrproject.html"><a href="creating-an-archrproject.html"><i class="fa fa-check"></i><b>3</b> Creating an ArchRProject</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-an-archrproject-1.html"><a href="creating-an-archrproject-1.html"><i class="fa fa-check"></i><b>3.1</b> Creating An ArchRProject</a></li>
<li class="chapter" data-level="3.2" data-path="manipulating-an-archrproject.html"><a href="manipulating-an-archrproject.html"><i class="fa fa-check"></i><b>3.2</b> Manipulating An ArchRProject</a></li>
<li class="chapter" data-level="3.3" data-path="plotting-sample-statistics-from-an-archrproject.html"><a href="plotting-sample-statistics-from-an-archrproject.html"><i class="fa fa-check"></i><b>3.3</b> Plotting Sample Statistics from an ArchRProject</a></li>
<li class="chapter" data-level="3.4" data-path="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles-.html"><a href="plotting-sample-fragment-size-distribution-and-tss-enrichment-profiles-.html"><i class="fa fa-check"></i><b>3.4</b> Plotting Sample Fragment Size Distribution and TSS Enrichment Profiles.</a></li>
<li class="chapter" data-level="3.5" data-path="filtering-doublets-from-an-archrproject.html"><a href="filtering-doublets-from-an-archrproject.html"><i class="fa fa-check"></i><b>3.5</b> Filtering Doublets from an ArchRProject</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dimensionality-reduction-with-archr.html"><a href="dimensionality-reduction-with-archr.html"><i class="fa fa-check"></i><b>4</b> Dimensionality Reduction with ArchR</a>
<ul>
<li class="chapter" data-level="4.1" data-path="archrs-lsi-implementation.html"><a href="archrs-lsi-implementation.html"><i class="fa fa-check"></i><b>4.1</b> ArchRâ€™s LSI Implementation</a></li>
<li class="chapter" data-level="4.2" data-path="iterative-latent-semantic-indexing-lsi.html"><a href="iterative-latent-semantic-indexing-lsi.html"><i class="fa fa-check"></i><b>4.2</b> Iterative Latent Semantic Indexing (LSI)</a></li>
<li class="chapter" data-level="4.3" data-path="batch-effect-correction-wtih-harmony.html"><a href="batch-effect-correction-wtih-harmony.html"><i class="fa fa-check"></i><b>4.3</b> Batch Effect Correction wtih Harmony</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clustering-with-archr.html"><a href="clustering-with-archr.html"><i class="fa fa-check"></i><b>5</b> Clustering with ArchR</a></li>
<li class="chapter" data-level="6" data-path="single-cell-embeddings.html"><a href="single-cell-embeddings.html"><i class="fa fa-check"></i><b>6</b> Single Cell Embeddings</a>
<ul>
<li class="chapter" data-level="6.1" data-path="umap.html"><a href="umap.html"><i class="fa fa-check"></i><b>6.1</b> UMAP</a></li>
<li class="chapter" data-level="6.2" data-path="tsne.html"><a href="tsne.html"><i class="fa fa-check"></i><b>6.2</b> tSNE</a></li>
<li class="chapter" data-level="6.3" data-path="umap-of-previous-reduced-dimensions.html"><a href="umap-of-previous-reduced-dimensions.html"><i class="fa fa-check"></i><b>6.3</b> UMAP of previous Reduced Dimensions</a></li>
<li class="chapter" data-level="6.4" data-path="tsne-of-previous-reduced-dimensions.html"><a href="tsne-of-previous-reduced-dimensions.html"><i class="fa fa-check"></i><b>6.4</b> tSNE of previous Reduced Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="marker-genes-with-scatac.html"><a href="marker-genes-with-scatac.html"><i class="fa fa-check"></i><b>7</b> Marker Genes with scATAC</a>
<ul>
<li class="chapter" data-level="7.1" data-path="identification-of-marker-genes.html"><a href="identification-of-marker-genes.html"><i class="fa fa-check"></i><b>7.1</b> Identification of Marker Genes</a></li>
<li class="chapter" data-level="7.2" data-path="marker-genes.html"><a href="marker-genes.html"><i class="fa fa-check"></i><b>7.2</b> Marker Genes</a></li>
<li class="chapter" data-level="7.3" data-path="marker-genes-imputation-with-magic.html"><a href="marker-genes-imputation-with-magic.html"><i class="fa fa-check"></i><b>7.3</b> Marker Genes Imputation with Magic</a></li>
<li class="chapter" data-level="7.4" data-path="track-plotting-with-archrbrowser.html"><a href="track-plotting-with-archrbrowser.html"><i class="fa fa-check"></i><b>7.4</b> Track Plotting with ArchRBrowser</a></li>
<li class="chapter" data-level="7.5" data-path="launching-the-archrbrowser.html"><a href="launching-the-archrbrowser.html"><i class="fa fa-check"></i><b>7.5</b> Launching the ArchRBrowser</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="labeling-clusters-with-scrna.html"><a href="labeling-clusters-with-scrna.html"><i class="fa fa-check"></i><b>8</b> Labeling Clusters with scRNA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="labeling-scatac-cells-with-scrna-clusters.html"><a href="labeling-scatac-cells-with-scrna-clusters.html"><i class="fa fa-check"></i><b>8.1</b> Labeling scATAC cells with scRNA clusters</a></li>
<li class="chapter" data-level="8.2" data-path="adding-pseudo-scrna-profiles-for-each-scatac-cell.html"><a href="adding-pseudo-scrna-profiles-for-each-scatac-cell.html"><i class="fa fa-check"></i><b>8.2</b> Adding Pseudo-scRNA profiles for each scATAC cell</a></li>
<li class="chapter" data-level="8.3" data-path="labeling-scatac-clusters-with-scrna.html"><a href="labeling-scatac-clusters-with-scrna.html"><i class="fa fa-check"></i><b>8.3</b> Labeling scATAC clusters with scRNA</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="calling-peaks-with-archr.html"><a href="calling-peaks-with-archr.html"><i class="fa fa-check"></i><b>9</b> Calling Peaks with ArchR</a>
<ul>
<li class="chapter" data-level="9.1" data-path="calling-peaks-w-macs2.html"><a href="calling-peaks-w-macs2.html"><i class="fa fa-check"></i><b>9.1</b> Calling Peaks w/ Macs2</a></li>
<li class="chapter" data-level="9.2" data-path="calling-peaks-w-tilematrix.html"><a href="calling-peaks-w-tilematrix.html"><i class="fa fa-check"></i><b>9.2</b> Calling Peaks w/ TileMatrix</a></li>
<li class="chapter" data-level="9.3" data-path="add-peak-matrix.html"><a href="add-peak-matrix.html"><i class="fa fa-check"></i><b>9.3</b> Add Peak Matrix</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="identifying-marker-peaks-with-archr.html"><a href="identifying-marker-peaks-with-archr.html"><i class="fa fa-check"></i><b>10</b> Identifying Marker Peaks with ArchR</a>
<ul>
<li class="chapter" data-level="10.1" data-path="identifying-marker-peaks-with-archr-1.html"><a href="identifying-marker-peaks-with-archr-1.html"><i class="fa fa-check"></i><b>10.1</b> Identifying Marker Peaks with ArchR</a></li>
<li class="chapter" data-level="10.2" data-path="pairwise-testing-groups.html"><a href="pairwise-testing-groups.html"><i class="fa fa-check"></i><b>10.2</b> Pairwise Testing Groups</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="peak-annotation-enrichment-with-archr.html"><a href="peak-annotation-enrichment-with-archr.html"><i class="fa fa-check"></i><b>11</b> Peak Annotation Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="11.1" data-path="motif-enrichment.html"><a href="motif-enrichment.html"><i class="fa fa-check"></i><b>11.1</b> Motif Enrichment</a></li>
<li class="chapter" data-level="11.2" data-path="archr-enrichment.html"><a href="archr-enrichment.html"><i class="fa fa-check"></i><b>11.2</b> ArchR Enrichment</a></li>
<li class="chapter" data-level="11.3" data-path="custom-enrichment.html"><a href="custom-enrichment.html"><i class="fa fa-check"></i><b>11.3</b> Custom Enrichment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chromvar-deviatons-enrichment-with-archr.html"><a href="chromvar-deviatons-enrichment-with-archr.html"><i class="fa fa-check"></i><b>12</b> ChromVAR Deviatons Enrichment with ArchR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="motif-deviations.html"><a href="motif-deviations.html"><i class="fa fa-check"></i><b>12.1</b> Motif Deviations</a></li>
<li class="chapter" data-level="12.2" data-path="archr-deviations.html"><a href="archr-deviations.html"><i class="fa fa-check"></i><b>12.2</b> ArchR Deviations</a></li>
<li class="chapter" data-level="12.3" data-path="custom-deviations.html"><a href="custom-deviations.html"><i class="fa fa-check"></i><b>12.3</b> Custom Deviations</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="footprinting-with-archr.html"><a href="footprinting-with-archr.html"><i class="fa fa-check"></i><b>13</b> Footprinting with ArchR</a>
<ul>
<li class="chapter" data-level="13.1" data-path="motif-footprinting.html"><a href="motif-footprinting.html"><i class="fa fa-check"></i><b>13.1</b> Motif Footprinting</a></li>
<li class="chapter" data-level="13.2" data-path="feature-footprinting.html"><a href="feature-footprinting.html"><i class="fa fa-check"></i><b>13.2</b> Feature Footprinting</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="trajectory-analysis-with-archr.html"><a href="trajectory-analysis-with-archr.html"><i class="fa fa-check"></i><b>14</b> Trajectory Analysis with ArchR</a>
<ul>
<li class="chapter" data-level="14.1" data-path="myeloid-trajectory.html"><a href="myeloid-trajectory.html"><i class="fa fa-check"></i><b>14.1</b> Myeloid Trajectory</a></li>
<li class="chapter" data-level="14.2" data-path="lymphoid-trajectory.html"><a href="lymphoid-trajectory.html"><i class="fa fa-check"></i><b>14.2</b> Lymphoid Trajectory</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="peak-linkage-with-archr.html"><a href="peak-linkage-with-archr.html"><i class="fa fa-check"></i><b>15</b> Peak Linkage with ArchR</a>
<ul>
<li class="chapter" data-level="15.1" data-path="coaccessibility-with-archr.html"><a href="coaccessibility-with-archr.html"><i class="fa fa-check"></i><b>15.1</b> CoAccessibility with ArchR</a></li>
<li class="chapter" data-level="15.2" data-path="peak2genelinkage-with-archr.html"><a href="peak2genelinkage-with-archr.html"><i class="fa fa-check"></i><b>15.2</b> Peak2GeneLinkage with ArchR</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ArchR: Robust and scaleable analysis of single-cell chromatin accessibility data.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulating-an-archrproject" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Manipulating An ArchRProject</h2>
<p>Now that we have created an <code>ArchRProject</code>, there are many things that we can do to easily access or manipulate the associated data.</p>
<p><span style="font-size:20px;font-weight:bold">Example 1. The <code>$</code> accessor allows direct access to <code>cellColData</code></span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="manipulating-an-archrproject.html#cb16-1"></a><span class="co">#A. Access cell names associated with each cell</span></span>
<span id="cb16-2"><a href="manipulating-an-archrproject.html#cb16-2"></a><span class="kw">head</span>(projHeme1<span class="op">$</span>cellNames)</span>
<span id="cb16-3"><a href="manipulating-an-archrproject.html#cb16-3"></a><span class="co"># [1] &quot;scATAC_BMMC_R1#TTATGTCAGTGATTAG-1&quot; &quot;scATAC_BMMC_R1#AAGATAGTCACCGCGA-1&quot;</span></span>
<span id="cb16-4"><a href="manipulating-an-archrproject.html#cb16-4"></a><span class="co"># [3] &quot;scATAC_BMMC_R1#GCATTGAAGATTCCGT-1&quot; &quot;scATAC_BMMC_R1#TATGTTCAGGGTTCCC-1&quot;</span></span>
<span id="cb16-5"><a href="manipulating-an-archrproject.html#cb16-5"></a><span class="co"># [5] &quot;scATAC_BMMC_R1#TCCATCGGTCCCGTGA-1&quot; &quot;scATAC_BMMC_R1#AGTTACGAGAACGTCG-1&quot;</span></span>
<span id="cb16-6"><a href="manipulating-an-archrproject.html#cb16-6"></a></span>
<span id="cb16-7"><a href="manipulating-an-archrproject.html#cb16-7"></a><span class="co">#B. Access sample names associated with each cell</span></span>
<span id="cb16-8"><a href="manipulating-an-archrproject.html#cb16-8"></a>projHeme1<span class="op">$</span>Sample</span>
<span id="cb16-9"><a href="manipulating-an-archrproject.html#cb16-9"></a><span class="co"># character-Rle of length 10661 with 3 runs</span></span>
<span id="cb16-10"><a href="manipulating-an-archrproject.html#cb16-10"></a><span class="co">#   Lengths:                  4932                  3275                  2454</span></span>
<span id="cb16-11"><a href="manipulating-an-archrproject.html#cb16-11"></a><span class="co">#   Values :      &quot;scATAC_BMMC_R1&quot; &quot;scATAC_CD34_BMMC_R1&quot;      &quot;scATAC_PBMC_R1&quot;</span></span>
<span id="cb16-12"><a href="manipulating-an-archrproject.html#cb16-12"></a></span>
<span id="cb16-13"><a href="manipulating-an-archrproject.html#cb16-13"></a><span class="co">#C. Access TSS Enrichment Scores for each cell</span></span>
<span id="cb16-14"><a href="manipulating-an-archrproject.html#cb16-14"></a><span class="kw">quantile</span>(projHeme1<span class="op">$</span>TSSEnrichment)</span>
<span id="cb16-15"><a href="manipulating-an-archrproject.html#cb16-15"></a><span class="co">#    0%    25%    50%    75%   100% </span></span>
<span id="cb16-16"><a href="manipulating-an-archrproject.html#cb16-16"></a><span class="co"># 4.027 13.922 16.832 19.937 41.782 </span></span></code></pre></div>
<p><span style="font-size:20px;font-weight:bold">Example 2. Subsetting an <code>ArchRProject</code> by cells</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="manipulating-an-archrproject.html#cb17-1"></a><span class="co">#A. Subset the project numerically</span></span>
<span id="cb17-2"><a href="manipulating-an-archrproject.html#cb17-2"></a>projHeme1[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ] <span class="co">#First 100 cells</span></span>
<span id="cb17-3"><a href="manipulating-an-archrproject.html#cb17-3"></a><span class="co"># class: ArchRProject </span></span>
<span id="cb17-4"><a href="manipulating-an-archrproject.html#cb17-4"></a><span class="co"># outputDirectory: /Volumes/JG_SSD_2/ArchR_Walkthrough/HemeTutorial </span></span>
<span id="cb17-5"><a href="manipulating-an-archrproject.html#cb17-5"></a><span class="co"># samples(3): scATAC_BMMC_R1 scATAC_CD34_BMMC_R1 scATAC_PBMC_R1</span></span>
<span id="cb17-6"><a href="manipulating-an-archrproject.html#cb17-6"></a><span class="co"># sampleColData names(1): ArrowFiles</span></span>
<span id="cb17-7"><a href="manipulating-an-archrproject.html#cb17-7"></a><span class="co"># cellColData names(11): DoubletEnrichment DoubletScore ... Sample</span></span>
<span id="cb17-8"><a href="manipulating-an-archrproject.html#cb17-8"></a><span class="co">#   TSSEnrichment</span></span>
<span id="cb17-9"><a href="manipulating-an-archrproject.html#cb17-9"></a><span class="co"># numberOfCells(1): 100</span></span>
<span id="cb17-10"><a href="manipulating-an-archrproject.html#cb17-10"></a><span class="co"># medianTSS(1): 10.7725</span></span>
<span id="cb17-11"><a href="manipulating-an-archrproject.html#cb17-11"></a><span class="co"># medianFrags(1): 10200.5</span></span>
<span id="cb17-12"><a href="manipulating-an-archrproject.html#cb17-12"></a></span>
<span id="cb17-13"><a href="manipulating-an-archrproject.html#cb17-13"></a><span class="co">#B. Subset the project using cellNames</span></span>
<span id="cb17-14"><a href="manipulating-an-archrproject.html#cb17-14"></a>projHeme1[projHeme1<span class="op">$</span>cellNames[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>], ]</span>
<span id="cb17-15"><a href="manipulating-an-archrproject.html#cb17-15"></a><span class="co"># class: ArchRProject </span></span>
<span id="cb17-16"><a href="manipulating-an-archrproject.html#cb17-16"></a><span class="co"># outputDirectory: /Volumes/JG_SSD_2/ArchR_Walkthrough/HemeTutorial </span></span>
<span id="cb17-17"><a href="manipulating-an-archrproject.html#cb17-17"></a><span class="co"># samples(3): scATAC_BMMC_R1 scATAC_CD34_BMMC_R1 scATAC_PBMC_R1</span></span>
<span id="cb17-18"><a href="manipulating-an-archrproject.html#cb17-18"></a><span class="co"># sampleColData names(1): ArrowFiles</span></span>
<span id="cb17-19"><a href="manipulating-an-archrproject.html#cb17-19"></a><span class="co"># cellColData names(11): DoubletEnrichment DoubletScore ... Sample</span></span>
<span id="cb17-20"><a href="manipulating-an-archrproject.html#cb17-20"></a><span class="co">#   TSSEnrichment</span></span>
<span id="cb17-21"><a href="manipulating-an-archrproject.html#cb17-21"></a><span class="co"># numberOfCells(1): 100</span></span>
<span id="cb17-22"><a href="manipulating-an-archrproject.html#cb17-22"></a><span class="co"># medianTSS(1): 10.7725</span></span>
<span id="cb17-23"><a href="manipulating-an-archrproject.html#cb17-23"></a><span class="co"># medianFrags(1): 10200.5</span></span>
<span id="cb17-24"><a href="manipulating-an-archrproject.html#cb17-24"></a></span>
<span id="cb17-25"><a href="manipulating-an-archrproject.html#cb17-25"></a></span>
<span id="cb17-26"><a href="manipulating-an-archrproject.html#cb17-26"></a><span class="co">#C. Subset the project to return all cells corresponding to a specific sample</span></span>
<span id="cb17-27"><a href="manipulating-an-archrproject.html#cb17-27"></a>idxSample &lt;-<span class="st"> </span>BiocGenerics<span class="op">::</span><span class="kw">which</span>(projHeme1<span class="op">$</span>Sample <span class="op">%in%</span><span class="st"> &quot;scATAC_BMMC_R1&quot;</span>)</span>
<span id="cb17-28"><a href="manipulating-an-archrproject.html#cb17-28"></a>cellsSample &lt;-<span class="st"> </span>projHeme1<span class="op">$</span>cellNames[idxSample]</span>
<span id="cb17-29"><a href="manipulating-an-archrproject.html#cb17-29"></a>projHeme1[cellsSample, ]</span>
<span id="cb17-30"><a href="manipulating-an-archrproject.html#cb17-30"></a><span class="co"># class: ArchRProject </span></span>
<span id="cb17-31"><a href="manipulating-an-archrproject.html#cb17-31"></a><span class="co"># outputDirectory: /Volumes/JG_SSD_2/ArchR_Walkthrough/HemeTutorial </span></span>
<span id="cb17-32"><a href="manipulating-an-archrproject.html#cb17-32"></a><span class="co"># samples(3): scATAC_BMMC_R1 scATAC_CD34_BMMC_R1 scATAC_PBMC_R1</span></span>
<span id="cb17-33"><a href="manipulating-an-archrproject.html#cb17-33"></a><span class="co"># sampleColData names(1): ArrowFiles</span></span>
<span id="cb17-34"><a href="manipulating-an-archrproject.html#cb17-34"></a><span class="co"># cellColData names(11): DoubletEnrichment DoubletScore ... Sample</span></span>
<span id="cb17-35"><a href="manipulating-an-archrproject.html#cb17-35"></a><span class="co">#   TSSEnrichment</span></span>
<span id="cb17-36"><a href="manipulating-an-archrproject.html#cb17-36"></a><span class="co"># numberOfCells(1): 4932</span></span>
<span id="cb17-37"><a href="manipulating-an-archrproject.html#cb17-37"></a><span class="co"># medianTSS(1): 15.254</span></span>
<span id="cb17-38"><a href="manipulating-an-archrproject.html#cb17-38"></a><span class="co"># medianFrags(1): 2771</span></span>
<span id="cb17-39"><a href="manipulating-an-archrproject.html#cb17-39"></a></span>
<span id="cb17-40"><a href="manipulating-an-archrproject.html#cb17-40"></a><span class="co">#D. Subset the project based on a specific TSS enrichment score cutoff</span></span>
<span id="cb17-41"><a href="manipulating-an-archrproject.html#cb17-41"></a>idxPass &lt;-<span class="st"> </span><span class="kw">which</span>(projHeme1<span class="op">$</span>TSSEnrichment <span class="op">&gt;=</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb17-42"><a href="manipulating-an-archrproject.html#cb17-42"></a>cellsPass &lt;-<span class="st"> </span>projHeme1<span class="op">$</span>cellNames[idxPass]</span>
<span id="cb17-43"><a href="manipulating-an-archrproject.html#cb17-43"></a>projHeme1[cellsPass, ]</span>
<span id="cb17-44"><a href="manipulating-an-archrproject.html#cb17-44"></a><span class="co"># class: ArchRProject </span></span>
<span id="cb17-45"><a href="manipulating-an-archrproject.html#cb17-45"></a><span class="co"># outputDirectory: /Volumes/JG_SSD_2/ArchR_Walkthrough/HemeTutorial </span></span>
<span id="cb17-46"><a href="manipulating-an-archrproject.html#cb17-46"></a><span class="co"># samples(3): scATAC_BMMC_R1 scATAC_CD34_BMMC_R1 scATAC_PBMC_R1</span></span>
<span id="cb17-47"><a href="manipulating-an-archrproject.html#cb17-47"></a><span class="co"># sampleColData names(1): ArrowFiles</span></span>
<span id="cb17-48"><a href="manipulating-an-archrproject.html#cb17-48"></a><span class="co"># cellColData names(11): DoubletEnrichment DoubletScore ... Sample</span></span>
<span id="cb17-49"><a href="manipulating-an-archrproject.html#cb17-49"></a><span class="co">#   TSSEnrichment</span></span>
<span id="cb17-50"><a href="manipulating-an-archrproject.html#cb17-50"></a><span class="co"># numberOfCells(1): 10500</span></span>
<span id="cb17-51"><a href="manipulating-an-archrproject.html#cb17-51"></a><span class="co"># medianTSS(1): 16.9275</span></span>
<span id="cb17-52"><a href="manipulating-an-archrproject.html#cb17-52"></a><span class="co"># medianFrags(1): 3042</span></span></code></pre></div>
<p><span style="font-size:20px;font-weight:bold">Example 3. Adding data to an <code>ArchRProject</code></span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="manipulating-an-archrproject.html#cb18-1"></a><span class="co">#Add a column to cellColData that contains more legible sample names by removing excess info from the original sample names</span></span>
<span id="cb18-2"><a href="manipulating-an-archrproject.html#cb18-2"></a>bioNames &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;_R2|_R1|scATAC_&quot;</span>,<span class="st">&quot;&quot;</span>,projHeme1<span class="op">$</span>Sample)</span>
<span id="cb18-3"><a href="manipulating-an-archrproject.html#cb18-3"></a>bioNames</span>
<span id="cb18-4"><a href="manipulating-an-archrproject.html#cb18-4"></a><span class="co"># character-Rle of length 10661 with 3 runs</span></span>
<span id="cb18-5"><a href="manipulating-an-archrproject.html#cb18-5"></a><span class="co">#   Lengths:        4932        3275        2454</span></span>
<span id="cb18-6"><a href="manipulating-an-archrproject.html#cb18-6"></a><span class="co">#   Values :      &quot;BMMC&quot; &quot;CD34_BMMC&quot;      &quot;PBMC&quot;</span></span>
<span id="cb18-7"><a href="manipulating-an-archrproject.html#cb18-7"></a>projHeme1<span class="op">$</span>bioNames &lt;-<span class="st"> </span>bioNames</span>
<span id="cb18-8"><a href="manipulating-an-archrproject.html#cb18-8"></a></span>
<span id="cb18-9"><a href="manipulating-an-archrproject.html#cb18-9"></a><span class="co">#Add a column to cellColData that only contains information for a subset of cells</span></span>
<span id="cb18-10"><a href="manipulating-an-archrproject.html#cb18-10"></a>bioNames &lt;-<span class="st"> </span>bioNames[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb18-11"><a href="manipulating-an-archrproject.html#cb18-11"></a>cellNames &lt;-<span class="st"> </span>projHeme1<span class="op">$</span>cellNames[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb18-12"><a href="manipulating-an-archrproject.html#cb18-12"></a>projHeme1 &lt;-<span class="st"> </span><span class="kw">addCellColData</span>(<span class="dt">ArchRProj =</span> projHeme1, <span class="dt">data =</span> <span class="kw">paste0</span>(bioNames),</span>
<span id="cb18-13"><a href="manipulating-an-archrproject.html#cb18-13"></a>    <span class="dt">cells =</span> cellNames, <span class="dt">name =</span> <span class="st">&quot;bioNames2&quot;</span>)</span>
<span id="cb18-14"><a href="manipulating-an-archrproject.html#cb18-14"></a></span>
<span id="cb18-15"><a href="manipulating-an-archrproject.html#cb18-15"></a><span class="co">#We can compare these two columns to see &quot;NA&quot; filled in where data wasnt available for bioNames2</span></span>
<span id="cb18-16"><a href="manipulating-an-archrproject.html#cb18-16"></a><span class="kw">getCellColData</span>(projHeme1, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;bioNames&quot;</span>, <span class="st">&quot;bioNames2&quot;</span>))</span>
<span id="cb18-17"><a href="manipulating-an-archrproject.html#cb18-17"></a><span class="co"># DataFrame with 10661 rows and 2 columns</span></span>
<span id="cb18-18"><a href="manipulating-an-archrproject.html#cb18-18"></a><span class="co">#                                      bioNames   bioNames2</span></span>
<span id="cb18-19"><a href="manipulating-an-archrproject.html#cb18-19"></a><span class="co">#                                   &lt;character&gt; &lt;character&gt;</span></span>
<span id="cb18-20"><a href="manipulating-an-archrproject.html#cb18-20"></a><span class="co"># scATAC_BMMC_R1#TTATGTCAGTGATTAG-1        BMMC        BMMC</span></span>
<span id="cb18-21"><a href="manipulating-an-archrproject.html#cb18-21"></a><span class="co"># scATAC_BMMC_R1#AAGATAGTCACCGCGA-1        BMMC        BMMC</span></span>
<span id="cb18-22"><a href="manipulating-an-archrproject.html#cb18-22"></a><span class="co"># scATAC_BMMC_R1#GCATTGAAGATTCCGT-1        BMMC        BMMC</span></span>
<span id="cb18-23"><a href="manipulating-an-archrproject.html#cb18-23"></a><span class="co"># scATAC_BMMC_R1#TATGTTCAGGGTTCCC-1        BMMC        BMMC</span></span>
<span id="cb18-24"><a href="manipulating-an-archrproject.html#cb18-24"></a><span class="co"># scATAC_BMMC_R1#TCCATCGGTCCCGTGA-1        BMMC        BMMC</span></span>
<span id="cb18-25"><a href="manipulating-an-archrproject.html#cb18-25"></a><span class="co"># ...                                       ...         ...</span></span>
<span id="cb18-26"><a href="manipulating-an-archrproject.html#cb18-26"></a><span class="co"># scATAC_PBMC_R1#GCTGCGAAGATCCGAG-1        PBMC          NA</span></span>
<span id="cb18-27"><a href="manipulating-an-archrproject.html#cb18-27"></a><span class="co"># scATAC_PBMC_R1#GCAGCTGGTGGCCTTG-1        PBMC          NA</span></span>
<span id="cb18-28"><a href="manipulating-an-archrproject.html#cb18-28"></a><span class="co"># scATAC_PBMC_R1#GCAGATTGTACGCAAG-1        PBMC          NA</span></span>
<span id="cb18-29"><a href="manipulating-an-archrproject.html#cb18-29"></a><span class="co"># scATAC_PBMC_R1#TTCGTTACATTGAACC-1        PBMC          NA</span></span>
<span id="cb18-30"><a href="manipulating-an-archrproject.html#cb18-30"></a><span class="co"># scATAC_PBMC_R1#CGCTATCGTGAGGTCA-1        PBMC          NA</span></span></code></pre></div>
<p><span style="font-size:20px;font-weight:bold">Example 4. Obtaining unique fragment counts</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="manipulating-an-archrproject.html#cb19-1"></a><span class="co">#Select the column from cellColData corresponding to the number of unique</span></span>
<span id="cb19-2"><a href="manipulating-an-archrproject.html#cb19-2"></a><span class="co">#nuclear (non-mitochondrial) fragments per cell</span></span>
<span id="cb19-3"><a href="manipulating-an-archrproject.html#cb19-3"></a>df &lt;-<span class="st"> </span><span class="kw">getCellColData</span>(projHeme1, <span class="dt">select =</span> <span class="st">&quot;nFrags&quot;</span>)</span>
<span id="cb19-4"><a href="manipulating-an-archrproject.html#cb19-4"></a>df</span>
<span id="cb19-5"><a href="manipulating-an-archrproject.html#cb19-5"></a><span class="co"># DataFrame with 10661 rows and 1 column</span></span>
<span id="cb19-6"><a href="manipulating-an-archrproject.html#cb19-6"></a><span class="co">#                                      nFrags</span></span>
<span id="cb19-7"><a href="manipulating-an-archrproject.html#cb19-7"></a><span class="co">#                                   &lt;numeric&gt;</span></span>
<span id="cb19-8"><a href="manipulating-an-archrproject.html#cb19-8"></a><span class="co"># scATAC_BMMC_R1#TTATGTCAGTGATTAG-1     26189</span></span>
<span id="cb19-9"><a href="manipulating-an-archrproject.html#cb19-9"></a><span class="co"># scATAC_BMMC_R1#AAGATAGTCACCGCGA-1     20648</span></span>
<span id="cb19-10"><a href="manipulating-an-archrproject.html#cb19-10"></a><span class="co"># scATAC_BMMC_R1#GCATTGAAGATTCCGT-1     18991</span></span>
<span id="cb19-11"><a href="manipulating-an-archrproject.html#cb19-11"></a><span class="co"># scATAC_BMMC_R1#TATGTTCAGGGTTCCC-1     18296</span></span>
<span id="cb19-12"><a href="manipulating-an-archrproject.html#cb19-12"></a><span class="co"># scATAC_BMMC_R1#TCCATCGGTCCCGTGA-1     17458</span></span>
<span id="cb19-13"><a href="manipulating-an-archrproject.html#cb19-13"></a><span class="co"># ...                                     ...</span></span>
<span id="cb19-14"><a href="manipulating-an-archrproject.html#cb19-14"></a><span class="co"># scATAC_PBMC_R1#GCTGCGAAGATCCGAG-1      1038</span></span>
<span id="cb19-15"><a href="manipulating-an-archrproject.html#cb19-15"></a><span class="co"># scATAC_PBMC_R1#GCAGCTGGTGGCCTTG-1      1037</span></span>
<span id="cb19-16"><a href="manipulating-an-archrproject.html#cb19-16"></a><span class="co"># scATAC_PBMC_R1#GCAGATTGTACGCAAG-1      1033</span></span>
<span id="cb19-17"><a href="manipulating-an-archrproject.html#cb19-17"></a><span class="co"># scATAC_PBMC_R1#TTCGTTACATTGAACC-1      1033</span></span>
<span id="cb19-18"><a href="manipulating-an-archrproject.html#cb19-18"></a><span class="co"># scATAC_PBMC_R1#CGCTATCGTGAGGTCA-1      1002</span></span>
<span id="cb19-19"><a href="manipulating-an-archrproject.html#cb19-19"></a></span>
<span id="cb19-20"><a href="manipulating-an-archrproject.html#cb19-20"></a><span class="co">#Or, instead of selecting a column by name, we can actually perform operations on a given</span></span>
<span id="cb19-21"><a href="manipulating-an-archrproject.html#cb19-21"></a><span class="co">#column using its column name</span></span>
<span id="cb19-22"><a href="manipulating-an-archrproject.html#cb19-22"></a>df &lt;-<span class="st"> </span><span class="kw">getCellColData</span>(projHeme1, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;log10(nFrags)&quot;</span>, <span class="st">&quot;nFrags - 1&quot;</span>))</span>
<span id="cb19-23"><a href="manipulating-an-archrproject.html#cb19-23"></a>df</span>
<span id="cb19-24"><a href="manipulating-an-archrproject.html#cb19-24"></a><span class="co"># DataFrame with 10661 rows and 2 columns</span></span>
<span id="cb19-25"><a href="manipulating-an-archrproject.html#cb19-25"></a><span class="co">#                                      log10(nFrags) nFrags - 1</span></span>
<span id="cb19-26"><a href="manipulating-an-archrproject.html#cb19-26"></a><span class="co">#                                          &lt;numeric&gt;  &lt;numeric&gt;</span></span>
<span id="cb19-27"><a href="manipulating-an-archrproject.html#cb19-27"></a><span class="co"># scATAC_BMMC_R1#TTATGTCAGTGATTAG-1  4.4181189156542      26188</span></span>
<span id="cb19-28"><a href="manipulating-an-archrproject.html#cb19-28"></a><span class="co"># scATAC_BMMC_R1#AAGATAGTCACCGCGA-1 4.31487799153581      20647</span></span>
<span id="cb19-29"><a href="manipulating-an-archrproject.html#cb19-29"></a><span class="co"># scATAC_BMMC_R1#GCATTGAAGATTCCGT-1 4.27854783377585      18990</span></span>
<span id="cb19-30"><a href="manipulating-an-archrproject.html#cb19-30"></a><span class="co"># scATAC_BMMC_R1#TATGTTCAGGGTTCCC-1 4.26235615159869      18295</span></span>
<span id="cb19-31"><a href="manipulating-an-archrproject.html#cb19-31"></a><span class="co"># scATAC_BMMC_R1#TCCATCGGTCCCGTGA-1 4.24199448915678      17457</span></span>
<span id="cb19-32"><a href="manipulating-an-archrproject.html#cb19-32"></a><span class="co"># ...                                            ...        ...</span></span>
<span id="cb19-33"><a href="manipulating-an-archrproject.html#cb19-33"></a><span class="co"># scATAC_PBMC_R1#GCTGCGAAGATCCGAG-1 3.01619735351244       1037</span></span>
<span id="cb19-34"><a href="manipulating-an-archrproject.html#cb19-34"></a><span class="co"># scATAC_PBMC_R1#GCAGCTGGTGGCCTTG-1 3.01577875638904       1036</span></span>
<span id="cb19-35"><a href="manipulating-an-archrproject.html#cb19-35"></a><span class="co"># scATAC_PBMC_R1#GCAGATTGTACGCAAG-1 3.01410032151962       1032</span></span>
<span id="cb19-36"><a href="manipulating-an-archrproject.html#cb19-36"></a><span class="co"># scATAC_PBMC_R1#TTCGTTACATTGAACC-1 3.01410032151962       1032</span></span>
<span id="cb19-37"><a href="manipulating-an-archrproject.html#cb19-37"></a><span class="co"># scATAC_PBMC_R1#CGCTATCGTGAGGTCA-1 3.00086772153123       1001</span></span></code></pre></div>
<p><span style="font-size:20px;font-weight:bold">Example 5. Plotting QC metrics - log10(Unique Fragments) vs TSS enrichment score</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="manipulating-an-archrproject.html#cb20-1"></a>df &lt;-<span class="st"> </span><span class="kw">getCellColData</span>(projHeme1, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;log10(nFrags)&quot;</span>, <span class="st">&quot;TSSEnrichment&quot;</span>))</span>
<span id="cb20-2"><a href="manipulating-an-archrproject.html#cb20-2"></a>df</span>
<span id="cb20-3"><a href="manipulating-an-archrproject.html#cb20-3"></a><span class="co"># DataFrame with 10661 rows and 2 columns</span></span>
<span id="cb20-4"><a href="manipulating-an-archrproject.html#cb20-4"></a><span class="co">#                                      log10(nFrags) TSSEnrichment</span></span>
<span id="cb20-5"><a href="manipulating-an-archrproject.html#cb20-5"></a><span class="co">#                                          &lt;numeric&gt;     &lt;numeric&gt;</span></span>
<span id="cb20-6"><a href="manipulating-an-archrproject.html#cb20-6"></a><span class="co"># scATAC_BMMC_R1#TTATGTCAGTGATTAG-1  4.4181189156542         7.149</span></span>
<span id="cb20-7"><a href="manipulating-an-archrproject.html#cb20-7"></a><span class="co"># scATAC_BMMC_R1#AAGATAGTCACCGCGA-1 4.31487799153581         7.911</span></span>
<span id="cb20-8"><a href="manipulating-an-archrproject.html#cb20-8"></a><span class="co"># scATAC_BMMC_R1#GCATTGAAGATTCCGT-1 4.27854783377585         4.505</span></span>
<span id="cb20-9"><a href="manipulating-an-archrproject.html#cb20-9"></a><span class="co"># scATAC_BMMC_R1#TATGTTCAGGGTTCCC-1 4.26235615159869         6.946</span></span>
<span id="cb20-10"><a href="manipulating-an-archrproject.html#cb20-10"></a><span class="co"># scATAC_BMMC_R1#TCCATCGGTCCCGTGA-1 4.24199448915678         4.799</span></span>
<span id="cb20-11"><a href="manipulating-an-archrproject.html#cb20-11"></a><span class="co"># ...                                            ...           ...</span></span>
<span id="cb20-12"><a href="manipulating-an-archrproject.html#cb20-12"></a><span class="co"># scATAC_PBMC_R1#GCTGCGAAGATCCGAG-1 3.01619735351244        24.356</span></span>
<span id="cb20-13"><a href="manipulating-an-archrproject.html#cb20-13"></a><span class="co"># scATAC_PBMC_R1#GCAGCTGGTGGCCTTG-1 3.01577875638904        22.537</span></span>
<span id="cb20-14"><a href="manipulating-an-archrproject.html#cb20-14"></a><span class="co"># scATAC_PBMC_R1#GCAGATTGTACGCAAG-1 3.01410032151962        20.146</span></span>
<span id="cb20-15"><a href="manipulating-an-archrproject.html#cb20-15"></a><span class="co"># scATAC_PBMC_R1#TTCGTTACATTGAACC-1 3.01410032151962        30.198</span></span>
<span id="cb20-16"><a href="manipulating-an-archrproject.html#cb20-16"></a><span class="co"># scATAC_PBMC_R1#CGCTATCGTGAGGTCA-1 3.00086772153123        21.485</span></span></code></pre></div>
<p>Now lets plot the number of unique nuclear fragments (log10) by the TSS enrichment score. This type of plot is
key for identifying high quality cells. We can further adjust our cutoffs based on this plot if need be.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="manipulating-an-archrproject.html#cb21-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggPoint</span>(</span>
<span id="cb21-2"><a href="manipulating-an-archrproject.html#cb21-2"></a>    <span class="dt">x =</span> df[,<span class="dv">1</span>], </span>
<span id="cb21-3"><a href="manipulating-an-archrproject.html#cb21-3"></a>    <span class="dt">y =</span> df[,<span class="dv">2</span>], </span>
<span id="cb21-4"><a href="manipulating-an-archrproject.html#cb21-4"></a>    <span class="dt">colorDensity =</span> <span class="ot">TRUE</span>,</span>
<span id="cb21-5"><a href="manipulating-an-archrproject.html#cb21-5"></a>    <span class="dt">continuousSet =</span> <span class="st">&quot;sambaNight&quot;</span>,</span>
<span id="cb21-6"><a href="manipulating-an-archrproject.html#cb21-6"></a>    <span class="dt">xlabel =</span> <span class="st">&quot;Log10 Unique Fragments&quot;</span>,</span>
<span id="cb21-7"><a href="manipulating-an-archrproject.html#cb21-7"></a>    <span class="dt">ylabel =</span> <span class="st">&quot;TSS Enrichment&quot;</span>,</span>
<span id="cb21-8"><a href="manipulating-an-archrproject.html#cb21-8"></a>    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">log10</span>(<span class="dv">500</span>), <span class="kw">quantile</span>(df[,<span class="dv">1</span>], <span class="dt">probs =</span> <span class="fl">0.99</span>)),</span>
<span id="cb21-9"><a href="manipulating-an-archrproject.html#cb21-9"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">quantile</span>(df[,<span class="dv">2</span>], <span class="dt">probs =</span> <span class="fl">0.99</span>))</span>
<span id="cb21-10"><a href="manipulating-an-archrproject.html#cb21-10"></a>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb21-11"><a href="manipulating-an-archrproject.html#cb21-11"></a></span>
<span id="cb21-12"><a href="manipulating-an-archrproject.html#cb21-12"></a>p</span></code></pre></div>
<p><img src="images/HemeWalkthrough/PNG/TSS-vs-Frags_1.png" width="500" height="500" /></p>
<p>To save an editable vectorized version of this plot, we use <code>plotPDF()</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="manipulating-an-archrproject.html#cb22-1"></a><span class="kw">plotPDF</span>(p, <span class="dt">name =</span> <span class="st">&quot;TSS-vs-Frags.pdf&quot;</span>, <span class="dt">ArchRProj =</span> projHeme1, <span class="dt">addDOC =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><a href="images/HemeWalkthrough/PDF/TSS-vs-Frags.pdf">Download PDF : TSS-vs-Frags.pdf</a></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-an-archrproject-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-sample-statistics-from-an-archrproject.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": null
},
"fontsettings": null,
"edit": null,
"history": {
"link": "https://github.com/GreenleafLab/ArchR_Website/commits/dev/03_ArchRProject.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": "https://github.com/GreenleafLab/ArchR_Website/view/dev/03_ArchRProject.Rmd",
"text": "View source on GitHub"
},
"download": ["ArchR.pdf"],
"toc": {
"collapse": "none"
},
"search": true,
"info": false
});
});
</script>

</body>

</html>
