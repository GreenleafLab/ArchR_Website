<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot a Heatmap of Features across a Trajectory — plotTrajectoryHeatmap • ArchR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot a Heatmap of Features across a Trajectory — plotTrajectoryHeatmap"><meta property="og:description" content="This function will plot a heatmap of the results from getTrajectory"><meta property="og:image" content="https://www.ArchRProject.com/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158769145-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158769145-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/Articles/tutorial.html">
    <span class="fa fa-graduation-cap"></span>

    Quick Tutorial
  </a>
</li>
<li>
  <a href="../bookdown/index.html">
    <span class="fa fa-file-text-o"></span>

    Full Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>

    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GreenleafLab/ArchR" class="external-link">
    <span class="fa fa-github"></span>

    ArchR on GitHub
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a Heatmap of Features across a Trajectory</h1>

    <div class="hidden name"><code>plotTrajectoryHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will plot a heatmap of the results from getTrajectory</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotTrajectoryHeatmap</span><span class="op">(</span></span>
<span>  seTrajectory <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varCutOff <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  maxFeatures <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  scaleRows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  grepExclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colorColumns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  columnPal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labelMarkers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labelTop <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  labelRows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rowOrder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useSeqnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnMatrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logFile <span class="op">=</span> <span class="fu"><a href="createLogFile.html">createLogFile</a></span><span class="op">(</span><span class="st">"plotTrajectoryHeatmap"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-setrajectory">seTrajectory<a class="anchor" aria-label="anchor" href="#arg-setrajectory"></a></dt>
<dd><p>A <code>SummarizedExperiment</code> object that results from calling <code><a href="getTrajectory.html">getTrajectory()</a></code>.</p></dd>


<dt id="arg-varcutoff">varCutOff<a class="anchor" aria-label="anchor" href="#arg-varcutoff"></a></dt>
<dd><p>The "Variance Quantile Cutoff" to be used for identifying the top variable features across the given trajectory.
Only features with a variance above the provided quantile will be retained.</p></dd>


<dt id="arg-maxfeatures">maxFeatures<a class="anchor" aria-label="anchor" href="#arg-maxfeatures"></a></dt>
<dd><p>The maximum number of features, ordered by variance, to consider from <code>useMatrix</code> when generating a trajectory.
This prevents smoothing a large number number of features which can be very time consuming.</p></dd>


<dt id="arg-scalerows">scaleRows<a class="anchor" aria-label="anchor" href="#arg-scalerows"></a></dt>
<dd><p>A boolean value that indicates whether row-wise z-scores should be computed on the matrix provided by <code>seTrajectory</code>.</p></dd>


<dt id="arg-limits">limits<a class="anchor" aria-label="anchor" href="#arg-limits"></a></dt>
<dd><p>A numeric vector of two numbers that represent the lower and upper limits of the heatmap color scheme.</p></dd>


<dt id="arg-grepexclude">grepExclude<a class="anchor" aria-label="anchor" href="#arg-grepexclude"></a></dt>
<dd><p>A character vector or string that indicates the <code>rownames</code> or a specific pattern that identifies
rownames from <code>seTrajectory</code> to be excluded from the heatmap.</p></dd>


<dt id="arg-pal">pal<a class="anchor" aria-label="anchor" href="#arg-pal"></a></dt>
<dd><p>A custom continuous palette (see <code><a href="paletteContinuous.html">paletteContinuous()</a></code>) used to override the default continuous palette for the heatmap.</p></dd>


<dt id="arg-colorcolumns">colorColumns<a class="anchor" aria-label="anchor" href="#arg-colorcolumns"></a></dt>
<dd><p>A boolean value that indicates whether a color bar should be added to label the columns. The color for each column
will represent the most common label observed in the corresponding trajectory quantile as the heatmap is divided into quantile bins
and thus does not display information for each cell. <code>colorColumns</code> can only be set to <code>TRUE</code> if the <code>trajectoryLabel</code> parameter was used
in <code><a href="getTrajectory.html">getTrajectory()</a></code>.</p></dd>


<dt id="arg-columnpal">columnPal<a class="anchor" aria-label="anchor" href="#arg-columnpal"></a></dt>
<dd><p>A discrete palette (see <code><a href="paletteDiscrete.html">paletteDiscrete()</a></code>) that maps the different labels of the trajectory to a unique color. This
parameter is ignored unless <code>colorColumns = TRUE</code>. All labels shown in <code>unique(colData(seTrajectory)$label)</code> must be represented.</p></dd>


<dt id="arg-labelmarkers">labelMarkers<a class="anchor" aria-label="anchor" href="#arg-labelmarkers"></a></dt>
<dd><p>A character vector listing the <code>rownames</code> of <code>seTrajectory</code> that should be labeled on the side of the heatmap.</p></dd>


<dt id="arg-labeltop">labelTop<a class="anchor" aria-label="anchor" href="#arg-labeltop"></a></dt>
<dd><p>A number indicating how many of the top N features, based on variance, in <code>seTrajectory</code> should be labeled on the side of the heatmap.</p></dd>


<dt id="arg-labelrows">labelRows<a class="anchor" aria-label="anchor" href="#arg-labelrows"></a></dt>
<dd><p>A boolean value that indicates whether all rows should be labeled on the side of the heatmap.</p></dd>


<dt id="arg-roworder">rowOrder<a class="anchor" aria-label="anchor" href="#arg-roworder"></a></dt>
<dd><p>If wanting to set the order of rows to be plotted, the indices (integer or character correpsonding
to rownmaes) can be provided here.</p></dd>


<dt id="arg-useseqnames">useSeqnames<a class="anchor" aria-label="anchor" href="#arg-useseqnames"></a></dt>
<dd><p>A character vector that indicates which <code>seqnames</code> should be plotted in the heatmap. Features from
<code>seqnames</code> that are not listed will be ignored. In the context of a <code>Sparse.Assays.Matrix</code>, such as a matrix containing chromVAR
deviations, the <code>seqnames</code> do not correspond to chromosomes, rather they correspond to the sub-portions of the matrix, for example
raw deviations ("deviations") or deviation z-scores ("z") for a chromVAR deviations matrix.</p></dd>


<dt id="arg-returnmatrix">returnMatrix<a class="anchor" aria-label="anchor" href="#arg-returnmatrix"></a></dt>
<dd><p>A boolean value that indicates whether the final heatmap matrix should be returned in lieu of plotting the actual heatmap.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>If useSeqnames is longer than 1 if matrixClass is "Sparse.Assays.Matrix" to continue. This is not recommended because these matrices
can be in different units.</p></dd>


<dt id="arg-logfile">logFile<a class="anchor" aria-label="anchor" href="#arg-logfile"></a></dt>
<dd><p>The path to a file to be used for logging ArchR output.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co"># Get Test ArchR Project</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="getTestProject.html">getTestProject</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Add Trajectory</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="addTrajectory.html">addTrajectory</a></span><span class="op">(</span><span class="va">proj</span>, trajectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span><span class="op">)</span>, embedding <span class="op">=</span> <span class="st">"UMAP"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get Trajectory</span></span>
<span><span class="va">seTraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="getTrajectory.html">getTrajectory</a></span><span class="op">(</span><span class="va">proj</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot Trajectory Heatmap</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plotTrajectoryHeatmap</span><span class="op">(</span><span class="va">seTraj</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot PDF</span></span>
<span><span class="fu"><a href="plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">p</span>, name <span class="op">=</span> <span class="st">"Trajectory-Heatmap"</span>, ArchRProj <span class="op">=</span> <span class="va">proj</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://twitter.com/JeffreyGranja" class="external-link">Jeffrey Granja</a>, <a href="https://twitter.com/doctorcorces" class="external-link">Ryan Corces</a>, <a href="https://twitter.com/paulinapaiz02" class="external-link">Paulina Paiz</a>, <a href="https://github.com/immanuelazn" class="external-link">Immanuel Abdi</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: '252c2c36fedc32b3ed803d0db4877b96',
    indexName: 'archr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

