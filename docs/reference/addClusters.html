<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add cluster information to an ArchRProject — addClusters • ArchR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Add cluster information to an ArchRProject — addClusters"><meta property="og:description" content="This function will identify clusters from a reduced dimensions object in an ArchRProject or from a supplied reduced dimensions matrix."><meta property="og:image" content="https://www.ArchRProject.com/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158769145-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158769145-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/Articles/tutorial.html">
    <span class="fa fa-graduation-cap"></span>

    Quick Tutorial
  </a>
</li>
<li>
  <a href="../bookdown/index.html">
    <span class="fa fa-file-text-o"></span>

    Full Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>

    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GreenleafLab/ArchR" class="external-link">
    <span class="fa fa-github"></span>

    ArchR on GitHub
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add cluster information to an ArchRProject</h1>

    <div class="hidden name"><code>addClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will identify clusters from a reduced dimensions object in an ArchRProject or from a supplied reduced dimensions matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addClusters</span><span class="op">(</span></span>
<span>  input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reducedDims <span class="op">=</span> <span class="st">"IterativeLSI"</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Clusters"</span>,</span>
<span>  sampleCells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Seurat"</span>,</span>
<span>  dimsToUse <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleDims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corCutOff <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  knnAssign <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nOutlier <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  maxClusters <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  testBias <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filterBias <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  biasClusters <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  biasCol <span class="op">=</span> <span class="st">"nFrags"</span>,</span>
<span>  biasVals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  biasQuantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  biasEnrich <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  biasProportion <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  biasPval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  nPerm <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>  FCmethod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ArchRProj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tstart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logFile <span class="op">=</span> <span class="fu"><a href="createLogFile.html">createLogFile</a></span><span class="op">(</span><span class="st">"addClusters"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>Either (i) an <code>ArchRProject</code> object containing the dimensionality reduction matrix passed by <code>reducedDims</code>
or (ii) a dimensionality reduction matrix. This object will be used for cluster identification.</p></dd>


<dt id="arg-reduceddims">reducedDims<a class="anchor" aria-label="anchor" href="#arg-reduceddims"></a></dt>
<dd><p>The name of the <code>reducedDims</code> object (i.e. "IterativeLSI") to retrieve from the designated <code>ArchRProject</code>.
Not required if input is a matrix.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>The column name of the cluster label column to be added to <code>cellColData</code> if <code>input</code> is an <code>ArchRProject</code> object.</p></dd>


<dt id="arg-samplecells">sampleCells<a class="anchor" aria-label="anchor" href="#arg-samplecells"></a></dt>
<dd><p>An integer specifying the number of cells to subsample and perform clustering on. The remaining cells
that were not subsampled will be assigned to the cluster of the nearest subsampled cell. This enables a decrease in run time
but can sacrifice granularity of clusters.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A number to be used as the seed for random number generation required in cluster determination. It is recommended
to keep track of the seed used so that you can reproduce results downstream.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A string indicating the clustering method to be used. Supported methods are "Seurat" and "Scran".</p></dd>


<dt id="arg-dimstouse">dimsToUse<a class="anchor" aria-label="anchor" href="#arg-dimstouse"></a></dt>
<dd><p>A vector containing the dimensions from the <code>reducedDims</code> object to use in clustering.</p></dd>


<dt id="arg-scaledims">scaleDims<a class="anchor" aria-label="anchor" href="#arg-scaledims"></a></dt>
<dd><p>A boolean value that indicates whether to z-score the reduced dimensions for each cell. This is useful for minimizing the contribution
of strong biases (dominating early PCs) and lowly abundant populations. However, this may lead to stronger sample-specific biases since
it is over-weighting latent PCs. If set to <code>NULL</code> this will scale the dimensions based on the value of <code>scaleDims</code> when the <code>reducedDims</code> were
originally created during dimensionality reduction. This idea was introduced by Timothy Stuart.</p></dd>


<dt id="arg-corcutoff">corCutOff<a class="anchor" aria-label="anchor" href="#arg-corcutoff"></a></dt>
<dd><p>A numeric cutoff for the correlation of each dimension to the sequencing depth. If the dimension has a correlation to
sequencing depth that is greater than the <code>corCutOff</code>, it will be excluded from analysis.</p></dd>


<dt id="arg-knnassign">knnAssign<a class="anchor" aria-label="anchor" href="#arg-knnassign"></a></dt>
<dd><p>The number of nearest neighbors to be used during clustering for assignment of outliers (clusters with less than nOutlier cells).</p></dd>


<dt id="arg-noutlier">nOutlier<a class="anchor" aria-label="anchor" href="#arg-noutlier"></a></dt>
<dd><p>The minimum number of cells required for a group of cells to be called as a cluster. If a group of cells does not reach
this threshold, then the cells will be considered outliers and assigned to nearby clusters.</p></dd>


<dt id="arg-maxclusters">maxClusters<a class="anchor" aria-label="anchor" href="#arg-maxclusters"></a></dt>
<dd><p>The maximum number of clusters to be called. If the number exceeds this the clusters are merged unbiasedly using hclust and cutree.
This is useful for contraining the cluster calls to be reasonable if they are converging on large numbers. Useful in iterativeLSI as well for initial iteration. Default is set to 25.</p></dd>


<dt id="arg-testbias">testBias<a class="anchor" aria-label="anchor" href="#arg-testbias"></a></dt>
<dd><p>A boolean value that indicates whether or not to test clusters for bias.</p></dd>


<dt id="arg-filterbias">filterBias<a class="anchor" aria-label="anchor" href="#arg-filterbias"></a></dt>
<dd><p>A boolean value indicates whether or not to filter clusters that are identified as biased.</p></dd>


<dt id="arg-biasclusters">biasClusters<a class="anchor" aria-label="anchor" href="#arg-biasclusters"></a></dt>
<dd><p>A numeric value between 0 and 1 indicating that clusters that are smaller than the specified proportion of total cells are
to be checked for bias. This should be set close to 0. We recommend a default of 0.01 which specifies clusters below 1 percent of the total cells.</p></dd>


<dt id="arg-biascol">biasCol<a class="anchor" aria-label="anchor" href="#arg-biascol"></a></dt>
<dd><p>The name of a column in <code>cellColData</code> that contains the numeric values used for testing bias enrichment.</p></dd>


<dt id="arg-biasvals">biasVals<a class="anchor" aria-label="anchor" href="#arg-biasvals"></a></dt>
<dd><p>A set of numeric values used for testing bias enrichment if <code>input</code> is not an <code>ArchRProject</code>.</p></dd>


<dt id="arg-biasquantiles">biasQuantiles<a class="anchor" aria-label="anchor" href="#arg-biasquantiles"></a></dt>
<dd><p>A vector of two numeric values, each between 0 and 1, that describes the lower and upper quantiles of the bias values to use
for computing bias enrichment statistics.</p></dd>


<dt id="arg-biasenrich">biasEnrich<a class="anchor" aria-label="anchor" href="#arg-biasenrich"></a></dt>
<dd><p>A numeric value that specifies the minimum enrichment of biased cells over the median of the permuted background sets.</p></dd>


<dt id="arg-biasproportion">biasProportion<a class="anchor" aria-label="anchor" href="#arg-biasproportion"></a></dt>
<dd><p>A numeric value between 0 and 1 that specifies the minimum proportion of biased cells in a cluster required to determine that the
cluster is biased during testing for bias-enriched clusters.</p></dd>


<dt id="arg-biaspval">biasPval<a class="anchor" aria-label="anchor" href="#arg-biaspval"></a></dt>
<dd><p>A numeric value between 0 and 1 that specifies the p-value to use when testing for bias-enriched clusters.</p></dd>


<dt id="arg-nperm">nPerm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>An integer specifying the number of permutations to perform for testing bias-enriched clusters.</p></dd>


<dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>A character string to be added before each cluster identity. For example, if "Cluster" then cluster results will be "Cluster1", "Cluster2" etc.</p></dd>


<dt id="arg-fcmethod">FCmethod<a class="anchor" aria-label="anchor" href="#arg-fcmethod"></a></dt>
<dd><p>A character string that will be passed as the method parameter of <code><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">Seurat::FindClusters()</a></code>.</p></dd>


<dt id="arg-archrproj">ArchRProj<a class="anchor" aria-label="anchor" href="#arg-archrproj"></a></dt>
<dd><p>An <code>ArchRProject</code> object containing the dimensionality reduction matrix passed by <code>reducedDims</code>. This argument can also be supplied as <code>input</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A boolean value indicating whether to use verbose output during execution of this function. Can be set to FALSE for a cleaner output.</p></dd>


<dt id="arg-tstart">tstart<a class="anchor" aria-label="anchor" href="#arg-tstart"></a></dt>
<dd><p>A timestamp that is typically passed internally from another function (for ex. "IterativeLSI") to measure how long the clustering analysis
has been running relative to the start time when this process was initiated in another function. This argument is rarely manually specified.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>A boolean value that indicates whether or not to overwrite data in a given column when the value passed to <code>name</code> already
exists as a column name in <code>cellColData</code>.</p></dd>


<dt id="arg-logfile">logFile<a class="anchor" aria-label="anchor" href="#arg-logfile"></a></dt>
<dd><p>The path to a file to be used for logging ArchR output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be provided to <code><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">Seurat::FindClusters()</a></code> or <code><a href="https://rdrr.io/pkg/scran/man/buildSNNGraph.html" class="external-link">scran::buildSNNGraph()</a></code> (for example, knn = 50, jaccard = TRUE). Note
that to pass values to the <code>method</code> parameter of <code><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">Seurat::FindClusters()</a></code> you should use the <code>FCmethod</code> parameter in <code>addClusters()</code> because <code>addClusters()</code>
already has a <code>method</code> parameter.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co"># Get Test ArchR Project</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="getTestProject.html">getTestProject</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get Peak Annotations</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu">addClusters</span><span class="op">(</span><span class="va">proj</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://twitter.com/JeffreyGranja" class="external-link">Jeffrey Granja</a>, <a href="https://twitter.com/doctorcorces" class="external-link">Ryan Corces</a>, <a href="https://twitter.com/paulinapaiz02" class="external-link">Paulina Paiz</a>, <a href="https://github.com/immanuelazn" class="external-link">Immanuel Abdi</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: '252c2c36fedc32b3ed803d0db4877b96',
    indexName: 'archr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

