<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add an Iterative LSI-based dimensionality reduction to an ArchRProject — addIterativeLSI • ArchR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Add an Iterative LSI-based dimensionality reduction to an ArchRProject — addIterativeLSI" />

<meta property="og:description" content="This function will compute an iterative LSI dimensionality reduction on an ArchRProject." />

<meta property="og:image" content="https://greenleaflab.github.io/ArchR_Website/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158769145-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158769145-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Articles/tutorial.html">
    <span class="fa fa-graduation-cap"></span>
     
    Quick Tutorial
  </a>
</li>
<li>
  <a href="../bookdown/index.html">
    <span class="fa fa-file-text-o"></span>
     
    Full Manual
  </a>
</li>
<li>
  <a href="../articles/Articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    FAQ
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Functions
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GreenleafLab/ArchR">
    <span class="fa fa-github"></span>
     
    ArchR on GitHub
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add an Iterative LSI-based dimensionality reduction to an ArchRProject</h1>
    
    <div class="hidden name"><code>addIterativeLSI.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function will compute an iterative LSI dimensionality reduction on an ArchRProject.</p>
    
    </div>

    <pre class="usage"><span class='fu'>addIterativeLSI</span>(
  <span class='kw'>ArchRProj</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>useMatrix</span> <span class='kw'>=</span> <span class='st'>"TileMatrix"</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"IterativeLSI"</span>,
  <span class='kw'>iterations</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>clusterParams</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>resolution</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.2</span>), <span class='kw'>sampleCells</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>n.start</span> <span class='kw'>=</span> <span class='fl'>10</span>),
  <span class='kw'>varFeatures</span> <span class='kw'>=</span> <span class='fl'>25000</span>,
  <span class='kw'>dimsToUse</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>30</span>,
  <span class='kw'>LSIMethod</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>scaleDims</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>corCutOff</span> <span class='kw'>=</span> <span class='fl'>0.75</span>,
  <span class='kw'>binarize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>outlierQuantiles</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.02</span>, <span class='fl'>0.98</span>),
  <span class='kw'>filterBias</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>sampleCellsPre</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>projectCellsPre</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sampleCellsFinal</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>selectionMethod</span> <span class='kw'>=</span> <span class='st'>"var"</span>,
  <span class='kw'>scaleTo</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>totalFeatures</span> <span class='kw'>=</span> <span class='fl'>5e+05</span>,
  <span class='kw'>filterQuantile</span> <span class='kw'>=</span> <span class='fl'>0.995</span>,
  <span class='kw'>excludeChr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>saveIterations</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>UMAPParams</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>n_neighbors</span> <span class='kw'>=</span> <span class='fl'>40</span>, <span class='kw'>min_dist</span> <span class='kw'>=</span> <span class='fl'>0.4</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"cosine"</span>, <span class='kw'>verbose</span> <span class='kw'>=</span>
    <span class='fl'>FALSE</span>, <span class='kw'>fast_sgd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
  <span class='kw'>nPlot</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>outDir</span> <span class='kw'>=</span> <span class='fu'><a href='getOutputDirectory.html'>getOutputDirectory</a></span>(<span class='no'>ArchRProj</span>),
  <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fu'><a href='getArchRThreads.html'>getArchRThreads</a></span>(),
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>force</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>logFile</span> <span class='kw'>=</span> <span class='fu'><a href='createLogFile.html'>createLogFile</a></span>(<span class='st'>"addIterativeLSI"</span>)
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ArchRProj</th>
      <td><p>An <code>ArchRProject</code> object.</p></td>
    </tr>
    <tr>
      <th>useMatrix</th>
      <td><p>The name of the data matrix to retrieve from the ArrowFiles associated with the <code>ArchRProject</code>. Valid options are
"TileMatrix" or "PeakMatrix".</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>The name to use for storage of the IterativeLSI dimensionality reduction in the <code>ArchRProject</code> as a <code>reducedDims</code> object.</p></td>
    </tr>
    <tr>
      <th>iterations</th>
      <td><p>The number of LSI iterations to perform.</p></td>
    </tr>
    <tr>
      <th>clusterParams</th>
      <td><p>A list of Additional parameters to be passed to <code><a href='addClusters.html'>addClusters()</a></code> for clustering within each iteration.
These params can be constant across each iteration, or specified for each iteration individually. Thus each param must be of
length == 1 or the total number of <code>iterations</code> - 1.</p></td>
    </tr>
    <tr>
      <th>varFeatures</th>
      <td><p>The number of N variable features to use for LSI. The top N features will be used based on the <code>selectionMethod</code>.</p></td>
    </tr>
    <tr>
      <th>dimsToUse</th>
      <td><p>A vector containing the dimensions from the <code>reducedDims</code> object to use in clustering.</p></td>
    </tr>
    <tr>
      <th>LSIMethod</th>
      <td><p>A number or string indicating the order of operations in the TF-IDF normalization.
Possible values are: 1 or "tf-logidf", 2 or "log(tf-idf)", and 3 or "logtf-logidf".</p></td>
    </tr>
    <tr>
      <th>scaleDims</th>
      <td><p>A boolean that indicates whether to z-score the reduced dimensions for each cell. This is useful forminimizing the contribution
of strong biases (dominating early PCs) and lowly abundant populations. However, this may lead to stronger sample-specific biases since
it is over-weighting latent PCs. If set to <code>NULL</code> this will scale the dimensions based on the value of <code>scaleDims</code> when the <code>reducedDims</code> were
originally created during dimensionality reduction. This idea was introduced by Timothy Stuart.</p></td>
    </tr>
    <tr>
      <th>corCutOff</th>
      <td><p>A numeric cutoff for the correlation of each dimension to the sequencing depth. If the dimension has a correlation to
sequencing depth that is greater than the <code>corCutOff</code>, it will be excluded from analysis.</p></td>
    </tr>
    <tr>
      <th>binarize</th>
      <td><p>A boolean value indicating whether the matrix should be binarized before running LSI. This is often desired when working with insertion counts.</p></td>
    </tr>
    <tr>
      <th>outlierQuantiles</th>
      <td><p>Two numerical values (between 0 and 1) that describe the lower and upper quantiles of bias (number of acessible regions per cell, determined
by <code>nFrags</code> or <code>colSums</code>) to filter cells prior to LSI. For example a value of c(0.02, 0.98) results in the cells in the bottom 2 percent and upper 98 percent to be
filtered prior to LSI. These cells are then projected back in the LSI subspace. This prevents spurious 'islands' that are identified based on being extremely biased.
These quantiles are also used for sub-sampled LSI when determining which cells are used.</p></td>
    </tr>
    <tr>
      <th>filterBias</th>
      <td><p>A boolean indicating whether to drop bias clusters when computing clusters during iterativeLSI.</p></td>
    </tr>
    <tr>
      <th>sampleCellsPre</th>
      <td><p>An integer specifying the number of cells to sample in iterations prior to the last in order to perform a sub-sampled LSI and
sub-sampled clustering. This greatly reduced memory usage and increases speed for early iterations.</p></td>
    </tr>
    <tr>
      <th>projectCellsPre</th>
      <td><p>A boolean indicating whether to reproject all cells into the sub-sampled LSI (see <code>sampleCellsPre</code>). Setting this to <code>FALSE</code>
allows for using the sub-sampled LSI for clustering and variance identification. If <code>TRUE</code> the cells are all projected into the sub-sampled LSI
and used for cluster and variance identification.</p></td>
    </tr>
    <tr>
      <th>sampleCellsFinal</th>
      <td><p>An integer specifying the number of cells to sample in order to perform a sub-sampled LSI in final iteration.</p></td>
    </tr>
    <tr>
      <th>selectionMethod</th>
      <td><p>The selection method to be used for identifying the top variable features. Valid options are "var" for
log-variability or "vmr" for variance-to-mean ratio.</p></td>
    </tr>
    <tr>
      <th>scaleTo</th>
      <td><p>Each column in the matrix designated by <code>useMatrix</code> will be normalized to a column sum designated by <code>scaleTo</code> prior to
variance calculation and TF-IDF normalization.</p></td>
    </tr>
    <tr>
      <th>totalFeatures</th>
      <td><p>The number of features to consider for use in LSI after ranking the features by the total number of insertions.
These features are the only ones used throught the variance identification and LSI. These are an equivalent when using a <code>TileMatrix</code> to a defined peakSet.</p></td>
    </tr>
    <tr>
      <th>filterQuantile</th>
      <td><p>A number 0,1 that indicates the quantile above which features should be removed based on insertion counts prior</p></td>
    </tr>
    <tr>
      <th>excludeChr</th>
      <td><p>A string of chromosomes to exclude for iterativeLSI procedure.
to the first iteration of the iterative LSI paradigm. For example, if <code>filterQuantile = 0.99</code>, any features above the 99th percentile in
insertion counts will be ignored for the first LSI iteration.</p></td>
    </tr>
    <tr>
      <th>saveIterations</th>
      <td><p>A boolean value indicating whether the results of each LSI iterations should be saved as compressed <code>.rds</code> files in
the designated <code>outDir</code>.</p></td>
    </tr>
    <tr>
      <th>UMAPParams</th>
      <td><p>The list of parameters to pass to the UMAP function if "UMAP" if <code>saveIterations=TRUE</code>. See the function <code><a href='https://rdrr.io/pkg/uwot/man/umap.html'>uwot::umap()</a></code>.</p></td>
    </tr>
    <tr>
      <th>nPlot</th>
      <td><p>If <code>saveIterations=TRUE</code>, how many cells to sample make a UMAP and plot for each iteration.</p></td>
    </tr>
    <tr>
      <th>outDir</th>
      <td><p>The output directory for saving LSI iterations if desired. Default is in the <code>outputDirectory</code> of the <code>ArchRProject</code>.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>The number of threads to be used for parallel computing.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>A number to be used as the seed for random number generation. It is recommended to keep track of the seed used so that you can
reproduce results downstream.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A boolean value that determines whether standard output includes verbose sections.</p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>A boolean value that indicates whether or not to overwrite relevant data in the <code>ArchRProject</code> object.</p></td>
    </tr>
    <tr>
      <th>logFile</th>
      <td><p>The path to a file to be used for logging ArchR output.</p></td>
    </tr>
    </table>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
                </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://twitter.com/JeffreyGranja'>Jeffrey Granja</a>, <a href='https://twitter.com/doctorcorces'>Ryan Corces</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '252c2c36fedc32b3ed803d0db4877b96',
    indexName: 'archr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


