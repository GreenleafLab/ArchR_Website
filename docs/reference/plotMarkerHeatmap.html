<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot a Heatmap of Identified Marker Features — plotMarkerHeatmap • ArchR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot a Heatmap of Identified Marker Features — plotMarkerHeatmap"><meta property="og:description" content="This function will plot a heatmap of the results from markerFeatures"><meta property="og:image" content="https://greenleaflab.github.io/ArchR_Website/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158769145-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158769145-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Articles/tutorial.html">
    <span class="fa fa-graduation-cap"></span>
     
    Quick Tutorial
  </a>
</li>
<li>
  <a href="../bookdown/index.html">
    <span class="fa fa-file-text-o"></span>
     
    Full Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GreenleafLab/ArchR" class="external-link">
    <span class="fa fa-github"></span>
     
    ArchR on GitHub
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a Heatmap of Identified Marker Features</h1>
    
    <div class="hidden name"><code>plotMarkerHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will plot a heatmap of the results from markerFeatures</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotMarkerHeatmap</span><span class="op">(</span></span>
<span>  seMarker <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cutOff <span class="op">=</span> <span class="st">"FDR &lt;= 0.01 &amp; Log2FC &gt;= 0.5"</span>,</span>
<span>  log2Norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scaleTo <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>  scaleRows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotLog2FC <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  grepExclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  binaryClusterRows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clusterCols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  subsetMarkers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labelMarkers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nLabel <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  nPrint <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  labelRows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnMatrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transpose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logFile <span class="op">=</span> <span class="fu"><a href="createLogFile.html">createLogFile</a></span><span class="op">(</span><span class="st">"plotMarkerHeatmap"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>seMarker</dt>
<dd><p>A <code>SummarizedExperiment</code> object returned by <code><a href="getMarkerFeatures.html">getMarkerFeatures()</a></code>.</p></dd>


<dt>cutOff</dt>
<dd><p>A valid-syntax logical statement that defines which marker features from <code>seMarker</code> will be plotted
in the heatmap. <code>cutoff</code> can contain any of the <code>assayNames</code> from <code>seMarker</code>.</p></dd>


<dt>log2Norm</dt>
<dd><p>A boolean value indicating whether a log2 transformation should be performed on the values in
<code>seMarker</code> prior to plotting. Should be set to <code>TRUE</code> for counts-based assays (but not assays like "DeviationsMatrix").
This only applies if <code>plotLog2FC = FALSE</code>.</p></dd>


<dt>scaleTo</dt>
<dd><p>Each column in the assay Mean from <code>seMarker</code> will be normalized to a column sum designated by <code>scaleTo</code>
prior to log2 normalization. If <code>log2Norm = FALSE</code> this option has no effect.</p></dd>


<dt>scaleRows</dt>
<dd><p>A boolean value that indicates whether the heatmap should display row-wise z-scores instead of raw values.</p></dd>


<dt>plotLog2FC</dt>
<dd><p>A boolean value that indicates whether the <code>log2(fold change)</code> values should be plotted on the heatmap or not.
If <code>TRUE</code>, the <code>log2(fold change)</code> value (stored in the assay of <code>seMarker</code> labeled "Log2FC") is plotted.
If <code>FALSE</code>, the mean value (stored in the assay of <code>seMarker</code> labeled "Mean") is plotted instead, with optional log normalization
based on the <code>log2Norm</code> parameter.</p></dd>


<dt>limits</dt>
<dd><p>A numeric vector of two numbers that represent the lower and upper limits of the heatmap color scheme.</p></dd>


<dt>grepExclude</dt>
<dd><p>A character vector or string that indicates the <code>rownames</code> or a specific pattern that identifies
rownames from <code>seMarker</code> to be excluded from the heatmap.</p></dd>


<dt>pal</dt>
<dd><p>A custom continuous palette from <code>ArchRPalettes</code> (see <code><a href="paletteContinuous.html">paletteContinuous()</a></code>) used to override the default continuous palette for the heatmap.</p></dd>


<dt>binaryClusterRows</dt>
<dd><p>A boolean value that indicates whether a binary sorting algorithm should be used for fast clustering of heatmap rows.</p></dd>


<dt>clusterCols</dt>
<dd><p>A boolean value that indicates whether the columns of the marker heatmap should be clustered.</p></dd>


<dt>subsetMarkers</dt>
<dd><p>A vector of rownames from seMarker to use for subsetting of seMarker to only plot specific features on the heatmap.
Note that these rownames are expected to be integers that come from <code>rownames(rowData(seMarker))</code>. If this parameter is used for
subsetting, then the values provided to <code>cutOff</code> are effectively ignored.</p></dd>


<dt>labelMarkers</dt>
<dd><p>A character vector listing the <code>rownames</code> of <code>seMarker</code> that should be labeled on the side of the heatmap.</p></dd>


<dt>nLabel</dt>
<dd><p>An integer value that indicates how many of the top <code>n</code> features for each column in <code>seMarker</code> should be labeled on the side of the heatmap.
To remove all feature labels, set <code>nLabel = 0</code>.</p></dd>


<dt>nPrint</dt>
<dd><p>If provided <code>seMarker</code> is from "GeneScoreMatrix" print the top <code>n</code> genes for each group based on how uniquely up-regulated the gene is.</p></dd>


<dt>labelRows</dt>
<dd><p>A boolean value that indicates whether all rows should be labeled on the side of the heatmap.</p></dd>


<dt>returnMatrix</dt>
<dd><p>A boolean value that indicates whether the final heatmap matrix should be returned in lieu of plotting the actual heatmap.</p></dd>


<dt>transpose</dt>
<dd><p>A boolean value that indicates whether the heatmap should be transposed prior to plotting or returning.</p></dd>


<dt>invert</dt>
<dd><p>A boolean value that indicates whether the heatmap will display the features with the
lowest <code>log2(fold change)</code>. In this case, the heatmap will display features that are specifically lower in the given cell
group compared to all other cell groups. Additionally, the color palette is inverted for visualization. This is useful when
looking for down-regulated markers (<code>log2(fold change) &lt; 0</code>) instead of up-regulated markers (<code>log2(fold change) &gt; 0</code>).</p></dd>


<dt>logFile</dt>
<dd><p>The path to a file to be used for logging ArchR output.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co">#Get Test Project</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="getTestProject.html">getTestProject</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get Markers</span></span>
<span><span class="va">seMarker</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMarkerFeatures.html">getMarkerFeatures</a></span><span class="op">(</span></span>
<span>  ArchRProj <span class="op">=</span> <span class="va">proj</span>, </span>
<span>  useMatrix <span class="op">=</span> <span class="st">"PeakMatrix"</span>, </span>
<span>  testMethod <span class="op">=</span> <span class="st">"binomial"</span>, </span>
<span>  binarize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot Markers</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plotMarkerHeatmap</span><span class="op">(</span><span class="va">seMarker</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#PDF</span></span>
<span><span class="fu"><a href="plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">p</span>, name <span class="op">=</span> <span class="st">"Marker-Heatmap"</span>, ArchRProj <span class="op">=</span> <span class="va">proj</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://twitter.com/JeffreyGranja" class="external-link">Jeffrey Granja</a>, <a href="https://twitter.com/doctorcorces" class="external-link">Ryan Corces</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '252c2c36fedc32b3ed803d0db4877b96',
    indexName: 'archr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

