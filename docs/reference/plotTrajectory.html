<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualize a Trajectory from ArchR Project — plotTrajectory • ArchR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Visualize a Trajectory from ArchR Project — plotTrajectory"><meta property="og:description" content="This function will plot a trajectory that was created onto an embedding."><meta property="og:image" content="https://greenleaflab.github.io/ArchR_Website/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158769145-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158769145-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Articles/tutorial.html">
    <span class="fa fa-graduation-cap"></span>
     
    Quick Tutorial
  </a>
</li>
<li>
  <a href="../bookdown/index.html">
    <span class="fa fa-file-text-o"></span>
     
    Full Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GreenleafLab/ArchR" class="external-link">
    <span class="fa fa-github"></span>
     
    ArchR on GitHub
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize a Trajectory from ArchR Project</h1>
    
    <div class="hidden name"><code>plotTrajectory.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will plot a trajectory that was created onto an embedding.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotTrajectory</span><span class="op">(</span></span>
<span>  ArchRProj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  embedding <span class="op">=</span> <span class="st">"UMAP"</span>,</span>
<span>  trajectory <span class="op">=</span> <span class="st">"Trajectory"</span>,</span>
<span>  colorBy <span class="op">=</span> <span class="st">"colData"</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Trajectory"</span>,</span>
<span>  log2Norm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  imputeWeights <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"coldata"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">colorBy</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="getImputeWeights.html">getImputeWeights</a></span><span class="op">(</span><span class="va">ArchRProj</span><span class="op">)</span>,</span>
<span>  pal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  rastr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quantCut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>  quantHex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  discreteSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuousSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  randomize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keepAxis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseSize <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  addArrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotAs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  smoothWindow <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  logFile <span class="op">=</span> <span class="fu"><a href="createLogFile.html">createLogFile</a></span><span class="op">(</span><span class="st">"plotTrajectory"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ArchRProj</dt>
<dd><p>An <code>ArchRProject</code> object.</p></dd>


<dt>embedding</dt>
<dd><p>The name of the embedding to use to visualize the given <code>trajectory</code>. See <code>addEmbedding()</code> for more information.</p></dd>


<dt>trajectory</dt>
<dd><p>The column name in <code>cellColData</code> that refers the trajectory to be plotted. See <code><a href="addTrajectory.html">addTrajectory()</a></code> for more information.</p></dd>


<dt>colorBy</dt>
<dd><p>A string indicating whether points in the plot should be colored by a column in <code>cellColData</code> ("cellColData")
or by a data matrix in the associated ArrowFiles (i.e. "GeneScoreMatrix", "MotifMatrix", "PeakMatrix").</p></dd>


<dt>name</dt>
<dd><p>The name of the column in <code>cellColData</code> or the featureName/rowname of the data matrix to be used for plotting.
For example if colorBy is "cellColData" then <code>name</code> refers to a column name in the cellcoldata (see <code>getCellcoldata()</code>). If <code>colorBy</code>
is "GeneScoreMatrix" then <code>name</code> refers to a gene name which can be listed by <code>getFeatures(ArchRProj, useMatrix = "GeneScoreMatrix")</code>.</p></dd>


<dt>log2Norm</dt>
<dd><p>A boolean value indicating whether a log2 transformation should be performed on the values from <code>colorBy</code>.</p></dd>


<dt>imputeWeights</dt>
<dd><p>The weights to be used for imputing numerical values for each cell as a linear combination of other cells'
values. See <code>addImputationWeights()</code> and <code>getImutationWeights()</code> for more information.</p></dd>


<dt>pal</dt>
<dd><p>The name of a custom palette from <code>ArchRPalettes</code> to use for coloring cells.</p></dd>


<dt>size</dt>
<dd><p>A number indicating the size of the points to plot if <code>plotAs</code> is set to "points".</p></dd>


<dt>rastr</dt>
<dd><p>A boolean value that indicates whether the plot should be rasterized. This does not rasterize lines and labels,
just the internal portions of the plot.</p></dd>


<dt>quantCut</dt>
<dd><p>If this is not <code>NULL</code>, a quantile cut is performed to threshold the top and bottom of the distribution of numerical values.
This prevents skewed color scales caused by strong outliers. The format of this should be c(x,y) where x is the lower threshold and y is
the upper threshold. For example, quantileCut = c(0.025,0.975) will take the 2.5th percentile and 97.5 percentile of values and
set values below/above to the value of the 2.5th and 97.5th percentile values respectively.</p></dd>


<dt>quantHex</dt>
<dd><p>The numeric xth quantile of all dots within each individual hexagon will determine the numerical value for
coloring to be displayed. This occurs when (i) <code>plotAs</code> is set to "hex" or (ii) <code>plotAs</code> is set to <code>NULL</code> and the values of <code>colorBy</code> are numeric.</p></dd>


<dt>discreteSet</dt>
<dd><p>The name of a discrete palette from <code>ArchRPalettes</code> for visualizing <code>colorBy</code> in the embedding if a discrete color set is desired.</p></dd>


<dt>continuousSet</dt>
<dd><p>The name of a continuous palette from <code>ArchRPalettes</code> for visualizing <code>colorBy</code> in the embedding if a continuous color set is desired.</p></dd>


<dt>randomize</dt>
<dd><p>A boolean value that indicates whether to randomize points prior to plotting to prevent cells from one cluster
being present at the front of the plot.</p></dd>


<dt>keepAxis</dt>
<dd><p>A boolean value that indicates whether the x and y axis ticks and labels should be plotted.</p></dd>


<dt>baseSize</dt>
<dd><p>The base font size to use in the plot.</p></dd>


<dt>addArrow</dt>
<dd><p>A boolean value that indicates whether to add a smoothed arrow in the embedding based on the aligned trajectory.</p></dd>


<dt>plotAs</dt>
<dd><p>A string that indicates whether points ("points") should be plotted or a hexplot ("hex") should be plotted. By default
if <code>colorBy</code> is numeric, then <code>plotAs</code> is set to "hex".</p></dd>


<dt>smoothWindow</dt>
<dd><p>An integer value indicating the smoothing window for creating inferred Arrow overlay on to embedding.</p></dd>


<dt>logFile</dt>
<dd><p>The path to a file to be used for logging ArchR output.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters to pass to <code><a href="ggPoint.html">ggPoint()</a></code> or <code><a href="ggHex.html">ggHex()</a></code>.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get Test ArchR Project</span></span></span>
<span class="r-in"><span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="getTestProject.html">getTestProject</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in getTestProject():</span> could not find function "getTestProject"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Add Trajectory</span></span></span>
<span class="r-in"><span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="addTrajectory.html">addTrajectory</a></span><span class="op">(</span><span class="va">proj</span>, trajectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span><span class="op">)</span>, embedding <span class="op">=</span> <span class="st">"UMAP"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in addTrajectory(proj, trajectory = c("C1", "C2", "C3"), embedding = "UMAP",     force = TRUE):</span> could not find function "addTrajectory"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plot Trajectory</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plotTrajectory</span><span class="op">(</span><span class="va">proj</span>, smoothWindow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plotTrajectory(proj, smoothWindow = 20):</span> could not find function "plotTrajectory"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#PDF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">p</span>, name <span class="op">=</span> <span class="st">"Trajcetory"</span>, ArchRProj <span class="op">=</span> <span class="va">proj</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plotPDF(p, name = "Trajcetory", ArchRProj = proj):</span> could not find function "plotPDF"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://twitter.com/JeffreyGranja" class="external-link">Jeffrey Granja</a>, Ryan cre Corces.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '252c2c36fedc32b3ed803d0db4877b96',
    indexName: 'archr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

